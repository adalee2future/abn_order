rpt_date
20170208
mail_date
20170209
loop starts in 2017-02-09 12:57:01
need to find subject: =?utf-8?q?2017-02-09-all?=
current mail id = 171
current mail id = 172
current mail id = 173
current mail id = 174
current mail id = 175
current mail id = 176
current mail id = 177
current mail id = 178
current mail id = 179
current mail id = 180
current mail id = 181
current mail id = 182
current mail id = 183
current mail id = 184
current mail id = 185
current mail id = 186
current mail id = 187
current mail id = 188
current mail id = 189
current mail id = 190
current mail id = 191
current mail id = 192
current mail id = 193
current mail id = 194
current mail id = 195
current mail id = 196
current mail id = 197
current mail id = 198
current mail id = 199
current mail id = 200
current mail id = 201
current mail id = 202
current mail id = 203
current mail id = 204
current mail id = 205
current mail id = 206
current mail id = 207
current mail id = 208
current mail id = 209
current mail id = 210
current mail id = 211
current mail id = 212
current mail id = 213
current mail id = 214
current mail id = 215
current mail id = 216
current mail id = 217
current mail id = 218
current mail id = 219
current mail id = 220
current mail id = 221
current mail id = 222
current mail id = 223
current mail id = 224
current mail id = 225
current mail id = 226
current mail id = 227
current mail id = 228
current mail id = 229
current mail id = 230
current mail id = 231
current mail id = 232
current mail id = 233
current mail id = 234
current mail id = 235
current mail id = 236
current mail id = 237
current mail id = 238
current mail id = 239
current mail id = 240
current mail id = 241
current mail id = 242
current mail id = 243
current mail id = 244
current mail id = 245
current mail id = 246
current mail id = 247
current mail id = 248
current mail id = 249
current mail id = 250
current mail id = 251
current mail id = 252
current mail id = 253
current mail id = 254
mail subject matches!
file 2017-02-09-all.xlsx downloaded sucessfully!
Seconds took: 15.4972829819

R version 3.3.2 (2016-10-31) -- "Sincere Pumpkin Patch"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.4.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> rmarkdown::render('abn_order_daily2.Rmd', output_format='html_document')


processing file: abn_order_daily2.Rmd
  |                                                                         |                                                                 |   0%  |                                                                         |....                                                             |   6%
   inline R code fragments

  |                                                                         |........                                                         |  12%
label: unnamed-chunk-1 (with options) 
List of 3
 $ echo   : logi FALSE
 $ warning: logi FALSE
 $ message: logi FALSE


Attaching package: 'scales'

The following object is masked _by_ '.GlobalEnv':

    percent


Attaching package: 'dplyr'

The following objects are masked from 'package:stats':

    filter, lag

The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union

Loading required package: rJava
Loading required package: xlsxjars
Quitting from lines 18-76 (abn_order_daily2.Rmd) 
Error in loadWorkbook(file) : Cannot find data/20170207.xlsx
Calls: <Anonymous> ... withVisible -> eval -> eval -> read.xlsx -> loadWorkbook

Execution halted

R version 3.3.2 (2016-10-31) -- "Sincere Pumpkin Patch"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin13.4.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> rmarkdown::render('abn_order_daily2.Rmd',
+                   output_format='html_document',
+ 		  output_file='abn_ord_dly.20170208.html',
+ 		  params=list(rpt_date="20170208")
+ )


processing file: abn_order_daily2.Rmd
  |                                                                         |                                                                 |   0%  |                                                                         |....                                                             |   6%
   inline R code fragments

  |                                                                         |........                                                         |  12%
label: unnamed-chunk-1 (with options) 
List of 3
 $ echo   : logi FALSE
 $ warning: logi FALSE
 $ message: logi FALSE


Attaching package: 'scales'

The following object is masked _by_ '.GlobalEnv':

    percent


Attaching package: 'dplyr'

The following objects are masked from 'package:stats':

    filter, lag

The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union

Loading required package: rJava
Loading required package: xlsxjars
  |                                                                         |...........                                                      |  18%
  ordinary text without R code

  |                                                                         |...............                                                  |  24%
label: unnamed-chunk-2 (with options) 
List of 3
 $ echo   : logi FALSE
 $ warning: logi FALSE
 $ message: logi FALSE

  |                                                                         |...................                                              |  29%
   inline R code fragments

  |                                                                         |.......................                                          |  35%
label: unnamed-chunk-3 (with options) 
List of 4
 $ echo      : logi FALSE
 $ warning   : logi FALSE
 $ message   : logi FALSE
 $ fig.height: num 3

  |                                                                         |...........................                                      |  41%
  ordinary text without R code

  |                                                                         |...............................                                  |  47%
label: unnamed-chunk-4 (with options) 
List of 5
 $ echo      : logi FALSE
 $ warning   : logi FALSE
 $ message   : logi FALSE
 $ fig.height: num 4
 $ fig.width : num 8

Quitting from lines 165-236 (abn_order_daily2.Rmd) 
Error in eval(expr, envir, enclos) : 'sum' not meaningful for factors
Calls: <Anonymous> ... summarise_ -> summarise_.tbl_df -> summarise_impl -> .Call

Execution halted
mv: rename abn_ord_dly*.20170208.html to output/abn_ord_dly*.20170208.html: No such file or directory
{'Content-Type': 'multipart/mixed',
 'From': 'lili.li@ele.me',
 'MIME-Version': '1.0',
 'Subject': '\xe5\xbc\x82\xe5\xb8\xb8\xe4\xba\xa4\xe6\x98\x93\xe7\x9b\x91\xe6\x8e\xa7\xe6\x97\xa5\xe6\x8a\xa50208',
 'To': 'fei.ren@ele.me,jiejun.gao@ele.me,ruiqing.zhang@ele.me,fanjing.lv@ele.me,diting.liu@ele.me,minqiu.wang@ele.me,lili.li@ele.me'}
Traceback (most recent call last):
  File "./sendmail.py", line 29, in <module>
    html_text = open("output/abn_ord_dly.%s.html" % rpt_date, "rb").read()
IOError: [Errno 2] No such file or directory: 'output/abn_ord_dly.20170208.html'

