webpackJsonp([24],{0:function(e,t,n){n(1433),e.exports=n(1434)},231:function(e,t,n){(function(n){function r(){var e=void 0;return e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}function i(e){var t=r();return t.open("GET",e,!0),t.send(),new n(function(e,n){t.onreadystatechange=function(){4===t.readyState&&(200===t.status?e(JSON.parse(t.responseText)):n(t.responseText))}})}function o(e,t){var i=r();i.open("POST",e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),window.cow._csrf&&i.setRequestHeader("X-CSRF-Token",window.cow._csrf);var o="";return Object.keys(t).forEach(function(e){o+=e+"="+t[e]+"&"}),i.send(o),new n(function(e,t){i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var n=void 0;try{n=JSON.parse(i.responseText)}catch(e){n=i.responseText}e(n)}else t(i.responseText)}})}function a(e,t){var i=r();i.open("PUT",e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),window.cow._csrf&&i.setRequestHeader("X-CSRF-Token",window.cow._csrf);var o="";return t&&Object.keys(t).forEach(function(e){o+=e+"="+t[e]+"&"}),i.send(o),new n(function(e,t){i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var n=void 0;try{n=JSON.parse(i.responseText)}catch(e){n=i.responseText}e(n)}else t(i.responseText)}})}function s(e,t){var i=r();i.open("PATCH",e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),window.cow._csrf&&i.setRequestHeader("X-CSRF-Token",window.cow._csrf);var o="";return t&&Object.keys(t).forEach(function(e){o+=e+"="+t[e]+"&"}),i.send(o),new n(function(e,t){i.onreadystatechange=function(){if(4===i.readyState)if(200===i.status){var n=void 0;try{n=JSON.parse(i.responseText)}catch(e){n=i.responseText}e(n)}else t(i.responseText)}})}function l(e){var t=r();return t.open("DELETE",e),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(),new n(function(e,n){t.onreadystatechange=function(){if(4===t.readyState)if(200===t.status){var r=JSON.parse(t.responseText);0===r.code?e(r):n(new Error(r.message))}else n(new Error(t.responseText))}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default={ajaxGet:i,ajaxPost:o,ajaxPut:a,ajaxPatch:s,ajaxDelete:l},e.exports=t.default}).call(t,n(170))},266:function(e,t,n){(function(r,i,o){function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){e||(e="无标题");var n={name:e},r=window.cow.currentFile.guid;N.default.post("/api/file/"+r,n).then(function(){"function"==typeof t&&t(),M.default.notify("file:updateTitle",e)}).fail(function(){console.log("name modify failed")})}function l(e,t){var n=r.Deferred(),i=[],o={};for(var a in t)e[a]!==t[a]&&(i.push(a),o[a]=t[a]);if(0===i.length)n.resolve({});else{var s="/api/file/"+e.guid;N.default.post(s,o,function(t){0===t.code?(b(e.guid,t.data),n.resolve(t.data)):n.reject()},function(e){n.reject(e)})}return n.promise()}function u(e){return(0,L.ajaxPut)("/smapi/files/"+e.id+"/star").then(function(e){if(0!==e.code)throw new Error("标星失败。错误码："+e.code);return{starred:!0}})}function c(e){return(0,L.ajaxDelete)("/smapi/files/"+e.id+"/star").then(function(e){if(0!==e.code)throw new Error("取消标星失败。错误码："+e.code);return{starred:!1}})}function p(e){var t="/api/file/create_copy",n=r.Deferred(),i={guid:e};return N.default.post(t,i,function(e){0===e.code?(n.resolve(e.data),cow.currentFile.children.push(e.data)):n.reject()},function(e){n.reject(e)}),n.promise()}function d(e){var t="/api/file/create",n=r.Deferred();return N.default.post(t,e,function(e){0===e.code?(n.resolve(e.data),cow.currentFile.children.push(e.data)):n.reject(new Error(e.message))},function(e){n.reject(e)}),n.promise()}function f(e){var t=r.Deferred(),n="/api/file/"+e+"/ancestors";return N.default.get(n,function(e){if(0===e.code){var n=e.data,r=n.ancestors||[];r.unshift({name:"我的桌面",type:"desktop",link:"/desktop"}),h(r),t.resolve(r)}else t.reject()},function(){t.reject()}),t.promise()}function h(e){e.map(function(e,t){return 0!==t&&(e.link="/folder/"+e.guid,e.type="folder"),e})}function m(e){var t=r.Deferred(),n="/api/share/delete",i={guid:e.guid,user_id:window.cow.currentUser.id,file_type:e.shortcut_id?"shortcut":"file"};return N.default.post(n,i,function(n){0===n.code?(t.resolve(n),b(e.guid,{is_delete:1})):t.reject()},function(){t.reject()}),t.promise()}function v(e,t,n){var i=arguments.length<=3||void 0===arguments[3]?"info":arguments[3],o=r.Deferred(),a={from:e,to:t,file_type:n,action_type:i},s="/api/file/move";return N.default.post(s,a,function(t){o.resolve(t),"action"===i&&b(e,{is_delete:1})},function(e){o.reject(e)}),o.promise()}function y(e,t){var n=r.Deferred(),i="/api/file/sort",o={target_id:e};return t&&(o.next_id=t),cow.currentFile.guid?(o.sort_type="folder",o.folder_id=cow.currentFile.id):o.sort_type="home",N.default.post(i,o).then(function(r){0===r.code?(n.resolve(),g(e,t)):n.reject()}).fail(function(e){n.reject(e)}),n.promise()}function g(e,t){var n=cow.currentFile.children,r=null,i=-1,o=-1;(n||[]).some(function(n,a){return n.id===e&&(r=n,i=a),n.id===t&&(o=a),i>=0&&(o>=0||null===t||"undefined"==typeof t)}),o>=0&&i>=0?(n.splice(o,0,r),o>i?n.splice(i,1):n.splice(i+1,1)):"undefined"!=typeof t&&null!==t||(n.splice(i,1),n.push(r))}function b(e,t){var n=cow.currentFile.children;(n||[]).some(function(r,i){if(r.guid===e){for(var o in t)r[o]=t[o],"is_delete"===o&&+t.is_delete>=1&&n.splice(i,1);return!0}return!1})}function w(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?10:arguments[2];return new i(function(r,i){(0,L.ajaxPost)("/smapi/search/files",{keyword:e,page:t,pageSize:n}).then(function(e){0===e.code&&e.data?r({page:e.data.page,results:e.data.results||[],count:e.data.count,pageCount:e.data.pageCount}):i(new Error(e.message))},function(e){i(e)})})}function k(e){return new i(function(t,n){var r="/smapi/files/"+e+"/star";(0,L.ajaxPut)(r).then(function(e){0===e.code?t():n(new Error("标星操作失败"))},function(){n(new Error("标星操作失败"))})})}function T(e){return new i(function(t,n){var r="/smapi/files/"+e+"/star";(0,L.ajaxDelete)(r).then(function(e){0===e.code?t():n(new Error("标星操作失败"))},function(){n(new Error("标星操作失败"))})})}function C(e){return new i(function(t,n){var r="/smapi/files/"+e+"/collaborators";(0,L.ajaxGet)(r).then(function(e){0===e.code?t(e.data):n(new Error(e.error))},function(e){n(e)})})}function O(){var e=void 0;return e=""===cow.welcomeFile?"欢迎使用石墨文档"===cow.currentFile.name:cow.currentFile.guid===cow.welcomeFile}function E(e){var t=e;return!(!cow.exampleFiles||!cow.exampleFiles.length)&&(t||(t=cow.currentFile.guid),cow.exampleFiles.split(",").some(function(e){return t===e}))}function P(e){var t=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return new i(function(n,r){e=e||"";var i="/-/"+e;(0,L.ajaxGet)(i).then(function(e){0===e.code&&e.data.file?(t.length&&(e.data.file=o.pick(e.data.file,t),t.indexOf("children")>-1&&e.data.file.children&&(e.data.file.children=e.data.file.children.map(function(e){return o.pick(e,t)}))),n(e.data.file)):r(new Error("文件获取失败"))},function(){return r(new Error("文件获取失败"))})})}function x(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return P("",e)}function _(e){return new i(function(t,n){return e?void f(e.guid).then(function(r){var i="";r.length&&(i=r.slice(-1)[0].guid),P(i).then(function(n){var i={includedFileGuid:e.guid,crumbList:r};t({crumbInfo:i,file:n})},function(){return n(new Error("文件已被删除，或失去访问权限"))})},function(){return n(new Error("文件已被删除，或失去访问权限"))}):n(new Error("get file failed"))})}Object.defineProperty(t,"__esModule",{value:!0});var S=n(175),N=a(S),j=n(166),M=a(j),L=n(231);t.default={updateTitle:s,updateFile:l,destroyFavoriteFile:c,createFavoriteFile:u,createCopyFile:p,createFile:d,getAncestors:f,quiteShare:m,resortList:y,moveToFolder:v,searchFile:w,starFile:k,unstarFile:T,getFileCollaborators:C,checkIsWelcomeFile:O,checkIsExampleFile:E,getFile:P,getDesktop:x,getDirectoryInfo:_},e.exports=t.default}).call(t,n(1),n(170),n(4))},267:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={0:"doc","-1":"spreadsheet","-3":"sheet",1:"folder"};t.FILE_TYPE_MAP=n;var r={0:"文档","-2":"文档","-1":"表格","-3":"表格"};t.FILE_ZH_TYPE_MAP=r},284:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},u=n(7),c=r(u),p=n(161),d=n(285),f=r(d),h=function(e){function t(e){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={open:e.open||!1},this.bodyTpl=this.bodyTpl.bind(this)}return a(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){"undefined"!=typeof e.open&&e.open!==this.state.open&&this.setState({open:e.open})}},{key:"_headTpl",value:function(e){return this.props.hasCloseButton?c.default.createElement("div",null,c.default.createElement("span",{className:"dialog-title"},e),c.default.createElement("span",{className:"hicon icon-close dialog-close",onTouchTap:this._close.bind(this)})):c.default.createElement("span",{className:"dialog-title"},e)}},{key:"_close",value:function(){this.setState({open:!1});var e=this.props.onClose;"function"==typeof e&&e()}},{key:"bodyTpl",value:function(){var e=this;if("function"==typeof this.props.bodyTpl)return this.props.bodyTpl;if(this.props.children){var t=function(){var t=c.default.Children.map(e.props.children,function(e){return c.default.cloneElement(e)});return{v:function(){return t}}}();if("object"==typeof t)return t.v}}},{key:"render",value:function(){var e,t=this.props,n=t.customClass,r=t.title,o=t.onClose,a=t.actions,s=t.enableCloseClickMask,l=t.hasCloseButton,u=this.state.open,d=this.props.buttonLayout,h=!1;a&&a.length>0&&(h=!0,d=d||"vertical",a.map(function(e){e.customClass+=" flat-footer-button "+d}));var m=(0,f.default)((e={"flat-dialog":!0},i(e,""+n,!!n),i(e,"no-title",!r&&!l),i(e,"no-action",!a||!a.length),e));return c.default.createElement(p.Dialog,{ref:"dialog",customClass:m,title:r,headTpl:this._headTpl.bind(this),bodyTpl:this.bodyTpl.bind(this)(),onClose:o||function(){},actions:a||[],open:"boolean"==typeof u&&u,enableCloseClickMask:s,hasActions:h})}}]),t}(u.Component);t.default=h,h.propTypes={customClass:u.PropTypes.string,title:u.PropTypes.string,bodyTpl:u.PropTypes.func,onClose:u.PropTypes.func,actions:u.PropTypes.array,open:u.PropTypes.bool,hasCloseButton:u.PropTypes.bool,enableCloseClickMask:u.PropTypes.bool,buttonLayout:u.PropTypes.oneOf(["vertical","horizontal"])},e.exports=t.default},285:function(e,t,n){var r,i;!function(){"use strict";function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"===i||"number"===i)e.push(r);else if(Array.isArray(r))e.push(n.apply(null,r));else if("object"===i)for(var a in r)o.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}var o={}.hasOwnProperty;"undefined"!=typeof e&&e.exports?e.exports=n:(r=[],i=function(){return n}.apply(t,r),!(void 0!==i&&(e.exports=i)))}()},291:function(e,t,n){var r,i;!function(o){r=[n(1)],i=function(e){return o(e)}.apply(t,r),!(void 0!==i&&(e.exports=i))}(function(e){"use strict";function t(e){void 0===e&&(e=window.navigator.userAgent),e=e.toLowerCase();var t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(silk)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||/(playbook)/.exec(e)||/(bb)/.exec(e)||/(blackberry)/.exec(e)||[],r={},i={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",versionNumber:t[4]||t[2]||"0",platform:n[0]||""};if(i.browser&&(r[i.browser]=!0,r.version=i.version,r.versionNumber=parseInt(i.versionNumber,10)),i.platform&&(r[i.platform]=!0),(r.android||r.bb||r.blackberry||r.ipad||r.iphone||r.ipod||r.kindle||r.playbook||r.silk||r["windows phone"])&&(r.mobile=!0),(r.cros||r.mac||r.linux||r.win)&&(r.desktop=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),r.rv||r.edge){var o="msie";i.browser=o,r[o]=!0}if(r.safari&&r.blackberry){var a="blackberry";i.browser=a,r[a]=!0}if(r.safari&&r.playbook){var s="playbook";i.browser=s,r[s]=!0}if(r.bb){var l="blackberry";i.browser=l,r[l]=!0}if(r.opr){var u="opera";i.browser=u,r[u]=!0}if(r.safari&&r.android){var c="android";i.browser=c,r[c]=!0}if(r.safari&&r.kindle){var p="kindle";i.browser=p,r[p]=!0}if(r.safari&&r.silk){var d="silk";i.browser=d,r[d]=!0}return r.name=i.browser,r.platform=i.platform,r}return window.jQBrowser=t(window.navigator.userAgent),window.jQBrowser.uaMatch=t,e&&(e.browser=window.jQBrowser),window.jQBrowser})},292:function(e,t,n){var r,i;(function(o){var a=function(e,t){function n(){this.constructor=e}for(var r in t)s.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},s={}.hasOwnProperty;r=[n(175)],i=function(e){var t;return new(t=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return a(t,e),t.prototype.eventMap={"click .btn-ok":"clickOK","click .btn-cancel":"clickCancel","click .dialog":"clickSelf","click .confirm-close":"close","click .confirm-checkbox":"changeCheckBox",click:"click"},t.prototype.init=function(){return this.$view=o("#confirm"),this.$head=this.$(".dialog-head"),this.$headSpan=this.$(".header-text"),this.$body=this.$(".dialog-body"),this.$foot=this.$(".dialog-foot"),this.$okBtn=this.$(".btn-ok"),this.$cancelBtn=this.$(".btn-cancel"),this.buttons=["ok","cancel"],this.modal=!1,this.reset()},t.prototype.domEvents={clickOK:function(e){if(!o(e.target).hasClass("custom-confirm-btn"))return"function"==typeof this.okCallback&&this.okCallback({checkBoxValue:this.checkBoxValue}),this.hide(),e.stopPropagation()},clickCancel:function(e){if(!o(e.target).hasClass("custom-confirm-btn"))return"function"==typeof this.cancelCallback&&this.cancelCallback(),this.hide(),e.stopPropagation()},click:function(e){if(!this.modal)return"function"==typeof this.cancelCallback&&this.cancelCallback(),this.hide(),e.stopPropagation()},clickSelf:function(e){return e.stopPropagation()},changeCheckBox:function(e){return this.checkBoxValue=!this.checkBoxValue,o(".confirm-checkbox").toggleClass("active")},close:function(e){return this.hide()}},t.prototype.reset=function(){return this.headText="确认",this.bodyText="确认吗？",this.okText="确认",this.cancelText="取消",this.externalClass="",this.okCallback=null,this.cancelCallback=null,this.checkBox=null,this.checkBoxValue=!1},t.prototype.show=function(e){var t;return this.$foot.empty(),this.okCallback=e.okCallback,this.cancelCallback=e.cancelCallback,this.headText=e.headText||this.headText,this.bodyText=e.bodyText||this.bodyText,this.okText=e.okText||this.okText,this.cancelText=e.cancelText||this.cancelText,this.externalClass=e.externalClass||this.externalClass,this.modal=e.modal||!1,this.buttons=e.buttons||["ok","cancel"],e.checkBox&&(this.checkBox=e.checkBox,this.checkBoxValue=e.checkBoxValue||!1),"object"==typeof this.buttons[0]?(this.$okBtn.hide(),this.$cancelBtn.hide(),this.createFoot()):(this.$foot.append('<div class="btn btn-ok">确认</div><div class="btn btn-cancel">取消</div>'),this.$okBtn=this.$(".btn-ok"),this.$cancelBtn=this.$(".btn-cancel"),this.buttons.indexOf("ok")===-1?this.$okBtn.hide():this.$okBtn.show(),this.buttons.indexOf("cancel")===-1?this.$cancelBtn.hide():this.$cancelBtn.show(),this.$okBtn.text(this.okText),this.$cancelBtn.text(this.cancelText)),this.$headSpan.text(this.headText),this.$body.html(this.bodyText),this.checkBox&&(t=this.checkBoxValue?"active":"",this.$body.append('<div class="confirm-checkbox '+t+'">'+this.checkBox+"</div>")),this.$view.addClass(this.externalClass).show()},t.prototype.createFoot=function(){var e,t,n,r,i,a,s,l,u,c,p,d,f,h,m;for(f=this,t=o(),d=this.buttons,u=0,c=d.length;u<c;u++)n=d[u],m=n.type||"button",h=n.target||"_blank",l=n.href||"",s="custom-confirm-btn "+(n.customClass||""),r=n.label||n.buttonLabel||"",a=!!n.closeAfterClick,p="function"==typeof n.onClick?n.onClick:function(){},e=o(),"button"===m?e=o(document.createElement("div")):"link-button"===m&&(e=o(document.createElement("a")),e.attr({href:l,target:h})),e.addClass(n.class||s),e.text(r),i=function(e,t){return function(n){if(e(n),t)return f.hide(),n.stopPropagation()}}(p,a),e.on("click",i),t.push(e[0]);if(t.length>0)return this.$foot.append(t)},t.prototype.hide=function(){return this.$view.removeClass(this.externalClass).hide(),this.reset()},t}(e.DomModule))("#confirm")}.apply(t,r),!(void 0!==i&&(e.exports=i))}).call(t,n(1))},313:function(e,t,n){var r,i;r=[n(314)],i=function(e){var t={};return t.error=function(e){var t=new Error(e);throw t.easysync=!0,t},t.assert=function(e,n){if(!e){var r=Array.prototype.slice.call(arguments,1).join("");t.error("Failed assertion: "+r)}},t.parseNum=function(e){return parseInt(e,36)},t.numToString=function(e){return e.toString(36).toLowerCase()},t.toBaseTen=function(e){var n=e.indexOf("$"),r=e.substring(0,n),i=e.substring(n);return r.replace(/[0-9a-z]+/g,function(e){return String(t.parseNum(e))})+i},t.oldLen=function(e){return t.unpack(e).oldLen},t.newLen=function(e){return t.unpack(e).newLen},t.opIterator=function(e,n){function r(){c=u;var n;return s.lastIndex=u,n=s.exec(e),u=s.lastIndex,"?"==n[0]&&t.error("Hit error opcode in op stream"),n}function i(e){var n=e||d;return p[0]?(n.attribs=p[1],n.lines=t.parseNum(p[2]||0),n.opcode=p[3],n.chars=t.parseNum(p[4]),p=r()):t.clearOp(n),n}function o(){return!!p[0]}function a(){return c}var s=/((?:\*[0-9a-z]+)*)(?:\|([0-9a-z]+))?([-+=])([0-9a-z]+)|\?|/g,l=n||0,u=l,c=u,p=r(),d=t.newOp();return{next:i,hasNext:o,lastIndex:a}},t.clearOp=function(e){e.opcode="",e.chars=0,e.lines=0,e.attribs=""},t.newOp=function(e){return{opcode:e||"",chars:0,lines:0,attribs:""}},t.cloneOp=function(e){return{opcode:e.opcode,chars:e.chars,lines:e.lines,attribs:e.attribs}},t.copyOp=function(e,t){t.opcode=e.opcode,t.chars=e.chars,t.lines=e.lines,t.attribs=e.attribs},t.opString=function(e){if(!e.opcode)return"null";var n=t.opAssembler();return n.append(e),n.toString()},t.stringOp=function(e){return t.opIterator(e).next()},t.checkRep=function(e){for(var n=t.unpack(e),r=n.oldLen,i=n.newLen,o=n.ops,a=n.charBank,s=t.smartOpAssembler(),l=0,u=0,c=0,p=t.opIterator(o);p.hasNext();){var d=p.next();switch(d.opcode){case"=":l+=d.chars,u+=d.chars;break;case"-":l+=d.chars,t.assert(l<r,l," >= ",r," in ",e);break;case"+":u+=d.chars,c+=d.chars,t.assert(u<i,u," >= ",i," in ",e)}s.append(d)}for(u+=r-l,a=a.substring(0,c);a.length<c;)a+="?";s.endDocument();var f=t.pack(r,u,s.toString(),a);return t.assert(f==e,"Invalid changeset (checkRep failed)"),e},t.smartOpAssembler=function(){function e(){d.append(p.toString()),p.clear()}function n(){d.append(u.toString()),u.clear(),d.append(c.toString()),c.clear()}function r(t){t.opcode&&t.chars&&("-"==t.opcode?("="==f&&e(),u.append(t),h-=t.chars):"+"==t.opcode?("="==f&&e(),c.append(t),h+=t.chars):"="==t.opcode&&("="!=f&&n(),p.append(t)),f=t.opcode)}function i(e,n,i,o){var a=t.newOp(e);a.attribs=t.makeAttribsString(e,i,o);var s=n.lastIndexOf("\n");s<0?(a.chars=n.length,a.lines=0,r(a)):(a.chars=s+1,a.lines=n.match(/\n/g).length,r(a),a.chars=n.length-(s+1),a.lines=0,r(a))}function o(){return n(),e(),d.toString()}function a(){u.clear(),c.clear(),p.clear(),d.clear(),h=0}function s(){p.endDocument()}function l(){return h}var u=t.mergingOpAssembler(),c=t.mergingOpAssembler(),p=t.mergingOpAssembler(),d=t.stringAssembler(),f="",h=0;return{append:r,toString:o,clear:a,endDocument:s,appendOpWithText:i,getLengthChange:l}},t.mergingOpAssembler=function(){function e(e){s.opcode&&(e&&"="==s.opcode&&!s.attribs||(a.append(s),l&&(s.chars=l,s.lines=0,a.append(s),l=0)),s.opcode="")}function n(n){n.chars>0&&(s.opcode==n.opcode&&s.attribs==n.attribs?n.lines>0?(s.chars+=l+n.chars,s.lines+=n.lines,l=0):0==s.lines?s.chars+=n.chars:l+=n.chars:(e(),t.copyOp(n,s)))}function r(){e(!0)}function i(){return e(),a.toString()}function o(){a.clear(),t.clearOp(s)}var a=t.opAssembler(),s=t.newOp(),l=0;return{append:n,toString:i,clear:o,endDocument:r}},t.opAssembler=function(){function e(e){i.push(e.attribs),e.lines&&i.push("|",t.numToString(e.lines)),i.push(e.opcode),i.push(t.numToString(e.chars))}function n(){return i.join("")}function r(){i.length=0}var i=[];return{append:e,toString:n,clear:r}},t.stringIterator=function(e){function n(e){t.assert(e<=a(),"!(",e," <= ",a(),")")}function r(t){n(t);var r=e.substr(l,t);return l+=t,r}function i(t){n(t);var r=e.substr(l,t);return r}function o(e){n(e),l+=e}function a(){return e.length-l}function s(){return l}var l=0;return{take:r,skip:o,remaining:a,peek:i,currentIndex:s}},t.stringAssembler=function(){function e(e){var t=String(e);o.push(t),a+=t.length}function t(){var e=o.pop();return a-=e.length,e}function n(){return o[o.length-1]}function r(){return o.join("")}function i(){return a}var o=[],a=0;return{append:e,pop:t,last:n,toString:r,length:i}},t.textLinesMutator=function(e){function n(t){e.splice.apply(e,t)}function r(t){return e.get?e.get(t):e[t]}function i(t,n){return e.slice?e.slice(t,n):[]}function o(){return"number"==typeof e.length?e.length:e.length()}function a(){y[0]=b,y[1]=0,w>0&&u(),g=!0}function s(){n(y),y.length=2,y[0]=y[1]=0,g=!1}function l(){return b-y[0]<y.length-2}function u(){return l()||(y.push(r(y[0]+y[1])),y[1]++),2+b-y[0]}function c(e,t){if(e)if(t){g||a();for(var n=0;n<e;n++)w=0,u(),b++}else g&&(e>1?s():u()),b+=e,w=0}function p(e,t,n){e&&(t?c(t,n):(n&&!g&&a(),g&&u(),w+=e))}function d(e){var t="";if(e){var n=function(e){var t=y[0]+y[1];return i(t,t+e).join("")};if(g||a(),l())if(0==w)t=y[y.length-1],y.length--,t+=n(e-1),y[1]+=e-1;else{t=n(e-1),y[1]+=e-1;var o=y.length-1;t=y[o].substring(w)+t,y[o]=y[o].substring(0,w)+r(y[0]+y[1]),y[1]+=1}else t=n(e),y[1]+=e}return t}function f(e,t){var n="";if(e){if(t)return d(t);g||a();var r=u();n=y[r].substring(w,w+e),y[r]=y[r].substring(0,w)+y[r].substring(w+e)}return n}function h(e,n){if(e)if(g||a(),n){var r=t.splitTextLines(e);if(l()){var i=y.length-1,o=y[i],s=w;y[i]=o.substring(0,s)+r[0],b++,r.splice(0,1),Array.prototype.push.apply(y,r),b+=r.length,y.push(o.substring(s)),w=0}else Array.prototype.push.apply(y,r),b+=r.length}else{var i=u();y[i]=y[i].substring(0,w)+e+y[i].substring(w),w+=e.length}}function m(){var e=o();return g&&(e+=y.length-2-y[1]),b<e}function v(){g&&s()}var y=[0,0],g=!1,b=0,w=0,k={skip:p,remove:f,insert:h,close:v,hasMore:m,removeLines:d,skipLines:c};return k},t.applyZip=function(e,n,r,i,o){for(var a=t.opIterator(e,n),s=t.opIterator(r,i),l=t.smartOpAssembler(),u=t.newOp(),c=t.newOp(),p=t.newOp();u.opcode||a.hasNext()||c.opcode||s.hasNext();)!u.opcode&&a.hasNext()&&a.next(u),!c.opcode&&s.hasNext()&&s.next(c),o(u,c,p),p.opcode&&(l.append(p),p.opcode="");return l.endDocument(),l.toString()},t.unpack=function(e){var n=/Z:([0-9a-z]+)([><])([0-9a-z]+)|/,r=n.exec(e);r&&r[0]||t.error("Not a exports: "+e);var i=t.parseNum(r[1]),o=">"==r[2]?1:-1,a=t.parseNum(r[3]),s=i+o*a,l=r[0].length,u=e.indexOf("$");return u<0&&(u=e.length),{oldLen:i,newLen:s,ops:e.substring(l,u),charBank:e.substring(u+1)}},t.pack=function(e,n,r,i){var o=n-e,a=o>=0?">"+t.numToString(o):"<"+t.numToString(-o),s=[];return s.push("Z:",t.numToString(e),a,r,"$",i),s.join("")},t.applyToText=function(e,n){var r=t.unpack(e);t.assert(n.length==r.oldLen,"mismatched apply: ",n.length," / ",r.oldLen);for(var i=t.opIterator(r.ops),o=t.stringIterator(r.charBank),a=t.stringIterator(n),s=t.stringAssembler();i.hasNext();){var l=i.next();switch(l.opcode){case"+":if(l.lines!=o.peek(l.chars).split("\n").length-1)throw new Error("newline count is wrong in op +; cs:"+e+" and text:"+n);s.append(o.take(l.chars));break;case"-":if(l.lines!=a.peek(l.chars).split("\n").length-1)throw new Error("newline count is wrong in op -; cs:"+e+" and text:"+n);a.skip(l.chars);break;case"=":if(l.lines!=a.peek(l.chars).split("\n").length-1)throw new Error("newline count is wrong in op =; cs:"+e+" and text:"+n);s.append(a.take(l.chars))}}return s.append(a.take(a.remaining())),s.toString()},t.mutateTextLines=function(e,n){for(var r=t.unpack(e),i=t.opIterator(r.ops),o=t.stringIterator(r.charBank),a=t.textLinesMutator(n);i.hasNext();){var s=i.next();switch(s.opcode){case"+":a.insert(o.take(s.chars),s.lines);break;case"-":a.remove(s.chars,s.lines);break;case"=":a.skip(s.chars,s.lines,!!s.attribs)}}a.close()},t.composeAttributes=function(e,n,r,i){if(!e&&r)return n;if(!n)return e;var o=[];e.replace(/\*([0-9a-z]+)/g,function(e,n){return o.push(i.getAttrib(t.parseNum(n))),""}),n.replace(/\*([0-9a-z]+)/g,function(e,n){for(var a=i.getAttrib(t.parseNum(n)),s=!1,l=0;l<o.length;l++){var u=o[l];if(u[0]==a[0]){a[1]||r?u[1]=a[1]:o.splice(l,1),s=!0;break}}return s||!a[1]&&!r||o.push(a),""}),o.sort();for(var a=t.stringAssembler(),s=0;s<o.length;s++)a.append("*"),a.append(t.numToString(i.putAttrib(o[s])));return a.toString()},t._slicerZipperFunc=function(e,n,r,i){if("-"==e.opcode)t.copyOp(e,r),e.opcode="";else if(e.opcode)switch(n.opcode){case"-":n.chars<=e.chars?("="==e.opcode&&(r.opcode="-",r.chars=n.chars,r.lines=n.lines,r.attribs=""),e.chars-=n.chars,e.lines-=n.lines,n.opcode="",e.chars||(e.opcode="")):("="==e.opcode&&(r.opcode="-",r.chars=e.chars,r.lines=e.lines,r.attribs=""),n.chars-=e.chars,n.lines-=e.lines,e.opcode="");break;case"+":t.copyOp(n,r),n.opcode="";break;case"=":n.chars<=e.chars?(r.opcode=e.opcode,r.chars=n.chars,r.lines=n.lines,r.attribs=t.composeAttributes(e.attribs,n.attribs,"="==e.opcode,i),n.opcode="",e.chars-=n.chars,e.lines-=n.lines,e.chars||(e.opcode="")):(r.opcode=e.opcode,r.chars=e.chars,r.lines=e.lines,r.attribs=t.composeAttributes(e.attribs,n.attribs,"="==e.opcode,i),e.opcode="",n.chars-=e.chars,n.lines-=e.lines);break;case"":t.copyOp(e,r),e.opcode=""}else t.copyOp(n,r),n.opcode=""},t.applyToAttribution=function(e,n,r){var i=t.unpack(e);return t.applyZip(n,0,i.ops,0,function(e,n,i){return t._slicerZipperFunc(e,n,i,r)})},t.mutateAttributionLines=function(e,n,r){function i(){return d&&d.hasNext()||p.hasMore()}function o(e){if((!d||!d.hasNext())&&p.hasMore()){var n=p.removeLines(1);d=t.opIterator(n)}d&&d.hasNext()?d.next(e):e.opcode=""}function a(e){f||(f=t.mergingOpAssembler()),f.append(e),e.lines>0&&(t.assert(1==e.lines,"Can't have op.lines of ",e.lines," in attribution lines"),p.insert(f.toString(),1),f=null)}for(var s=t.unpack(e),l=t.opIterator(s.ops),u=s.charBank,c=0,p=t.textLinesMutator(n),d=null,f=null,h=t.newOp(),m=t.newOp(),v=t.newOp();(h.opcode||l.hasNext()||m.opcode||i())&&(!h.opcode&&l.hasNext()&&l.next(h),h.opcode||m.opcode||f||d&&d.hasNext());)if(!("="==h.opcode&&h.lines>0)||h.attribs||m.opcode||f||d&&d.hasNext())if("+"==h.opcode){if(h.lines>1){var y=u.indexOf("\n",c)+1-c;t.copyOp(h,v),h.chars-=y,h.lines--,v.lines=1,v.chars=y}else t.copyOp(h,v),h.opcode="";a(v),c+=v.chars,v.opcode=""}else!m.opcode&&i()&&o(m),t._slicerZipperFunc(m,h,v,r),v.opcode&&(a(v),v.opcode="");else p.skipLines(h.lines),h.opcode="";t.assert(!f,"line assembler not finished"),p.close()},t.joinAttributionLines=function(e){for(var n=t.mergingOpAssembler(),r=0;r<e.length;r++)for(var i=e[r],o=t.opIterator(i);o.hasNext();)n.append(o.next());return n.toString()},t.splitAttributionLines=function(e,n){function r(e){o.append(e),e.lines>0&&(a.push(o.toString()),o.clear()),s+=e.chars}for(var i=t.opIterator(e),o=t.mergingOpAssembler(),a=[],s=0;i.hasNext();){for(var l=i.next(),u=l.chars,c=l.lines;c>1;){var p=n.indexOf("\n",s)+1;t.assert(p>0,"newlineEnd <= 0 in splitAttributionLines"),l.chars=p-s,l.lines=1,r(l),u-=l.chars,c-=l.lines}1==c&&(l.chars=u,l.lines=1),r(l)}return a},t.splitTextLines=function(e){return e.match(/[^\n]*(?:\n|[^\n]$)/g)},t.compose=function(e,n,r){var i=t.unpack(e),o=t.unpack(n),a=i.oldLen,s=i.newLen;t.assert(s==o.oldLen,"mismatched composition of two changesets");var l=o.newLen,u=t.stringIterator(i.charBank),c=t.stringIterator(o.charBank),p=t.stringAssembler(),d=t.applyZip(i.ops,0,o.ops,0,function(e,n,i){var o=e.opcode,a=n.opcode;"+"==o&&"-"==a&&u.skip(Math.min(e.chars,n.chars)),t._slicerZipperFunc(e,n,i,r),"+"==i.opcode&&("+"==a?p.append(c.take(i.chars)):p.append(u.take(i.chars)))});return t.pack(a,l,d,p.toString())},t.attributeTester=function(e,n){function r(e){return!1}if(!n)return r;var i=n.putAttrib(e,!0);if(i<0)return r;var o=new RegExp("\\*"+t.numToString(i)+"(?!\\w)");return function(e){return o.test(e)}},t.identity=function(e){return t.pack(e,e,"","")},t.makeSplice=function(e,n,r,i,o,a){var s=e.length;n>=s&&(n=s-1),r>e.length-n-1&&(r=e.length-n-1);var l=e.substring(n,n+r),u=s+i.length-l.length,c=t.smartOpAssembler();return c.appendOpWithText("=",e.substring(0,n)),c.appendOpWithText("-",l),c.appendOpWithText("+",i,o,a),c.endDocument(),t.pack(s,u,c.toString(),i)},t.toSplices=function(e){for(var n=t.unpack(e),r=[],i=0,o=t.opIterator(n.ops),a=t.stringIterator(n.charBank),s=!1;o.hasNext();){var l=o.next();"="==l.opcode?(i+=l.chars,s=!1):(s||(r.push([i,i,""]),s=!0),"-"==l.opcode?(i+=l.chars,r[r.length-1][1]+=l.chars):"+"==l.opcode&&(r[r.length-1][2]+=a.take(l.chars)))}return r},t.characterRangeFollow=function(e,n,r,i){for(var o=n,a=r,s=t.toSplices(e),l=0,u=0;u<s.length;u++){var c=s[u],p=c[0]+l,d=c[1]+l,f=c[2].length,h=f-(d-p);p<=o&&d>=a?o=a=i?p:p+f:d<=o?(o+=h,a+=h):p>=a||(p>=o&&d<=a?a+=h:d<a?(o=p+f,a+=h):a=p),l+=h}return[o,a]},t.moveOpsToNewPool=function(e,n,r){var i=e.indexOf("$");i<0&&(i=e.length);var o=e.substring(0,i),a=e.substring(i);return o.replace(/\*([0-9a-z]+)/g,function(e,i){var o=t.parseNum(i),a=n.getAttrib(o);a||t.error("Can't copy unknown attrib (reference attrib string to non-existant pool entry). Inconsistent attrib state!");var s=r.putAttrib(a);return"*"+t.numToString(s)})+a},t.makeAttribution=function(e){var n=t.smartOpAssembler();return n.appendOpWithText("+",e),n.toString()},t.eachAttribNumber=function(e,n){var r=e.indexOf("$");r<0&&(r=e.length);var i=e.substring(0,r);i.replace(/\*([0-9a-z]+)/g,function(e,r){return n(t.parseNum(r)),""})},t.filterAttribNumbers=function(e,n){return t.mapAttribNumbers(e,n)},t.mapAttribNumbers=function(e,n){var r=e.indexOf("$");r<0&&(r=e.length);var i=e.substring(0,r),o=i.replace(/\*([0-9a-z]+)/g,function(e,r){var i=n(t.parseNum(r));return i===!0?e:"number"==typeof i?"*"+t.numToString(i):""});return o+e.substring(r)},t.makeAText=function(e,n){return{text:e,attribs:n||t.makeAttribution(e)}},t.applyToAText=function(e,n,r){return{text:t.applyToText(e,n.text),attribs:t.applyToAttribution(e,n.attribs,r)}},t.cloneAText=function(e){return{text:e.text,attribs:e.attribs}},t.copyAText=function(e,t){t.text=e.text,t.attribs=e.attribs},t.appendATextToAssembler=function(e,n){for(var r=t.opIterator(e.attribs),i=t.newOp();r.hasNext();)if(r.next(i),
r.hasNext())n.append(i);else if(i.lines<=1)i.lines=0,i.chars--,i.chars&&n.append(i);else{var o=e.text.lastIndexOf("\n",e.text.length-2)+1,a=e.text.length-o-1;i.lines--,i.chars-=a+1,n.append(i),i.lines=0,i.chars=a,i.chars&&n.append(i)}},t.prepareForWire=function(n,r){var i=new e,o=t.moveOpsToNewPool(n,r,i);return{translated:o,pool:i}},t.isIdentity=function(e){var n=t.unpack(e);return""==n.ops&&n.oldLen==n.newLen},t.opAttributeValue=function(e,n,r){return t.attribsAttributeValue(e.attribs,n,r)},t.attribsAttributeValue=function(e,n,r){var i="";return e&&t.eachAttribNumber(e,function(e){r.getAttribKey(e)==n&&(i=r.getAttribValue(e))}),i},t.builder=function(e){var n=t.smartOpAssembler(),r=t.newOp(),i=t.stringAssembler(),o={keep:function(e,i,a,s){return r.opcode="=",r.attribs=a&&t.makeAttribsString("=",a,s)||"",r.chars=e,r.lines=i||0,n.append(r),o},keepText:function(e,t,r){return n.appendOpWithText("=",e,t,r),o},insert:function(e,t,r){return n.appendOpWithText("+",e,t,r),i.append(e),o},remove:function(e,t){return r.opcode="-",r.attribs="",r.chars=e,r.lines=t||0,n.append(r),o},toString:function(){n.endDocument();var r=e+n.getLengthChange();return t.pack(e,r,n.toString(),i.toString())}};return o},t.makeAttribsString=function(e,n,r){if(!n)return"";if("string"==typeof n)return n;if(r&&n&&n.length){n.length>1&&(n=n.slice(),n.sort());for(var i=[],o=0;o<n.length;o++){var a=n[o];("="==e||"+"==e&&a[1])&&i.push("*"+t.numToString(r.putAttrib(a)))}return i.join("")}},t.subattribution=function(e,n,r){function i(){if(l.chars)for(;l.opcode&&(s.opcode||o.hasNext());)s.opcode||o.next(s),l.opcode&&s.opcode&&l.chars>=s.chars&&s.lines>0&&l.lines<=0&&l.lines++,t._slicerZipperFunc(s,l,u,null),u.opcode&&(a.append(u),u.opcode="")}var o=t.opIterator(e,0),a=t.smartOpAssembler(),s=t.newOp(),l=t.newOp(),u=t.newOp();if(l.opcode="-",l.chars=n,i(),void 0===r)for(s.opcode&&a.append(s);o.hasNext();)o.next(s),a.append(s);else l.opcode="=",l.chars=r-n,i();return a.toString()},t.inverse=function(e,n,r,i){function o(e){return n.get?n.get(e):n[e]}function a(e){return r.get?r.get(e):r[e]}function s(e,n){if(!h||p!=d){h=t.opIterator(a(d)),p=d;for(var r=0,i=!1;!i&&h.hasNext();)h.next(m),r+m.chars>=f?(m.chars-=f-r,i=!0):r+=m.chars}for(;e>0;){m.chars||h.hasNext()||(d++,f=0,p=d,m.chars=0,h=t.opIterator(a(d))),m.chars||h.next(m);var o=Math.min(e,m.chars);n(o,m.attribs,o==m.chars&&m.lines>0),e-=o,m.chars-=o,f+=o}m.chars||h.hasNext()||(d++,f=0)}function l(e,t){t?(d+=t,f=0):h&&p==d?s(e,function(){}):f+=e}function u(e){var n=0,r=t.stringAssembler(),i=o(d).substring(f);n+=i.length,r.append(i);for(var a=d+1;n<e;){var s=o(a);n+=s.length,r.append(s),a++}return r.toString().substring(0,e)}function c(e){var t={};return function(n){return t[n]||(t[n]=e(n)),t[n]}}for(var p,d=0,f=0,h=null,m=t.newOp("+"),v=t.unpack(e),y=t.opIterator(v.ops),g=t.builder(v.newLen),b=[],w=[];y.hasNext();){var k=y.next();if("="==k.opcode)if(k.attribs){b.length=0,w.length=0,t.eachAttribNumber(k.attribs,function(e){b.push(i.getAttribKey(e)),w.push(i.getAttribValue(e))});var T=c(function(e){for(var n=[],r=0;r<b.length;r++){var o=b[r],a=w[r],s=t.attribsAttributeValue(e,o,i);a!=s&&n.push([o,s])}return t.makeAttribsString("=",n,i)});s(k.chars,function(e,t,n){g.keep(e,n?1:0,T(t))})}else l(k.chars,k.lines),g.keep(k.chars,k.lines);else if("+"==k.opcode)g.remove(k.chars,k.lines);else if("-"==k.opcode){var C=u(k.chars),O=0;s(k.chars,function(e,t,n){g.insert(C.substr(O,e),t),O+=e})}}return t.checkRep(g.toString())},t.follow=function(e,n,r,i){var o=t.unpack(e),a=t.unpack(n),s=o.oldLen,l=a.oldLen;t.assert(s==l,"mismatched follow - cannot transform cs1 on top of cs2");var u=t.stringIterator(o.charBank),c=t.stringIterator(a.charBank),p=o.newLen,d=0,f=0,h=t.attributeTester(["insertorder","first"],i),m=t.applyZip(o.ops,0,a.ops,0,function(e,n,o){if("+"==e.opcode||"+"==n.opcode){var a;if("+"!=n.opcode)a=1;else if("+"!=e.opcode)a=2;else{var s=u.peek(1),l=c.peek(1),p=h(e.attribs),m=h(n.attribs);a=p&&!m?1:m&&!p?2:"\n"==s&&"\n"!=l?2:"\n"!=s&&"\n"==l?1:r?2:1}1==a?(u.skip(e.chars),o.opcode="=",o.lines=e.lines,o.chars=e.chars,o.attribs="",e.opcode=""):(c.skip(n.chars),t.copyOp(n,o),n.opcode="")}else"-"==e.opcode?n.opcode?e.chars<=n.chars?(n.chars-=e.chars,n.lines-=e.lines,e.opcode="",n.chars||(n.opcode="")):(e.chars-=n.chars,e.lines-=n.lines,n.opcode=""):e.opcode="":"-"==n.opcode?(t.copyOp(n,o),e.opcode?n.chars<=e.chars?(e.chars-=n.chars,e.lines-=n.lines,n.opcode="",e.chars||(e.opcode="")):(o.lines=e.lines,o.chars=e.chars,n.lines-=e.lines,n.chars-=e.chars,e.opcode=""):n.opcode=""):e.opcode?n.opcode?(o.opcode="=",o.attribs=t.followAttributes(e.attribs,n.attribs,i),e.chars<=n.chars?(o.chars=e.chars,o.lines=e.lines,n.chars-=e.chars,n.lines-=e.lines,e.opcode="",n.chars||(n.opcode="")):(o.chars=n.chars,o.lines=n.lines,e.chars-=n.chars,e.lines-=n.lines,n.opcode="")):e.opcode="":(t.copyOp(n,o),n.opcode="");switch(o.opcode){case"=":d+=o.chars,f+=o.chars;break;case"-":d+=o.chars;break;case"+":f+=o.chars}});return f+=p-d,t.pack(p,f,m,a.charBank)},t.followAttributes=function(e,n,r){if(!n||!r)return"";if(!e)return n;var i=[];n.replace(/\*([0-9a-z]+)/g,function(e,n){return i.push(r.getAttrib(t.parseNum(n))),""}),e.replace(/\*([0-9a-z]+)/g,function(e,n){for(var o=r.getAttrib(t.parseNum(n)),a=0;a<i.length;a++){var s=i[a];if(o[0]==s[0]){o[1]<=s[1]&&i.splice(a,1);break}}return""});for(var o=t.stringAssembler(),a=0;a<i.length;a++)o.append("*"),o.append(t.numToString(r.putAttrib(i[a])));return o.toString()},t.composeWithDeletions=function(e,n,r){var i=t.unpack(e),o=t.unpack(n),a=i.oldLen,s=i.newLen;t.assert(s==o.oldLen,"mismatched composition of two changesets");var l=o.newLen,u=t.stringIterator(i.charBank),c=t.stringIterator(o.charBank),p=t.stringAssembler(),d=t.applyZip(i.ops,0,o.ops,0,function(e,n,i){var o=e.opcode,a=n.opcode;"+"==o&&"-"==a&&u.skip(Math.min(e.chars,n.chars)),t._slicerZipperFuncWithDeletions(e,n,i,r),"+"==i.opcode&&("+"==a?p.append(c.take(i.chars)):p.append(u.take(i.chars)))});return t.pack(a,l,d,p.toString())},t._slicerZipperFuncWithDeletions=function(e,n,r,i){if("-"==e.opcode)t.copyOp(e,r),e.opcode="";else if(e.opcode)switch(n.opcode){case"-":n.chars<=e.chars?("="==e.opcode&&(r.opcode="-",r.chars=n.chars,r.lines=n.lines,r.attribs=n.attribs),e.chars-=n.chars,e.lines-=n.lines,n.opcode="",e.chars||(e.opcode="")):("="==e.opcode&&(r.opcode="-",r.chars=e.chars,r.lines=e.lines,r.attribs=n.attribs),n.chars-=e.chars,n.lines-=e.lines,e.opcode="");break;case"+":t.copyOp(n,r),n.opcode="";break;case"=":n.chars<=e.chars?(r.opcode=e.opcode,r.chars=n.chars,r.lines=n.lines,r.attribs=t.composeAttributes(e.attribs,n.attribs,"="==e.opcode,i),n.opcode="",e.chars-=n.chars,e.lines-=n.lines,e.chars||(e.opcode="")):(r.opcode=e.opcode,r.chars=e.chars,r.lines=e.lines,r.attribs=t.composeAttributes(e.attribs,n.attribs,"="==e.opcode,i),e.opcode="",n.chars-=e.chars,n.lines-=e.lines);break;case"":t.copyOp(e,r),e.opcode=""}else t.copyOp(n,r),n.opcode=""},t}.apply(t,r),!(void 0!==i&&(e.exports=i))},314:function(e,t,n){var r;r=function(){var e=function(){this.numToAttrib={},this.attribToNum={},this.nextNum=0};return e.prototype.putAttrib=function(e,t){var n=String(e);if(n in this.attribToNum)return this.attribToNum[n];if(t)return-1;var r=this.nextNum++;return this.attribToNum[n]=r,this.numToAttrib[r]=[String(e[0]||""),String(e[1]||"")],r},e.prototype.getAttrib=function(e){var t=this.numToAttrib[e];return t?[t[0],t[1]]:t},e.prototype.getAttribKey=function(e){var t=this.numToAttrib[e];return t?t[0]:""},e.prototype.getAttribValue=function(e){var t=this.numToAttrib[e];return t?t[1]:""},e.prototype.eachAttrib=function(e){for(var t in this.numToAttrib){var n=this.numToAttrib[t];e(n[0],n[1])}},e.prototype.toJsonable=function(){return{numToAttrib:this.numToAttrib,nextNum:this.nextNum}},e.prototype.fromJsonable=function(e){this.numToAttrib=e.numToAttrib,this.nextNum=e.nextNum,this.attribToNum={};for(var t in this.numToAttrib)this.attribToNum[String(this.numToAttrib[t])]=Number(t);return this},e}.call(t,n,t,e),!(void 0!==r&&(e.exports=r))},334:function(e,t){function n(){var e={fileSize:10485760,attachmentCount:1/0,teamworkerCount:5},t=cow.currentUser;if(!t||!t.accountType)return e;var n=t.accountType;return"personal_free"===n?e:(["personal_premium","enterprise_standard","enterprise_expired"].indexOf(n)>-1?(e.fileSize=1/0,e.teamworkerCount=100):"enterprise_dingding"===n&&(e.fileSize=1/0,e.teamworkerCount=1/0),e)}var r=[{name:"双十二活动",order:0,enable:!0,recordTag:"double_12_activity",text:"双12年度特惠，企业版买几人送几人！",targetLink:"https://shimodocs.mikecrm.com/OyO74o",openNewTab:!0,startDate:"2016/12/12 00:00:00",endDate:"2016/12/12 23:59:59",targetUser:{isEnterpriseOfficial:!1}}];e.exports={initLimition:n,notifications:r}},378:function(e,t,n){function r(e,t,n){var r=t&&n||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){i<16&&(t[r+i++]=u[e])});i<16;)t[r+i++]=0;return t}function i(e,t){var n=t||0,r=l;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function o(e,t,n){var r=t&&n||0,o=t||[];e=e||{};var a=void 0!==e.clockseq?e.clockseq:f,s=void 0!==e.msecs?e.msecs:(new Date).getTime(),l=void 0!==e.nsecs?e.nsecs:m+1,u=s-h+(l-m)/1e4;if(u<0&&void 0===e.clockseq&&(a=a+1&16383),(u<0||s>h)&&void 0===e.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=s,m=l,f=a,s+=122192928e5;var c=(1e4*(268435455&s)+l)%4294967296;o[r++]=c>>>24&255,o[r++]=c>>>16&255,o[r++]=c>>>8&255,o[r++]=255&c;var p=s/4294967296*1e4&268435455;o[r++]=p>>>8&255,o[r++]=255&p,o[r++]=p>>>24&15|16,o[r++]=p>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var v=e.node||d,y=0;y<6;y++)o[r+y]=v[y];return t?t:i(o)}function a(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var o=e.random||(e.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;a++)t[r+a]=o[a];return t||i(o)}for(var s=n(379),l=[],u={},c=0;c<256;c++)l[c]=(c+256).toString(16).substr(1),u[l[c]]=c;var p=s(),d=[1|p[0],p[1],p[2],p[3],p[4],p[5]],f=16383&(p[6]<<8|p[7]),h=0,m=0,v=a;v.v1=o,v.v4=a,v.parse=r,v.unparse=i,e.exports=v},379:function(e,t){(function(t){var n,r=t.crypto||t.msCrypto;if(r&&r.getRandomValues){var i=new Uint8Array(16);n=function(){return r.getRandomValues(i),i}}if(!n){var o=new Array(16);n=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}e.exports=n}).call(t,function(){return this}())},388:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(4),a=n(378).v4,s=function(){function e(t){var n=this;r(this,e),this.key="shimo-offline-data",this.userId=t.userId,t.localStorage||"undefined"==typeof localStorage||(t.localStorage=localStorage),this.clientId=t.clientId,this.store=t.localStorage;try{this.store.setItem("test","test")}catch(e){throw new Error("localStorage is not working")}var i=this._getAll(),o=a();Object.keys(i).forEach(function(e){if(i[e]){var t=Object.keys(i[e]);t.forEach(function(r){t[0]&&/^[a-zA-Z0-9]{16}$/.test(t[0])&&(n.set(r,i[e][r],o),i=n._getAll(),delete i[e][r],n.store.setItem(n.key,JSON.stringify(i)),i=n._getAll())})}})}return i(e,[{key:"_getAll",value:function(){return JSON.parse(this.store.getItem(this.key))||{}}},{key:"getAll",value:function(){return this._getAll()[this.userId]||{}}},{key:"get",value:function(e,t){var n=t||this.clientId;return o.get(this._getAll(),this.userId+"."+n+"."+e)}},{key:"remove",value:function(e,t){var n=t||this.clientId,r=this._getAll();o.get(r,this.userId+"."+n+"."+e)&&(delete r[this.userId][n][e],0===Object.keys(r[this.userId][n]).length&&delete r[this.userId][n]),this.store.setItem(this.key,JSON.stringify(r))}},{key:"set",value:function(e,t,n){var r=n||this.clientId,i=this._getAll(),a=this.userId;o.set(i,a+"."+r+"."+e,o.assign({guid:e},t)),this.store.setItem(this.key,JSON.stringify(i))}}]),e}();e.exports=s},390:function(e,t,n){(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e){switch(e.type){case"RECONNECT_READY":g.cooperators.length=0,a(e.clients);break;case"USER_ENTER":a([e.userInfo]);break;case"USER_LEAVE":s([e.userInfo])}}function a(e){e.forEach(function(e){if(e.id!==b.id){var t=r.find(g.cooperators,{id:e.id});t?t.count++:(e.color=p(e.id),e.count=1,g.cooperators.push(e),f.default.notify("avatar:add",e))}}),l()}function s(e){e.forEach(function(e){e.id!==b.id&&r.remove(g.cooperators,function(t){return t.id===e.id&&--t.count<=0})}),l()}function l(){f.default.notify("cooperation:updateAvatar",g.cooperators)}function u(e){g.status="loading",g.currentFileGuid=e,g.cooperators=[],l(),y.default.getFileCollaborators(e).then(function(e){for(g.status="loaded",c(e);g.messagePool.length;)o(g.messagePool.pop())},function(){return c([])})}function c(e){g.shareUserMaps={},(e||[]).forEach(function(e,t){e.index=t,g.shareUserMaps[e.id]=e}),g.shareUsers=r.sortBy(e,["index"],["asc"])}function p(e){return+e===b.id?w:g.shareUserMaps[e]?k[g.shareUserMaps[e].index%40]:cow.guideUsers&&cow.guideUsers.indexOf(e)>-1?k[cow.guideUsers.indexOf(e)%40]:"#41464b"}Object.defineProperty(t,"__esModule",{value:!0});var d=n(166),f=i(d),h=n(184),m=i(h),v=n(266),y=i(v),g={},b=cow.currentUser,w="#5292F7",k=["#A69ACA","#EC6E79","#F39801","#00A496","#FFD900","#674599","#83D4E7","#AF7C4F","#B8D200","#9D5B8B","#F15B1C","#41464B","#CD9F00","#47885E","#D7003B","#436EC9","#F897C7","#9C4109","#6E7A56","#83D4E7","#83609C","#F8DCDB","#E7C39C","#87B151","#9E0038","#B09FC9","#7DCFC8","#BEE7F0","#CD9F00","#CBAAC2","#F5C5C9","#CD8C28","#1A5A52","#9EB4E1","#406619","#CAB738","#F6C751","#8D699D","#613A14","#189DEC"];g.shareUserMaps={},g.shareUsers=[],g.cooperators=[],g.status="",g.currentFileGuid="",g.messagePool=[],m.default.bind("Invite",function(e){if("create"===e.db_event)!function(){var t=g.shareUsers.length?g.shareUsers.slice(-1)[0].index:-1;r.isArray(e.data)?e.data.forEach(function(e,n){e.index=t+n+1,g.shareUsers.push(e),g.shareUserMaps[e.id]=e}):(e.data.index=t+1,g.shareUserMaps[e.data.id]=e.data,g.shareUsers.push(e.data))}();else if("delete"===e.db_event){var t=r.remove(g.shareUsers,function(t){return r.isArray(e.data)?e.data.some(function(e){return e.id===t.id}):e.data.id===t.id});t.forEach(function(e){g.shareUserMaps[e.id]&&delete g.shareUserMaps[e.id]})}}),f.default.attach("socket:message",function(e){cow.currentFile.guid===g.currentFileGuid&&(["USER_ENTER","USER_LEAVE","SELECT","UNSELECT"].indexOf(e.data.type)>=0&&+e.data.userInfo.id===b.id||"COLLABROOM"===e.type&&("loaded"===g.status?o(e.data):"loading"===g.status&&g.messagePool.push(e.data)))}),t.default={reset:u,getColor:p},e.exports=t.default}).call(t,n(4))},391:function(e,t,n){var r,i;r=[n(392)],i=function(e){return e.configure({minimum:.6,easing:"linear",positionUsing:"",speed:250,trickle:!0,trickleRate:.01,trickleSpeed:150,showSpinner:!1,barSelector:'[role="bar"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div></div></div>'}),e}.apply(t,r),!(void 0!==i&&(e.exports=i))},392:function(e,t,n){var r,i;!function(o,a){r=a,i="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==i&&(e.exports=i))}(this,function(){function e(e,t,n){return e<t?t:e>n?n:e}function t(e){return 100*(-1+e)}function n(e,n,r){var i;return i="translate3d"===u.positionUsing?{transform:"translate3d("+t(e)+"%,0,0)"}:"translate"===u.positionUsing?{transform:"translate("+t(e)+"%,0)"}:{"margin-left":t(e)+"%"},i.transition="all "+n+"ms "+r,i}function r(e,t){var n="string"==typeof e?e:a(e);return n.indexOf(" "+t+" ")>=0}function i(e,t){var n=a(e),i=n+t;r(n,t)||(e.className=i.substring(1))}function o(e,t){var n,i=a(e);r(e,t)&&(n=i.replace(" "+t+" "," "),e.className=n.substring(1,n.length-1))}function a(e){return(" "+(e.className||"")+" ").replace(/\s+/gi," ")}function s(e){e&&e.parentNode&&e.parentNode.removeChild(e)}var l={};l.version="0.2.0";var u=l.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};l.configure=function(e){var t,n;for(t in e)n=e[t],void 0!==n&&e.hasOwnProperty(t)&&(u[t]=n);return this},l.status=null,l.set=function(t){var r=l.isStarted();t=e(t,u.minimum,1),l.status=1===t?null:t;var i=l.render(!r),o=i.querySelector(u.barSelector),a=u.speed,s=u.easing;return i.offsetWidth,c(function(e){""===u.positionUsing&&(u.positionUsing=l.getPositioningCSS()),p(o,n(t,a,s)),1===t?(p(i,{transition:"none",opacity:1}),i.offsetWidth,setTimeout(function(){p(i,{transition:"all "+a+"ms linear",opacity:0}),setTimeout(function(){l.remove(),e()},a)},a)):setTimeout(e,a)}),this},l.isStarted=function(){return"number"==typeof l.status},l.start=function(){l.status||l.set(0);var e=function(){setTimeout(function(){l.status&&(l.trickle(),e())},u.trickleSpeed)};return u.trickle&&e(),this},l.done=function(e){return e||l.status?l.inc(.3+.5*Math.random()).set(1):this},l.inc=function(t){var n=l.status;return n?("number"!=typeof t&&(t=(1-n)*e(Math.random()*n,.1,.95)),n=e(n+t,0,.994),l.set(n)):l.start()},l.trickle=function(){return l.inc(Math.random()*u.trickleRate)},function(){var e=0,t=0;l.promise=function(n){return n&&"resolved"!==n.state()?(0===t&&l.start(),e++,t++,n.always(function(){t--,0===t?(e=0,l.done()):l.set((e-t)/e)}),this):this}}(),l.render=function(e){if(l.isRendered())return document.getElementById("nprogress");i(document.documentElement,"nprogress-busy");var n=document.createElement("div");n.id="nprogress",n.innerHTML=u.template;var r,o=n.querySelector(u.barSelector),a=e?"-100":t(l.status||0),c=document.querySelector(u.parent);return p(o,{transition:"all 0 linear",transform:"translate3d("+a+"%,0,0)"}),u.showSpinner||(r=n.querySelector(u.spinnerSelector),r&&s(r)),c!=document.body&&i(c,"nprogress-custom-parent"),c.appendChild(n),n},l.remove=function(){o(document.documentElement,"nprogress-busy"),o(document.querySelector(u.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&s(e)},l.isRendered=function(){return!!document.getElementById("nprogress")},l.getPositioningCSS=function(){var e=document.body.style,t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return t+"Perspective"in e?"translate3d":t+"Transform"in e?"translate":"margin"};var c=function(){function e(){var n=t.shift();n&&n(e)}var t=[];return function(n){t.push(n),1==t.length&&e()}}(),p=function(){function e(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function t(e){var t=document.body.style;if(e in t)return e;for(var n,r=i.length,o=e.charAt(0).toUpperCase()+e.slice(1);r--;)if(n=i[r]+o,n in t)return n;return e}function n(n){return n=e(n),o[n]||(o[n]=t(n))}function r(e,t,r){t=n(t),e.style[t]=r}var i=["Webkit","O","Moz","ms"],o={};return function(e,t){var n,i,o=arguments;if(2==o.length)for(n in t)i=t[n],void 0!==i&&t.hasOwnProperty(n)&&r(e,n,i);else r(e,o[1],o[2])}}();return l})},393:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){n.e(5,function(i){(function(i){var o=n(394).SpreadsheetContainer,a=n(1022);a(i.extend({SpreadsheetContainer:o,guid:e,sheetId:t},r))}).call(this,n(4))})},e.exports=t.default},396:function(e,t,n){"use strict";function r(e){var t="transition"+e+"Timeout",n="transition"+e;return function(e){if(e[n]){if(null==e[t])return new Error(t+" wasn't supplied to ReactCSSTransitionGroup: this can cause unreliable animations and won't be supported in a future version of React. See https://fb.me/react-animation-transition-group-timeout for more information.");if("number"!=typeof e[t])return new Error(t+" must be a number (in milliseconds)")}}}var i=n(8),o=n(44),a=n(397),s=n(399),l=i.createClass({displayName:"ReactCSSTransitionGroup",propTypes:{transitionName:s.propTypes.name,transitionAppear:i.PropTypes.bool,transitionEnter:i.PropTypes.bool,transitionLeave:i.PropTypes.bool,transitionAppearTimeout:r("Appear"),transitionEnterTimeout:r("Enter"),transitionLeaveTimeout:r("Leave")},getDefaultProps:function(){return{transitionAppear:!1,transitionEnter:!0,transitionLeave:!0}},_wrapChild:function(e){return i.createElement(s,{name:this.props.transitionName,appear:this.props.transitionAppear,enter:this.props.transitionEnter,leave:this.props.transitionLeave,appearTimeout:this.props.transitionAppearTimeout,enterTimeout:this.props.transitionEnterTimeout,leaveTimeout:this.props.transitionLeaveTimeout},e)},render:function(){return i.createElement(a,o({},this.props,{childFactory:this._wrapChild}))}});e.exports=l},397:function(e,t,n){"use strict";var r=n(8),i=n(398),o=n(44),a=n(20),s=r.createClass({displayName:"ReactTransitionGroup",propTypes:{component:r.PropTypes.any,childFactory:r.PropTypes.func},getDefaultProps:function(){return{component:"span",childFactory:a.thatReturnsArgument}},getInitialState:function(){return{children:i.getChildMapping(this.props.children)}},componentWillMount:function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},componentDidMount:function(){var e=this.state.children;for(var t in e)e[t]&&this.performAppear(t)},componentWillReceiveProps:function(e){var t=i.getChildMapping(e.children),n=this.state.children;this.setState({children:i.mergeChildMappings(n,t)});var r;for(r in t){var o=n&&n.hasOwnProperty(r);!t[r]||o||this.currentlyTransitioningKeys[r]||this.keysToEnter.push(r)}for(r in n){var a=t&&t.hasOwnProperty(r);!n[r]||a||this.currentlyTransitioningKeys[r]||this.keysToLeave.push(r)}},componentDidUpdate:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)},performAppear:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)},_handleDoneAppearing:function(e){var t=this.refs[e];t.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e];var n=i.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)||this.performLeave(e)},performEnter:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)},_handleDoneEntering:function(e){var t=this.refs[e];t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e];var n=i.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)||this.performLeave(e)},performLeave:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillLeave?t.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)},_handleDoneLeaving:function(e){var t=this.refs[e];t.componentDidLeave&&t.componentDidLeave(),delete this.currentlyTransitioningKeys[e];var n=i.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)?this.performEnter(e):this.setState(function(t){var n=o({},t.children);return delete n[e],{children:n}})},render:function(){var e=[];for(var t in this.state.children){var n=this.state.children[t];n&&e.push(r.cloneElement(this.props.childFactory(n),{ref:t,key:t}))}return r.createElement(this.props.component,this.props,e)}});e.exports=s},398:function(e,t,n){"use strict";var r=n(121),i={getChildMapping:function(e){return e?r(e):e},mergeChildMappings:function(e,t){function n(n){return t.hasOwnProperty(n)?t[n]:e[n]}e=e||{},t=t||{};var r={},i=[];for(var o in e)t.hasOwnProperty(o)?i.length&&(r[o]=i,i=[]):i.push(o);var a,s={};for(var l in t){if(r.hasOwnProperty(l))for(a=0;a<r[l].length;a++){var u=r[l][a];s[r[l][a]]=n(u)}s[l]=n(l)}for(a=0;a<i.length;a++)s[i[a]]=n(i[a]);return s}};e.exports=i},399:function(e,t,n){"use strict";var r=n(8),i=n(9),o=n(400),a=n(401),s=n(157),l=17,u=r.createClass({displayName:"ReactCSSTransitionGroupChild",propTypes:{name:r.PropTypes.oneOfType([r.PropTypes.string,r.PropTypes.shape({enter:r.PropTypes.string,leave:r.PropTypes.string,active:r.PropTypes.string}),r.PropTypes.shape({enter:r.PropTypes.string,enterActive:r.PropTypes.string,leave:r.PropTypes.string,leaveActive:r.PropTypes.string,appear:r.PropTypes.string,appearActive:r.PropTypes.string})]).isRequired,appear:r.PropTypes.bool,enter:r.PropTypes.bool,leave:r.PropTypes.bool,appearTimeout:r.PropTypes.number,enterTimeout:r.PropTypes.number,leaveTimeout:r.PropTypes.number},transition:function(e,t,n){var r=i.findDOMNode(this);if(!r)return void(t&&t());var s=this.props.name[e]||this.props.name+"-"+e,l=this.props.name[e+"Active"]||s+"-active",u=null,c=function(e){e&&e.target!==r||(clearTimeout(u),o.removeClass(r,s),o.removeClass(r,l),a.removeEndEventListener(r,c),t&&t())};o.addClass(r,s),this.queueClass(l),n?(u=setTimeout(c,n),this.transitionTimeouts.push(u)):a.addEndEventListener(r,c)},queueClass:function(e){this.classNameQueue.push(e),this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,l))},flushClassNameQueue:function(){this.isMounted()&&this.classNameQueue.forEach(o.addClass.bind(o,i.findDOMNode(this))),this.classNameQueue.length=0,this.timeout=null},componentWillMount:function(){this.classNameQueue=[],this.transitionTimeouts=[]},componentWillUnmount:function(){this.timeout&&clearTimeout(this.timeout),this.transitionTimeouts.forEach(function(e){clearTimeout(e)})},componentWillAppear:function(e){this.props.appear?this.transition("appear",e,this.props.appearTimeout):e()},componentWillEnter:function(e){this.props.enter?this.transition("enter",e,this.props.enterTimeout):e()},componentWillLeave:function(e){this.props.leave?this.transition("leave",e,this.props.leaveTimeout):e()},render:function(){return s(this.props.children)}});e.exports=u},400:function(e,t,n){"use strict";var r=n(18),i={addClass:function(e,t){return/\s/.test(t)?r(!1):void 0,t&&(e.classList?e.classList.add(t):i.hasClass(e,t)||(e.className=e.className+" "+t)),e},removeClass:function(e,t){return/\s/.test(t)?r(!1):void 0,t&&(e.classList?e.classList.remove(t):i.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),e},conditionClass:function(e,t,n){return(n?i.addClass:i.removeClass)(e,t)},hasClass:function(e,t){return/\s/.test(t)?r(!1):void 0,e.classList?!!t&&e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}};e.exports=i},401:function(e,t,n){"use strict";function r(){var e=document.createElement("div"),t=e.style;"AnimationEvent"in window||delete s.animationend.animation,"TransitionEvent"in window||delete s.transitionend.transition;for(var n in s){var r=s[n];for(var i in r)if(i in t){l.push(r[i]);break}}}function i(e,t,n){e.addEventListener(t,n,!1)}function o(e,t,n){e.removeEventListener(t,n,!1)}var a=n(14),s={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},l=[];a.canUseDOM&&r();var u={addEndEventListener:function(e,t){return 0===l.length?void window.setTimeout(t,0):void l.forEach(function(n){i(e,n,t)})},removeEndEventListener:function(e,t){0!==l.length&&l.forEach(function(n){o(e,n,t)})}};e.exports=u},665:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},u=n(7),c=r(u),p=n(162),d=r(p);t.default=function(e){return function(t){function n(){i(this,n),l(Object.getPrototypeOf(n.prototype),"constructor",this).call(this),this.checkClick=this.checkClick.bind(this),this.checkResize=this.checkResize.bind(this)}return o(n,t),s(n,[{key:"componentDidMount",value:function(){this.bindClick(),this.bindResize()}},{key:"componentWillUnmount",value:function(){this.unbindClick(),this.unbindResize()}},{key:"isDescendant",value:function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1}},{key:"checkClick",value:function(e){var t=d.default.findDOMNode(this),n=e.target,r=this.refs.composedComponent.componentClick;n!==t&&!this.isDescendant(t,n)&&document.documentElement.contains(n)&&"function"==typeof r&&r(e,t)}},{key:"checkResize",value:function(e){var t=this.refs.composedComponent.componentResize;"function"==typeof t&&t(e)}},{key:"bindClick",value:function(){document.addEventListener("mouseup",this.checkClick),document.addEventListener("touchend",this.checkClick)}},{key:"unbindClick",value:function(){document.removeEventListener("mouseup",this.checkClick),document.removeEventListener("touchend",this.checkClick)}},{key:"bindResize",value:function(){window.addEventListener("resize",this.checkResize)}},{key:"unbindResize",value:function(){window.removeEventListener("resize",this.checkResize)}},{key:"render",value:function(){return c.default.createElement(e,a({ref:"composedComponent"},this.props))}}]),n}(u.Component)},e.exports=t.default},718:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(719),o=r(i);t.default=o.default,e.exports=t.default},719:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,
n=a,r=!0,s=u=void 0}},u=n(7),c=r(u),p=n(720),d=r(p),f=function(e){function t(){i(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return o(t,e),s(t,[{key:"getPopupDomNode",value:function(){return this.refs.tooltip.getPopupDomNode()}},{key:"renderOverlay",value:function(){var e=this.props,t=e.title,n=e.prefixCls,r=e.content,i=e.innerClass;return c.default.createElement("div",{className:i},t&&c.default.createElement("div",{className:(i||n)+"-title"},t),c.default.createElement("div",{className:(i||n)+"-inner-content"},r))}},{key:"render",value:function(){return c.default.createElement(d.default,a({ref:"tooltip"},this.props,{overlay:this.renderOverlay()}))}}],[{key:"defaultProps",get:function(){return{prefixCls:"sm-popover",placement:"bottomRight",trigger:"click",mouseEnterDelay:.1,mouseLeaveDelay:.1,overlayStyle:{},innerClass:""}}}]),t}(u.Component);t.default=f,e.exports=t.default},720:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(721),o=r(i);t.default=o.default,e.exports=t.default},721:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},c=n(7),p=r(c),d=n(722),f=r(d),h=n(798),m=n(285),v=r(m);n(799);var y=function(e){function t(e){o(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={visible:!1},this.onVisibleChange=this.onVisibleChange.bind(this),this.onPopupAlign=this.onPopupAlign.bind(this)}return a(t,e),l(t,null,[{key:"defaultProps",get:function(){return{prefixCls:"sm-tooltip",placement:"top",mouseEnterDelay:.1,mouseLeaveDelay:.1,arrowPointAtCenter:!1,onVisibleChange:function(){}}}},{key:"propTypes",get:function(){return{title:c.PropTypes.string,overlay:c.PropTypes.oneOfType([c.PropTypes.node,c.PropTypes.func]),onVisibleChange:c.PropTypes.func,visible:c.PropTypes.bool,prefixCls:c.PropTypes.string,openClassName:c.PropTypes.string,arrowPointAtCenter:c.PropTypes.bool,builtinPlacements:c.PropTypes.object,trigger:c.PropTypes.oneOf(["hover","click","focus","none"]),placement:c.PropTypes.oneOf(["top","right","bottom","left","topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"])}}}]),l(t,[{key:"onVisibleChange",value:function(e){this.setState({visible:e}),this.props.onVisibleChange(e)}},{key:"getPopupDomNode",value:function(){return this.refs.tooltip.getPopupDomNode()}},{key:"getPlacements",value:function(){var e=this.props,t=e.builtinPlacements,n=e.arrowPointAtCenter;return t||(0,h.getPlacements)({arrowPointAtCenter:n,verticalArrowShift:8,horizontalArrowShif:16,arrowWidth:5})}},{key:"onPopupAlign",value:function(e,t){var n=this.getPlacements(),r=Object.keys(n).filter(function(e){return n[e].points[0]===t.points[0]&&n[e].points[1]===t.points[1]})[0];if(r){var i=e.getBoundingClientRect(),o={top:"50%",left:"50%"};r.indexOf("top")>=0||r.indexOf("Bottom")>=0?o.top=i.height-t.offset[1]+"px":(r.indexOf("Top")>=0||r.indexOf("bottom")>=0)&&(o.top=-t.offset[1]+"px"),r.indexOf("left")>=0||r.indexOf("Right")>=0?o.left=i.width-t.offset[0]+"px":(r.indexOf("right")>=0||r.indexOf("Left")>=0)&&(o.left=-t.offset[0]+"px"),e.style.transformOrigin=o.left+" "+o.top}}},{key:"render",value:function(){var e,t=this.props,n=t.prefixCls,r=t.title,o=t.overlay,a=t.children,l=this.state.visible;r||o||(l=!1),"visible"in this.props&&(l=this.props.visible);var u=null;"string"==typeof r?u=function(){return p.default.createElement("span",{className:n+"-text"},r)}:o&&(u=o);var c=a?a.props:{},d=(0,v.default)((e={},i(e,c.className,!!c.className),i(e,this.props.openClassName||n+"-open",!0),e));return p.default.createElement(f.default,s({overlay:u,visible:l,onPopupAlign:this.onPopupAlign,ref:"tooltip"},this.props,{builtinPlacements:this.getPlacements(),onVisibleChange:this.onVisibleChange}),l?p.default.cloneElement(a,{className:d}):a)}}]),t}(c.Component);t.default=y,e.exports=t.default},722:function(e,t,n){"use strict";e.exports=n(723)},723:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(7),s=r(a),l=n(724),u=n(725),c=r(u),p=s.default.createClass({displayName:"Tooltip",propTypes:{trigger:a.PropTypes.any,children:a.PropTypes.any,defaultVisible:a.PropTypes.bool,visible:a.PropTypes.bool,placement:a.PropTypes.string,transitionName:a.PropTypes.string,animation:a.PropTypes.any,onVisibleChange:a.PropTypes.func,afterVisibleChange:a.PropTypes.func,overlay:a.PropTypes.oneOfType([s.default.PropTypes.node,s.default.PropTypes.func]).isRequired,overlayStyle:a.PropTypes.object,overlayClassName:a.PropTypes.string,prefixCls:a.PropTypes.string,mouseEnterDelay:a.PropTypes.number,mouseLeaveDelay:a.PropTypes.number,getTooltipContainer:a.PropTypes.func,destroyTooltipOnHide:a.PropTypes.bool,align:a.PropTypes.object,arrowContent:a.PropTypes.any},getDefaultProps:function(){return{prefixCls:"rc-tooltip",mouseEnterDelay:0,destroyTooltipOnHide:!1,mouseLeaveDelay:.1,align:{},placement:"right",trigger:["hover"],arrowContent:null}},getPopupElement:function(){var e=this.props,t=e.arrowContent,n=e.overlay,r=e.prefixCls;return[s.default.createElement("div",{className:r+"-arrow",key:"arrow"},t),s.default.createElement("div",{className:r+"-inner",key:"content"},"function"==typeof n?n():n)]},getPopupDomNode:function(){return this.refs.trigger.getPopupDomNode()},render:function(){var e=this.props,t=e.overlayClassName,n=e.trigger,r=e.mouseEnterDelay,a=e.mouseLeaveDelay,u=e.overlayStyle,p=e.prefixCls,d=e.children,f=e.onVisibleChange,h=e.transitionName,m=e.animation,v=e.placement,y=e.align,g=e.destroyTooltipOnHide,b=e.defaultVisible,w=e.getTooltipContainer,k=i(e,["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","transitionName","animation","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer"]),T=o({},k);return"visible"in this.props&&(T.popupVisible=this.props.visible),s.default.createElement(c.default,o({popupClassName:t,ref:"trigger",prefixCls:p,popup:this.getPopupElement,action:n,builtinPlacements:l.placements,popupPlacement:v,popupAlign:y,getPopupContainer:w,onPopupVisibleChange:f,popupTransitionName:h,popupAnimation:m,defaultPopupVisible:b,destroyPopupOnHide:g,mouseLeaveDelay:a,popupStyle:u,mouseEnterDelay:r},T),d)}});t.default=p,e.exports=t.default},724:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={adjustX:1,adjustY:1},r=[0,0],i=t.placements={left:{points:["cr","cl"],overflow:n,offset:[-4,0],targetOffset:r},right:{points:["cl","cr"],overflow:n,offset:[4,0],targetOffset:r},top:{points:["bc","tc"],overflow:n,offset:[0,-4],targetOffset:r},bottom:{points:["tc","bc"],overflow:n,offset:[0,4],targetOffset:r},topLeft:{points:["bl","tl"],overflow:n,offset:[0,-4],targetOffset:r},leftTop:{points:["tr","tl"],overflow:n,offset:[-4,0],targetOffset:r},topRight:{points:["br","tr"],overflow:n,offset:[0,-4],targetOffset:r},rightTop:{points:["tl","tr"],overflow:n,offset:[4,0],targetOffset:r},bottomRight:{points:["tr","br"],overflow:n,offset:[0,4],targetOffset:r},rightBottom:{points:["bl","br"],overflow:n,offset:[4,0],targetOffset:r},bottomLeft:{points:["tl","bl"],overflow:n,offset:[0,4],targetOffset:r},leftBottom:{points:["br","bl"],overflow:n,offset:[-4,0],targetOffset:r}};t.default=i},725:function(e,t,n){"use strict";e.exports=n(726)},726:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){}function o(){return""}Object.defineProperty(t,"__esModule",{value:!0});var a=n(727),s=r(a),l=n(7),u=r(l),c=n(162),p=r(c),d=n(765),f=r(d),h=n(766),m=r(h),v=n(771),y=r(v),g=n(796),b=n(797),w=r(b),k=["onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"],T=u.default.createClass({displayName:"Trigger",propTypes:{children:l.PropTypes.any,action:l.PropTypes.oneOfType([l.PropTypes.string,l.PropTypes.arrayOf(l.PropTypes.string)]),showAction:l.PropTypes.any,hideAction:l.PropTypes.any,getPopupClassNameFromAlign:l.PropTypes.any,onPopupVisibleChange:l.PropTypes.func,afterPopupVisibleChange:l.PropTypes.func,popup:l.PropTypes.oneOfType([l.PropTypes.node,l.PropTypes.func]).isRequired,popupStyle:l.PropTypes.object,prefixCls:l.PropTypes.string,popupClassName:l.PropTypes.string,popupPlacement:l.PropTypes.string,builtinPlacements:l.PropTypes.object,popupTransitionName:l.PropTypes.string,popupAnimation:l.PropTypes.any,mouseEnterDelay:l.PropTypes.number,mouseLeaveDelay:l.PropTypes.number,zIndex:l.PropTypes.number,focusDelay:l.PropTypes.number,blurDelay:l.PropTypes.number,getPopupContainer:l.PropTypes.func,destroyPopupOnHide:l.PropTypes.bool,mask:l.PropTypes.bool,maskClosable:l.PropTypes.bool,onPopupAlign:l.PropTypes.func,popupAlign:l.PropTypes.object,popupVisible:l.PropTypes.bool,maskTransitionName:l.PropTypes.string,maskAnimation:l.PropTypes.string},mixins:[(0,w.default)({autoMount:!1,isVisible:function(e){return e.state.popupVisible},getContainer:function(e){var t=document.createElement("div"),n=e.props.getPopupContainer?e.props.getPopupContainer((0,c.findDOMNode)(e)):document.body;return n.appendChild(t),t}})],getDefaultProps:function(){return{prefixCls:"rc-trigger-popup",getPopupClassNameFromAlign:o,onPopupVisibleChange:i,afterPopupVisibleChange:i,onPopupAlign:i,popupClassName:"",mouseEnterDelay:0,mouseLeaveDelay:.1,focusDelay:0,blurDelay:.15,popupStyle:{},destroyPopupOnHide:!1,popupAlign:{},defaultPopupVisible:!1,mask:!1,maskClosable:!0,action:[],showAction:[],hideAction:[]}},getInitialState:function(){var e=this.props,t=void 0;return t="popupVisible"in e?!!e.popupVisible:!!e.defaultPopupVisible,{popupVisible:t}},componentWillMount:function(){var e=this;k.forEach(function(t){e["fire"+t]=function(n){e.fireEvents(t,n)}})},componentDidMount:function(){this.componentDidUpdate({},{popupVisible:this.state.popupVisible})},componentWillReceiveProps:function(e){var t=e.popupVisible;void 0!==t&&this.setState({popupVisible:t})},componentDidUpdate:function(e,t){var n=this.props,r=this.state;return this.renderComponent(null,function(){t.popupVisible!==r.popupVisible&&n.afterPopupVisibleChange(r.popupVisible)}),this.isClickToHide()&&r.popupVisible?void(this.clickOutsideHandler||(this.clickOutsideHandler=(0,m.default)(document,"mousedown",this.onDocumentClick),this.touchOutsideHandler=(0,m.default)(document,"touchstart",this.onDocumentClick))):void(this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.touchOutsideHandler.remove(),this.clickOutsideHandler=null,this.touchOutsideHandler=null))},componentWillUnmount:function(){this.clearDelayTimer(),this.clickOutsideHandler&&(this.clickOutsideHandler.remove(),this.touchOutsideHandler.remove(),this.clickOutsideHandler=null,this.touchOutsideHandler=null)},onMouseEnter:function(e){this.fireEvents("onMouseEnter",e),this.delaySetPopupVisible(!0,this.props.mouseEnterDelay)},onMouseLeave:function(e){this.fireEvents("onMouseLeave",e),this.delaySetPopupVisible(!1,this.props.mouseLeaveDelay)},onPopupMouseEnter:function(){this.clearDelayTimer()},onPopupMouseLeave:function(e){e.relatedTarget&&!e.relatedTarget.setTimeout&&this._component&&(0,f.default)(this._component.getPopupDomNode(),e.relatedTarget)||this.delaySetPopupVisible(!1,this.props.mouseLeaveDelay)},onFocus:function(e){this.fireEvents("onFocus",e),this.clearDelayTimer(),this.isFocusToShow()&&(this.focusTime=Date.now(),this.delaySetPopupVisible(!0,this.props.focusDelay))},onMouseDown:function(e){this.fireEvents("onMouseDown",e),this.preClickTime=Date.now()},onTouchStart:function(e){this.fireEvents("onTouchStart",e),this.preTouchTime=Date.now()},onBlur:function(e){this.fireEvents("onBlur",e),this.clearDelayTimer(),this.isBlurToHide()&&this.delaySetPopupVisible(!1,this.props.blurDelay)},onClick:function(e){if(this.fireEvents("onClick",e),this.focusTime){var t=void 0;if(this.preClickTime&&this.preTouchTime?t=Math.min(this.preClickTime,this.preTouchTime):this.preClickTime?t=this.preClickTime:this.preTouchTime&&(t=this.preTouchTime),Math.abs(t-this.focusTime)<20)return;this.focusTime=0}this.preClickTime=0,this.preTouchTime=0,e.preventDefault();var n=!this.state.popupVisible;(this.isClickToHide()&&!n||n&&this.isClickToShow())&&this.setPopupVisible(!this.state.popupVisible)},onDocumentClick:function(e){if(!this.props.mask||this.props.maskClosable){var t=e.target,n=(0,c.findDOMNode)(this),r=this.getPopupDomNode();(0,f.default)(n,t)||(0,f.default)(r,t)||this.close()}},getPopupDomNode:function(){return this._component&&this._component.isMounted()?this._component.getPopupDomNode():null},getRootDomNode:function(){return p.default.findDOMNode(this)},getPopupClassNameFromAlign:function(e){var t=[],n=this.props,r=n.popupPlacement,i=n.builtinPlacements,o=n.prefixCls;return r&&i&&t.push((0,g.getPopupClassNameFromAlign)(i,o,e)),n.getPopupClassNameFromAlign&&t.push(n.getPopupClassNameFromAlign(e)),t.join(" ")},getPopupAlign:function(){var e=this.props,t=e.popupPlacement,n=e.popupAlign,r=e.builtinPlacements;return t&&r?(0,g.getAlignFromPlacement)(r,t,n):n},getComponent:function(){var e=this.props,t=this.state,n={};return this.isMouseEnterToShow()&&(n.onMouseEnter=this.onPopupMouseEnter),this.isMouseLeaveToHide()&&(n.onMouseLeave=this.onPopupMouseLeave),u.default.createElement(y.default,(0,s.default)({prefixCls:e.prefixCls,destroyPopupOnHide:e.destroyPopupOnHide,visible:t.popupVisible,className:e.popupClassName,action:e.action,align:this.getPopupAlign(),onAlign:e.onPopupAlign,animation:e.popupAnimation,getClassNameFromAlign:this.getPopupClassNameFromAlign},n,{getRootDomNode:this.getRootDomNode,style:e.popupStyle,mask:e.mask,zIndex:e.zIndex,transitionName:e.popupTransitionName,maskAnimation:e.maskAnimation,maskTransitionName:e.maskTransitionName}),"function"==typeof e.popup?e.popup():e.popup)},setPopupVisible:function(e){this.clearDelayTimer(),this.state.popupVisible!==e&&("popupVisible"in this.props||this.setState({popupVisible:e}),this.props.onPopupVisibleChange(e))},delaySetPopupVisible:function(e,t){var n=this,r=1e3*t;this.clearDelayTimer(),r?this.delayTimer=setTimeout(function(){n.setPopupVisible(e),n.clearDelayTimer()},r):this.setPopupVisible(e)},clearDelayTimer:function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)},createTwoChains:function(e){var t=this.props.children.props,n=this.props;return t[e]&&n[e]?this["fire"+e]:t[e]||n[e]},isClickToShow:function(){var e=this.props,t=e.action,n=e.showAction;return t.indexOf("click")!==-1||n.indexOf("click")!==-1},isClickToHide:function(){var e=this.props,t=e.action,n=e.hideAction;return t.indexOf("click")!==-1||n.indexOf("click")!==-1},isMouseEnterToShow:function(){var e=this.props,t=e.action,n=e.showAction;return t.indexOf("hover")!==-1||n.indexOf("mouseEnter")!==-1},isMouseLeaveToHide:function(){var e=this.props,t=e.action,n=e.hideAction;return t.indexOf("hover")!==-1||n.indexOf("mouseLeave")!==-1},isFocusToShow:function(){var e=this.props,t=e.action,n=e.showAction;return t.indexOf("focus")!==-1||n.indexOf("focus")!==-1},isBlurToHide:function(){var e=this.props,t=e.action,n=e.hideAction;return t.indexOf("focus")!==-1||n.indexOf("blur")!==-1},forcePopupAlign:function(){this.state.popupVisible&&this.popupInstance&&this.popupInstance.alignInstance&&this.popupInstance.alignInstance.forceAlign()},fireEvents:function(e,t){var n=this.props.children.props[e];n&&n(t);var r=this.props[e];r&&r(t)},close:function(){this.setPopupVisible(!1)},render:function(){var e=this.props,t=e.children,n=u.default.Children.only(t),r={};return this.isClickToHide()||this.isClickToShow()?(r.onClick=this.onClick,r.onMouseDown=this.onMouseDown,r.onTouchStart=this.onTouchStart):(r.onClick=this.createTwoChains("onClick"),r.onMouseDown=this.createTwoChains("onMouseDown"),r.onTouchStart=this.createTwoChains("onTouchStart")),this.isMouseEnterToShow()?r.onMouseEnter=this.onMouseEnter:r.onMouseEnter=this.createTwoChains("onMouseEnter"),this.isMouseLeaveToHide()?r.onMouseLeave=this.onMouseLeave:r.onMouseLeave=this.createTwoChains("onMouseLeave"),this.isFocusToShow()||this.isBlurToHide()?(r.onFocus=this.onFocus,r.onBlur=this.onBlur):(r.onFocus=this.createTwoChains("onFocus"),r.onBlur=this.createTwoChains("onBlur")),u.default.cloneElement(n,r)}});t.default=T,e.exports=t.default},727:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(728),o=r(i);t.default=o.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},728:function(e,t,n){e.exports={default:n(729),__esModule:!0}},729:function(e,t,n){n(730),e.exports=n(733).Object.assign},730:function(e,t,n){var r=n(731);r(r.S+r.F,"Object",{assign:n(746)})},731:function(e,t,n){var r=n(732),i=n(733),o=n(734),a=n(736),s="prototype",l=function(e,t,n){var u,c,p,d=e&l.F,f=e&l.G,h=e&l.S,m=e&l.P,v=e&l.B,y=e&l.W,g=f?i:i[t]||(i[t]={}),b=g[s],w=f?r:h?r[t]:(r[t]||{})[s];f&&(n=t);for(u in n)c=!d&&w&&void 0!==w[u],c&&u in g||(p=c?w[u]:n[u],g[u]=f&&"function"!=typeof w[u]?n[u]:v&&c?o(p,r):y&&w[u]==p?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[s]=e[s],t}(p):m&&"function"==typeof p?o(Function.call,p):p,m&&((g.virtual||(g.virtual={}))[u]=p,e&l.R&&b&&!b[u]&&a(b,u,p)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},732:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},733:function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},734:function(e,t,n){var r=n(735);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},735:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},736:function(e,t,n){var r=n(737),i=n(745);e.exports=n(741)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},737:function(e,t,n){var r=n(738),i=n(740),o=n(744),a=Object.defineProperty;t.f=n(741)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},738:function(e,t,n){var r=n(739);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},739:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},740:function(e,t,n){e.exports=!n(741)&&!n(742)(function(){return 7!=Object.defineProperty(n(743)("div"),"a",{get:function(){return 7}}).a})},741:function(e,t,n){e.exports=!n(742)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},742:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},743:function(e,t,n){var r=n(739),i=n(732).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},744:function(e,t,n){var r=n(739);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},745:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},746:function(e,t,n){"use strict";var r=n(747),i=n(762),o=n(763),a=n(764),s=n(751),l=Object.assign;e.exports=!l||n(742)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r})?function(e,t){for(var n=a(e),l=arguments.length,u=1,c=i.f,p=o.f;l>u;)for(var d,f=s(arguments[u++]),h=c?r(f).concat(c(f)):r(f),m=h.length,v=0;m>v;)p.call(f,d=h[v++])&&(n[d]=f[d]);return n}:l},747:function(e,t,n){var r=n(748),i=n(761);e.exports=Object.keys||function(e){return r(e,i)}},748:function(e,t,n){var r=n(749),i=n(750),o=n(754)(!1),a=n(758)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),l=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>l;)r(s,n=t[l++])&&(~o(u,n)||u.push(n));return u}},749:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},750:function(e,t,n){var r=n(751),i=n(753);e.exports=function(e){return r(i(e))}},751:function(e,t,n){var r=n(752);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},752:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},753:function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},754:function(e,t,n){var r=n(750),i=n(755),o=n(757);e.exports=function(e){return function(t,n,a){var s,l=r(t),u=i(l.length),c=o(a,u);if(e&&n!=n){for(;u>c;)if(s=l[c++],s!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},755:function(e,t,n){var r=n(756),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},756:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},757:function(e,t,n){var r=n(756),i=Math.max,o=Math.min;e.exports=function(e,t){return e=r(e),e<0?i(e+t,0):o(e,t)}},758:function(e,t,n){var r=n(759)("keys"),i=n(760);e.exports=function(e){return r[e]||(r[e]=i(e))}},759:function(e,t,n){var r=n(732),i="__core-js_shared__",o=r[i]||(r[i]={});e.exports=function(e){return o[e]||(o[e]={})}},760:function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},761:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},762:function(e,t){t.f=Object.getOwnPropertySymbols},763:function(e,t){t.f={}.propertyIsEnumerable},764:function(e,t,n){var r=n(753);e.exports=function(e){return Object(r(e))}},765:function(e,t){"use strict";function n(e,t){for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default},766:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){var r=l.default.unstable_batchedUpdates?function(e){l.default.unstable_batchedUpdates(n,e)}:n;return(0,a.default)(e,t,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(767),a=r(o),s=n(162),l=r(s);e.exports=t.default},767:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){function r(t){var r=new a.default(t);n.call(e,r)}return e.addEventListener?(e.addEventListener(t,r,!1),{remove:function(){e.removeEventListener(t,r,!1)}}):e.attachEvent?(e.attachEvent("on"+t,r),{remove:function(){e.detachEvent("on"+t,r)}}):void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var o=n(768),a=r(o);e.exports=t.default},768:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return null===e||void 0===e}function o(){return d}function a(){return f}function s(e){var t=e.type,n="function"==typeof e.stopPropagation||"boolean"==typeof e.cancelBubble;u.default.call(this),this.nativeEvent=e;var r=a;"defaultPrevented"in e?r=e.defaultPrevented?o:a:"getPreventDefault"in e?r=e.getPreventDefault()?o:a:"returnValue"in e&&(r=e.returnValue===f?o:a),this.isDefaultPrevented=r;var i=[],s=void 0,l=void 0,c=void 0,p=h.concat();for(m.forEach(function(e){t.match(e.reg)&&(p=p.concat(e.props),e.fix&&i.push(e.fix))}),l=p.length;l;)c=p[--l],this[c]=e[c];for(!this.target&&n&&(this.target=e.srcElement||document),this.target&&3===this.target.nodeType&&(this.target=this.target.parentNode),l=i.length;l;)(s=i[--l])(this,e);this.timeStamp=e.timeStamp||Date.now()}Object.defineProperty(t,"__esModule",{value:!0});var l=n(769),u=r(l),c=n(770),p=r(c),d=!0,f=!1,h=["altKey","bubbles","cancelable","ctrlKey","currentTarget","eventPhase","metaKey","shiftKey","target","timeStamp","view","type"],m=[{reg:/^key/,props:["char","charCode","key","keyCode","which"],fix:function(e,t){i(e.which)&&(e.which=i(t.charCode)?t.keyCode:t.charCode),void 0===e.metaKey&&(e.metaKey=e.ctrlKey)}},{reg:/^touch/,props:["touches","changedTouches","targetTouches"]},{reg:/^hashchange$/,props:["newURL","oldURL"]},{reg:/^gesturechange$/i,props:["rotation","scale"]},{reg:/^(mousewheel|DOMMouseScroll)$/,props:[],fix:function(e,t){var n=void 0,r=void 0,i=void 0,o=t.wheelDelta,a=t.axis,s=t.wheelDeltaY,l=t.wheelDeltaX,u=t.detail;o&&(i=o/120),u&&(i=0-(u%3===0?u/3:u)),void 0!==a&&(a===e.HORIZONTAL_AXIS?(r=0,n=0-i):a===e.VERTICAL_AXIS&&(n=0,r=i)),void 0!==s&&(r=s/120),void 0!==l&&(n=-1*l/120),n||r||(r=i),void 0!==n&&(e.deltaX=n),void 0!==r&&(e.deltaY=r),void 0!==i&&(e.delta=i)}},{reg:/^mouse|contextmenu|click|mspointer|(^DOMMouseScroll$)/i,props:["buttons","clientX","clientY","button","offsetX","relatedTarget","which","fromElement","toElement","offsetY","pageX","pageY","screenX","screenY"],fix:function(e,t){var n=void 0,r=void 0,o=void 0,a=e.target,s=t.button;return a&&i(e.pageX)&&!i(t.clientX)&&(n=a.ownerDocument||document,r=n.documentElement,o=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),e.which||void 0===s||(1&s?e.which=1:2&s?e.which=3:4&s?e.which=2:e.which=0),!e.relatedTarget&&e.fromElement&&(e.relatedTarget=e.fromElement===a?e.toElement:e.fromElement),e}}],v=u.default.prototype;(0,p.default)(s.prototype,v,{constructor:s,preventDefault:function(){var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=f,v.preventDefault.call(this)},stopPropagation:function(){var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=d,v.stopPropagation.call(this)}}),t.default=s,e.exports=t.default},769:function(e,t){"use strict";function n(){return!1}function r(){return!0}function i(){this.timeStamp=Date.now(),this.target=void 0,this.currentTarget=void 0}Object.defineProperty(t,"__esModule",{value:!0}),i.prototype={isEventObject:1,constructor:i,isDefaultPrevented:n,isPropagationStopped:n,isImmediatePropagationStopped:n,preventDefault:function(){this.isDefaultPrevented=r},stopPropagation:function(){this.isPropagationStopped=r},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=r,this.stopPropagation()},halt:function(e){e?this.stopImmediatePropagation():this.stopPropagation(),this.preventDefault()}},t.default=i,e.exports=t.default},770:function(e,t){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function r(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==r.join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;e.exports=r()?Object.assign:function(e,t){for(var r,s,l=n(e),u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var c in r)o.call(r,c)&&(l[c]=r[c]);if(i){s=i(r);for(var p=0;p<s.length;p++)a.call(r,s[p])&&(l[s[p]]=r[s[p]])}}return l}},771:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(727),o=r(i),a=n(7),s=r(a),l=n(162),u=r(l),c=n(772),p=r(c),d=n(784),f=r(d),h=n(793),m=r(h),v=n(794),y=r(v),g=s.default.createClass({displayName:"Popup",propTypes:{visible:a.PropTypes.bool,style:a.PropTypes.object,getClassNameFromAlign:a.PropTypes.func,onAlign:a.PropTypes.func,getRootDomNode:a.PropTypes.func,onMouseEnter:a.PropTypes.func,align:a.PropTypes.any,destroyPopupOnHide:a.PropTypes.bool,className:a.PropTypes.string,prefixCls:a.PropTypes.string,onMouseLeave:a.PropTypes.func},componentDidMount:function(){this.rootNode=this.getPopupDomNode()},onAlign:function(e,t){var n=this.props,r=n.getClassNameFromAlign(n.align),i=n.getClassNameFromAlign(t);r!==i&&(this.currentAlignClassName=i,e.className=this.getClassName(i)),n.onAlign(e,t)},getPopupDomNode:function(){return u.default.findDOMNode(this.refs.popup)},getTarget:function(){return this.props.getRootDomNode()},getMaskTransitionName:function(){var e=this.props,t=e.maskTransitionName,n=e.maskAnimation;return!t&&n&&(t=e.prefixCls+"-"+n),t},getTransitionName:function(){var e=this.props,t=e.transitionName;return!t&&e.animation&&(t=e.prefixCls+"-"+e.animation),t},getClassName:function(e){return this.props.prefixCls+" "+this.props.className+" "+e},getPopupElement:function(){var e=this.props,t=e.align,n=e.style,r=e.visible,i=e.prefixCls,a=e.destroyPopupOnHide,l=this.getClassName(this.currentAlignClassName||e.getClassNameFromAlign(t)),u=i+"-hidden";r||(this.currentAlignClassName=null);var c=(0,o.default)({},n,this.getZIndexStyle()),d={className:l,prefixCls:i,ref:"popup",onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,style:c};return a?s.default.createElement(f.default,{component:"",exclusive:!0,transitionAppear:!0,transitionName:this.getTransitionName()},r?s.default.createElement(p.default,{target:this.getTarget,key:"popup",ref:this.saveAlign,monitorWindowResize:!0,align:t,onAlign:this.onAlign},s.default.createElement(m.default,(0,o.default)({visible:!0},d),e.children)):null):s.default.createElement(f.default,{component:"",exclusive:!0,transitionAppear:!0,transitionName:this.getTransitionName(),showProp:"xVisible"},s.default.createElement(p.default,{target:this.getTarget,key:"popup",ref:this.saveAlign,monitorWindowResize:!0,xVisible:r,childrenProps:{visible:"xVisible"},disabled:!r,align:t,onAlign:this.onAlign},s.default.createElement(m.default,(0,o.default)({hiddenClassName:u},d),e.children)))},getZIndexStyle:function(){var e={},t=this.props;return void 0!==t.zIndex&&(e.zIndex=t.zIndex),
e},getMaskElement:function(){var e=this.props,t=void 0;if(e.mask){var n=this.getMaskTransitionName();t=s.default.createElement(y.default,{style:this.getZIndexStyle(),key:"mask",className:e.prefixCls+"-mask",hiddenClassName:e.prefixCls+"-mask-hidden",visible:e.visible}),n&&(t=s.default.createElement(f.default,{key:"mask",showProp:"visible",transitionAppear:!0,component:"",transitionName:n},t))}return t},saveAlign:function(e){this.alignInstance=e},render:function(){return s.default.createElement("div",null,this.getMaskElement(),this.getPopupElement())}});t.default=g,e.exports=t.default},772:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(773),o=r(i);t.default=o.default,e.exports=t.default},773:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function n(){i&&(clearTimeout(i),i=null)}function r(){n(),i=setTimeout(e,t)}var i=void 0;return r.clear=n,r}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),a=r(o),s=n(162),l=r(s),u=n(774),c=r(u),p=n(766),d=r(p),f=n(783),h=r(f),m=a.default.createClass({displayName:"Align",propTypes:{childrenProps:o.PropTypes.object,align:o.PropTypes.object.isRequired,target:o.PropTypes.func,onAlign:o.PropTypes.func,monitorBufferTime:o.PropTypes.number,monitorWindowResize:o.PropTypes.bool,disabled:o.PropTypes.bool,children:o.PropTypes.any},getDefaultProps:function(){return{target:function(){return window},onAlign:function(){},monitorBufferTime:50,monitorWindowResize:!1,disabled:!1}},componentDidMount:function(){var e=this.props;this.forceAlign(),!e.disabled&&e.monitorWindowResize&&this.startMonitorWindowResize()},componentDidUpdate:function(e){var t=!1,n=this.props;if(!n.disabled)if(e.disabled||e.align!==n.align)t=!0;else{var r=e.target(),i=n.target();(0,h.default)(r)&&(0,h.default)(i)?t=!1:r!==i&&(t=!0)}t&&this.forceAlign(),n.monitorWindowResize&&!n.disabled?this.startMonitorWindowResize():this.stopMonitorWindowResize()},componentWillUnmount:function(){this.stopMonitorWindowResize()},startMonitorWindowResize:function(){this.resizeHandler||(this.bufferMonitor=i(this.forceAlign,this.props.monitorBufferTime),this.resizeHandler=(0,d.default)(window,"resize",this.bufferMonitor))},stopMonitorWindowResize:function(){this.resizeHandler&&(this.bufferMonitor.clear(),this.resizeHandler.remove(),this.resizeHandler=null)},forceAlign:function(){var e=this.props;if(!e.disabled){var t=l.default.findDOMNode(this);e.onAlign(t,(0,c.default)(t,e.target(),e.align))}},render:function(){var e=this.props,t=e.childrenProps,n=e.children,r=a.default.Children.only(n);if(t){var i={};for(var o in t)t.hasOwnProperty(o)&&(i[o]=this.props[t[o]]);return a.default.cloneElement(r,i)}return r}});t.default=m,e.exports=t.default},774:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return e.left<n.left||e.left+t.width>n.right}function o(e,t,n){return e.top<n.top||e.top+t.height>n.bottom}function a(e,t,n){return e.left>n.right||e.left+t.width<n.left}function s(e,t,n){return e.top>n.bottom||e.top+t.height<n.top}function l(e,t,n){var r=[];return h.default.each(e,function(e){r.push(e.replace(t,function(e){return n[e]}))}),r}function u(e,t){return e[t]=-e[t],e}function c(e,t){var n=void 0;return n=/%$/.test(e)?parseInt(e.substring(0,e.length-1),10)/100*t:parseInt(e,10),n||0}function p(e,t){e[0]=c(e[0],t.width),e[1]=c(e[1],t.height)}function d(e,t,n){var r=n.points,c=n.offset||[0,0],d=n.targetOffset||[0,0],f=n.overflow,m=n.target||t,v=n.source||e;c=[].concat(c),d=[].concat(d),f=f||{};var y={},b=0,k=(0,g.default)(v),C=(0,T.default)(v),E=(0,T.default)(m);p(c,C),p(d,E);var P=(0,O.default)(C,E,r,c,d),x=h.default.merge(C,P);if(k&&(f.adjustX||f.adjustY)){if(f.adjustX&&i(P,C,k)){var _=l(r,/[lr]/gi,{l:"r",r:"l"}),S=u(c,0),N=u(d,0),j=(0,O.default)(C,E,_,S,N);a(j,C,k)||(b=1,r=_,c=S,d=N)}if(f.adjustY&&o(P,C,k)){var M=l(r,/[tb]/gi,{t:"b",b:"t"}),L=u(c,1),A=u(d,1),I=(0,O.default)(C,E,M,L,A);s(I,C,k)||(b=1,r=M,c=L,d=A)}b&&(P=(0,O.default)(C,E,r,c,d),h.default.mix(x,P)),y.adjustX=f.adjustX&&i(P,C,k),y.adjustY=f.adjustY&&o(P,C,k),(y.adjustX||y.adjustY)&&(x=(0,w.default)(P,C,k,y))}return x.width!==C.width&&h.default.css(v,"width",h.default.width(v)+x.width-C.width),x.height!==C.height&&h.default.css(v,"height",h.default.height(v)+x.height-C.height),h.default.offset(v,{left:x.left,top:x.top},{useCssRight:n.useCssRight,useCssBottom:n.useCssBottom,useCssTransform:n.useCssTransform}),{points:r,offset:c,targetOffset:d,overflow:y}}Object.defineProperty(t,"__esModule",{value:!0});var f=n(775),h=r(f),m=n(777),v=r(m),y=n(778),g=r(y),b=n(779),w=r(b),k=n(780),T=r(k),C=n(781),O=r(C);d.__getOffsetParent=v.default,d.__getVisibleRectForElement=g.default,t.default=d,e.exports=t.default},775:function(e,t,n){"use strict";function r(e,t){return e+t}function i(e,t,n){var r=n;{if("object"!==("undefined"==typeof t?"undefined":E(t)))return"undefined"!=typeof r?("number"==typeof r&&(r+="px"),void(e.style[t]=r)):_(e,t);for(var o in t)t.hasOwnProperty(o)&&i(e,o,t[o])}}function o(e){var t=void 0,n=void 0,r=void 0,i=e.ownerDocument,o=i.body,a=i&&i.documentElement;return t=e.getBoundingClientRect(),n=t.left,r=t.top,n-=a.clientLeft||o.clientLeft||0,r-=a.clientTop||o.clientTop||0,{left:n,top:r}}function a(e,t){var n=e["page"+(t?"Y":"X")+"Offset"],r="scroll"+(t?"Top":"Left");if("number"!=typeof n){var i=e.document;n=i.documentElement[r],"number"!=typeof n&&(n=i.body[r])}return n}function s(e){return a(e)}function l(e){return a(e,!0)}function u(e){var t=o(e),n=e.ownerDocument,r=n.defaultView||n.parentWindow;return t.left+=s(r),t.top+=l(r),t}function c(e,t,n){var r=n,i="",o=e.ownerDocument;return r=r||o.defaultView.getComputedStyle(e,null),r&&(i=r.getPropertyValue(t)||r[t]),i}function p(e,t){var n=e[j]&&e[j][t];if(S.test(n)&&!N.test(t)){var r=e.style,i=r[L],o=e[M][L];e[M][L]=e[j][L],r[L]="fontSize"===t?"1em":n||0,n=r.pixelLeft+A,r[L]=i,e[M][L]=o}return""===n?"auto":n}function d(e,t){return"left"===e?t.useCssRight?"right":e:t.useCssBottom?"bottom":e}function f(e){return"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"bottom"===e?"top":void 0}function h(e,t,n){"static"===i(e,"position")&&(e.style.position="relative");var o=-999,a=-999,s=d("left",n),l=d("top",n),c=f(s),p=f(l);"left"!==s&&(o=999),"top"!==l&&(a=999);var h="",m=u(e);("left"in t||"top"in t)&&(h=(0,P.getTransitionProperty)(e)||"",(0,P.setTransitionProperty)(e,"none")),"left"in t&&(e.style[c]="",e.style[s]=o+"px"),"top"in t&&(e.style[p]="",e.style[l]=a+"px");var v=u(e),y={};for(var g in t)if(t.hasOwnProperty(g)){var b=d(g,n),w="left"===g?o:a,k=m[g]-v[g];b===g?y[b]=w+k:y[b]=w-k}i(e,y),r(e.offsetTop,e.offsetLeft),("left"in t||"top"in t)&&(0,P.setTransitionProperty)(e,h);var T={};for(var C in t)if(t.hasOwnProperty(C)){var O=d(C,n),E=t[C]-m[C];C===O?T[O]=y[O]+E:T[O]=y[O]-E}i(e,T)}function m(e,t){var n=u(e),r=(0,P.getTransformXY)(e),i={x:r.x,y:r.y};"left"in t&&(i.x=r.x+t.left-n.left),"top"in t&&(i.y=r.y+t.top-n.top),(0,P.setTransformXY)(e,i)}function v(e,t,n){n.useCssRight||n.useCssBottom?h(e,t,n):n.useCssTransform&&(0,P.getTransformName)()in document.body.style?m(e,t,n):h(e,t,n)}function y(e,t){for(var n=0;n<e.length;n++)t(e[n])}function g(e){return"border-box"===_(e,"boxSizing")}function b(e,t,n){var r={},i=e.style,o=void 0;for(o in t)t.hasOwnProperty(o)&&(r[o]=i[o],i[o]=t[o]);n.call(e);for(o in t)t.hasOwnProperty(o)&&(i[o]=r[o])}function w(e,t,n){var r=0,i=void 0,o=void 0,a=void 0;for(o=0;o<t.length;o++)if(i=t[o])for(a=0;a<n.length;a++){var s=void 0;s="border"===i?""+i+n[a]+"Width":i+n[a],r+=parseFloat(_(e,s))||0}return r}function k(e){return null!==e&&void 0!==e&&e==e.window}function T(e,t,n){var r=n;if(k(e))return"width"===t?V.viewportWidth(e):V.viewportHeight(e);if(9===e.nodeType)return"width"===t?V.docWidth(e):V.docHeight(e);var i="width"===t?["Left","Right"]:["Top","Bottom"],o="width"===t?e.offsetWidth:e.offsetHeight,a=_(e),s=g(e,a),l=0;(null===o||void 0===o||o<=0)&&(o=void 0,l=_(e,t),(null===l||void 0===l||Number(l)<0)&&(l=e.style[t]||0),l=parseFloat(l)||0),void 0===r&&(r=s?U:D);var u=void 0!==o||s,c=o||l;return r===D?u?c-w(e,["border","padding"],i,a):l:u?r===U?c:c+(r===F?-w(e,["border"],i,a):w(e,["margin"],i,a)):l+w(e,I.slice(r),i,a)}function C(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=void 0,i=t[0];return 0!==i.offsetWidth?r=T.apply(void 0,t):b(i,W,function(){r=T.apply(void 0,t)}),r}function O(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}Object.defineProperty(t,"__esModule",{value:!0});var E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P=n(776),x=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,_=void 0,S=new RegExp("^("+x+")(?!px)[a-z%]+$","i"),N=/^(top|right|bottom|left)$/,j="currentStyle",M="runtimeStyle",L="left",A="px";"undefined"!=typeof window&&(_=window.getComputedStyle?c:p);var I=["margin","border","padding"],D=-1,F=2,U=1,R=0,V={};y(["Width","Height"],function(e){V["doc"+e]=function(t){var n=t.document;return Math.max(n.documentElement["scroll"+e],n.body["scroll"+e],V["viewport"+e](n))},V["viewport"+e]=function(t){var n="client"+e,r=t.document,i=r.body,o=r.documentElement,a=o[n];return"CSS1Compat"===r.compatMode&&a||i&&i[n]||a}});var W={position:"absolute",visibility:"hidden",display:"block"};y(["width","height"],function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);V["outer"+t]=function(t,n){return t&&C(t,e,n?R:U)};var n="width"===e?["Left","Right"]:["Top","Bottom"];V[e]=function(t,r){var o=r;{if(void 0===o)return t&&C(t,e,D);if(t){var a=_(t),s=g(t);return s&&(o+=w(t,["padding","border"],n,a)),i(t,e,o)}}}});var B={getWindow:function(e){if(e&&e.document&&e.setTimeout)return e;var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},offset:function(e,t,n){return"undefined"==typeof t?u(e):void v(e,t,n||{})},isWindow:k,each:y,css:i,clone:function(e){var t=void 0,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);var r=e.overflow;if(r)for(t in e)e.hasOwnProperty(t)&&(n.overflow[t]=e.overflow[t]);return n},mix:O,getWindowScrollLeft:function(e){return s(e)},getWindowScrollTop:function(e){return l(e)},merge:function(){for(var e={},t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;i++)B.mix(e,n[i]);return e},viewportWidth:0,viewportHeight:0};O(B,V),t.default=B,e.exports=t.default},776:function(e,t){"use strict";function n(){if(void 0!==c)return c;c="";var e=document.createElement("p").style,t="Transform";for(var n in p)n+t in e&&(c=n);return c}function r(){return n()?n()+"TransitionProperty":"transitionProperty"}function i(){return n()?n()+"Transform":"transform"}function o(e,t){var n=r();n&&(e.style[n]=t,"transitionProperty"!==n&&(e.style.transitionProperty=t))}function a(e,t){var n=i();n&&(e.style[n]=t,"transform"!==n&&(e.style.transform=t))}function s(e){return e.style.transitionProperty||e.style[r()]}function l(e){var t=window.getComputedStyle(e,null),n=t.getPropertyValue("transform")||t.getPropertyValue(i());if(n&&"none"!==n){var r=n.replace(/[^0-9\-.,]/g,"").split(",");return{x:parseFloat(r[12]||r[4],0),y:parseFloat(r[13]||r[5],0)}}return{x:0,y:0}}function u(e,t){var n=window.getComputedStyle(e,null),r=n.getPropertyValue("transform")||n.getPropertyValue(i());if(r&&"none"!==r){var o=void 0,s=r.match(d);if(s)s=s[1],o=s.split(",").map(function(e){return parseFloat(e,10)}),o[4]=t.x,o[5]=t.y,a(e,"matrix("+o.join(",")+")");else{var l=r.match(f)[1];o=l.split(",").map(function(e){return parseFloat(e,10)}),o[12]=t.x,o[13]=t.y,a(e,"matrix3d("+o.join(",")+")")}}else a(e,"translateX("+t.x+"px) translateY("+t.y+"px) translateZ(0)")}Object.defineProperty(t,"__esModule",{value:!0}),t.getTransformName=i,t.setTransitionProperty=o,t.getTransitionProperty=s,t.getTransformXY=l,t.setTransformXY=u;var c=void 0,p={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-",O:"-o-"},d=/matrix\((.*)\)/,f=/matrix3d\((.*)\)/},777:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=e.ownerDocument,n=t.body,r=void 0,i=a.default.css(e,"position"),o="fixed"===i||"absolute"===i;if(!o)return"html"===e.nodeName.toLowerCase()?null:e.parentNode;for(r=e.parentNode;r&&r!==n;r=r.parentNode)if(i=a.default.css(r,"position"),"static"!==i)return r;return null}Object.defineProperty(t,"__esModule",{value:!0});var o=n(775),a=r(o);t.default=i,e.exports=t.default},778:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){for(var t={left:0,right:1/0,top:0,bottom:1/0},n=(0,l.default)(e),r=void 0,i=void 0,o=void 0,s=e.ownerDocument,u=s.defaultView||s.parentWindow,c=s.body,p=s.documentElement;n;){if(navigator.userAgent.indexOf("MSIE")!==-1&&0===n.clientWidth||n===c||n===p||"visible"===a.default.css(n,"overflow")){if(n===c||n===p)break}else{var d=a.default.offset(n);d.left+=n.clientLeft,d.top+=n.clientTop,t.top=Math.max(t.top,d.top),t.right=Math.min(t.right,d.left+n.clientWidth),t.bottom=Math.min(t.bottom,d.top+n.clientHeight),t.left=Math.max(t.left,d.left)}n=(0,l.default)(n)}return r=a.default.getWindowScrollLeft(u),i=a.default.getWindowScrollTop(u),t.left=Math.max(t.left,r),t.top=Math.max(t.top,i),o={width:a.default.viewportWidth(u),height:a.default.viewportHeight(u)},t.right=Math.min(t.right,r+o.width),t.bottom=Math.min(t.bottom,i+o.height),t.top>=0&&t.left>=0&&t.bottom>t.top&&t.right>t.left?t:null}Object.defineProperty(t,"__esModule",{value:!0});var o=n(775),a=r(o),s=n(777),l=r(s);t.default=i,e.exports=t.default},779:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){var i=a.default.clone(e),o={width:t.width,height:t.height};return r.adjustX&&i.left<n.left&&(i.left=n.left),r.resizeWidth&&i.left>=n.left&&i.left+o.width>n.right&&(o.width-=i.left+o.width-n.right),r.adjustX&&i.left+o.width>n.right&&(i.left=Math.max(n.right-o.width,n.left)),r.adjustY&&i.top<n.top&&(i.top=n.top),r.resizeHeight&&i.top>=n.top&&i.top+o.height>n.bottom&&(o.height-=i.top+o.height-n.bottom),r.adjustY&&i.top+o.height>n.bottom&&(i.top=Math.max(n.bottom-o.height,n.top)),a.default.mix(i,o)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(775),a=r(o);t.default=i,e.exports=t.default},780:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=void 0,n=void 0,r=void 0;if(a.default.isWindow(e)||9===e.nodeType){var i=a.default.getWindow(e);t={left:a.default.getWindowScrollLeft(i),top:a.default.getWindowScrollTop(i)},n=a.default.viewportWidth(i),r=a.default.viewportHeight(i)}else t=a.default.offset(e),n=a.default.outerWidth(e),r=a.default.outerHeight(e);return t.width=n,t.height=r,t}Object.defineProperty(t,"__esModule",{value:!0});var o=n(775),a=r(o);t.default=i,e.exports=t.default},781:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r,i){var o=void 0,s=void 0,l=void 0,u=void 0;return o={left:e.left,top:e.top},l=(0,a.default)(t,n[1]),u=(0,a.default)(e,n[0]),s=[u.left-l.left,u.top-l.top],{left:o.left-s[0]+r[0]-i[0],top:o.top-s[1]+r[1]-i[1]}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(782),a=r(o);t.default=i,e.exports=t.default},782:function(e,t){"use strict";function n(e,t){var n=t.charAt(0),r=t.charAt(1),i=e.width,o=e.height,a=void 0,s=void 0;return a=e.left,s=e.top,"c"===n?s+=o/2:"b"===n&&(s+=o),"c"===r?a+=i/2:"r"===r&&(a+=i),{left:a,top:s}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default},783:function(e,t){"use strict";function n(e){return null!=e&&e==e.window}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default},784:function(e,t,n){"use strict";e.exports=n(785)},785:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){var t=e.children;return l.default.isValidElement(t)&&!t.key?l.default.cloneElement(t,{key:h}):t}function a(){}Object.defineProperty(t,"__esModule",{value:!0});var s=n(7),l=r(s),u=n(786),c=n(787),p=r(c),d=n(792),f=r(d),h="rc_animate_"+Date.now(),m=l.default.createClass({displayName:"Animate",propTypes:{component:l.default.PropTypes.any,animation:l.default.PropTypes.object,transitionName:l.default.PropTypes.oneOfType([l.default.PropTypes.string,l.default.PropTypes.object]),transitionEnter:l.default.PropTypes.bool,transitionAppear:l.default.PropTypes.bool,exclusive:l.default.PropTypes.bool,transitionLeave:l.default.PropTypes.bool,onEnd:l.default.PropTypes.func,onEnter:l.default.PropTypes.func,onLeave:l.default.PropTypes.func,onAppear:l.default.PropTypes.func,showProp:l.default.PropTypes.string},getDefaultProps:function(){return{animation:{},component:"span",transitionEnter:!0,transitionLeave:!0,transitionAppear:!1,onEnd:a,onEnter:a,onLeave:a,onAppear:a}},getInitialState:function(){return this.currentlyAnimatingKeys={},this.keysToEnter=[],this.keysToLeave=[],{children:(0,u.toArrayChildren)(o(this.props))}},componentDidMount:function(){var e=this,t=this.props.showProp,n=this.state.children;t&&(n=n.filter(function(e){return!!e.props[t]})),n.forEach(function(t){t&&e.performAppear(t.key)})},componentWillReceiveProps:function(e){var t=this;this.nextProps=e;var n=(0,u.toArrayChildren)(o(e)),r=this.props;r.exclusive&&Object.keys(this.currentlyAnimatingKeys).forEach(function(e){t.stop(e)});var a=r.showProp,s=this.currentlyAnimatingKeys,c=r.exclusive?(0,u.toArrayChildren)(o(r)):this.state.children,p=[];a?(c.forEach(function(e){var t=e&&(0,u.findChildInChildrenByKey)(n,e.key),r=void 0;r=t&&t.props[a]||!e.props[a]?t:l.default.cloneElement(t||e,i({},a,!0)),r&&p.push(r)}),n.forEach(function(e){e&&(0,u.findChildInChildrenByKey)(c,e.key)||p.push(e)})):p=(0,u.mergeChildren)(c,n),this.setState({children:p}),n.forEach(function(e){var n=e&&e.key;if(!e||!s[n]){var r=e&&(0,u.findChildInChildrenByKey)(c,n);if(a){var i=e.props[a];if(r){var o=(0,u.findShownChildInChildrenByKey)(c,n,a);!o&&i&&t.keysToEnter.push(n)}else i&&t.keysToEnter.push(n)}else r||t.keysToEnter.push(n)}}),c.forEach(function(e){var r=e&&e.key;if(!e||!s[r]){var i=e&&(0,u.findChildInChildrenByKey)(n,r);if(a){var o=e.props[a];if(i){var l=(0,u.findShownChildInChildrenByKey)(n,r,a);!l&&o&&t.keysToLeave.push(r)}else o&&t.keysToLeave.push(r)}else i||t.keysToLeave.push(r)}})},componentDidUpdate:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)},performEnter:function(e){this.refs[e]&&(this.currentlyAnimatingKeys[e]=!0,this.refs[e].componentWillEnter(this.handleDoneAdding.bind(this,e,"enter")))},performAppear:function(e){this.refs[e]&&(this.currentlyAnimatingKeys[e]=!0,this.refs[e].componentWillAppear(this.handleDoneAdding.bind(this,e,"appear")))},handleDoneAdding:function(e,t){var n=this.props;if(delete this.currentlyAnimatingKeys[e],!n.exclusive||n===this.nextProps){var r=(0,u.toArrayChildren)(o(n));this.isValidChildByKey(r,e)?"appear"===t?f.default.allowAppearCallback(n)&&(n.onAppear(e),n.onEnd(e,!0)):f.default.allowEnterCallback(n)&&(n.onEnter(e),n.onEnd(e,!0)):this.performLeave(e)}},performLeave:function(e){this.refs[e]&&(this.currentlyAnimatingKeys[e]=!0,this.refs[e].componentWillLeave(this.handleDoneLeaving.bind(this,e)))},handleDoneLeaving:function(e){var t=this.props;if(delete this.currentlyAnimatingKeys[e],!t.exclusive||t===this.nextProps){var n=(0,u.toArrayChildren)(o(t));if(this.isValidChildByKey(n,e))this.performEnter(e);else{var r=function(){f.default.allowLeaveCallback(t)&&(t.onLeave(e),t.onEnd(e,!1))};this.isMounted()&&!(0,u.isSameChildren)(this.state.children,n,t.showProp)?this.setState({children:n},r):r()}}},isValidChildByKey:function(e,t){var n=this.props.showProp;return n?(0,u.findShownChildInChildrenByKey)(e,t,n):(0,u.findChildInChildrenByKey)(e,t)},stop:function(e){delete this.currentlyAnimatingKeys[e];var t=this.refs[e];t&&t.stop()},render:function(){var e=this.props;this.nextProps=e;var t=this.state.children,n=null;t&&(n=t.map(function(t){if(null===t||void 0===t)return t;if(!t.key)throw new Error("must set key for <rc-animate> children");return l.default.createElement(p.default,{key:t.key,ref:t.key,animation:e.animation,transitionName:e.transitionName,transitionEnter:e.transitionEnter,transitionAppear:e.transitionAppear,transitionLeave:e.transitionLeave},t)}));var r=e.component;if(r){var i=e;return"string"==typeof r&&(i={className:e.className,style:e.style}),l.default.createElement(r,i,n)}return n[0]||null}});t.default=m,e.exports=t.default},786:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=[];return p.default.Children.forEach(e,function(e){t.push(e)}),t}function o(e,t){var n=null;return e&&e.forEach(function(e){n||e&&e.key===t&&(n=e)}),n}function a(e,t,n){var r=null;return e&&e.forEach(function(e){if(e&&e.key===t&&e.props[n]){if(r)throw new Error("two child with same key for <rc-animate> children");r=e}}),r}function s(e,t,n){var r=0;return e&&e.forEach(function(e){r||(r=e&&e.key===t&&!e.props[n])}),r}function l(e,t,n){var r=e.length===t.length;return r&&e.forEach(function(e,i){var o=t[i];e&&o&&(e&&!o||!e&&o?r=!1:e.key!==o.key?r=!1:n&&e.props[n]!==o.props[n]&&(r=!1))}),r}function u(e,t){var n=[],r={},i=[];return e.forEach(function(e){e&&o(t,e.key)?i.length&&(r[e.key]=i,i=[]):i.push(e)}),t.forEach(function(e){e&&r.hasOwnProperty(e.key)&&(n=n.concat(r[e.key])),n.push(e)}),n=n.concat(i)}Object.defineProperty(t,"__esModule",{value:!0}),t.toArrayChildren=i,t.findChildInChildrenByKey=o,t.findShownChildInChildrenByKey=a,t.findHiddenChildInChildrenByKey=s,t.isSameChildren=l,t.mergeChildren=u;var c=n(7),p=r(c)},787:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=n(7),a=r(o),s=n(162),l=r(s),u=n(788),c=r(u),p=n(792),d=r(p),f={enter:"transitionEnter",appear:"transitionAppear",leave:"transitionLeave"},h=a.default.createClass({displayName:"AnimateChild",propTypes:{children:a.default.PropTypes.any},componentWillUnmount:function(){this.stop()},componentWillEnter:function(e){d.default.isEnterSupported(this.props)?this.transition("enter",e):e()},componentWillAppear:function(e){d.default.isAppearSupported(this.props)?this.transition("appear",e):e()},componentWillLeave:function(e){d.default.isLeaveSupported(this.props)?this.transition("leave",e):e()},transition:function(e,t){var n=this,r=l.default.findDOMNode(this),o=this.props,a=o.transitionName,s="object"===("undefined"==typeof a?"undefined":i(a));this.stop();var p=function(){n.stopper=null,t()};if((u.isCssAnimationSupported||!o.animation[e])&&a&&o[f[e]]){var d=s?a[e]:a+"-"+e,h=d+"-active";s&&a[e+"Active"]&&(h=a[e+"Active"]),this.stopper=(0,c.default)(r,{name:d,active:h},p)}else this.stopper=o.animation[e](r,p)},stop:function(){var e=this.stopper;e&&(this.stopper=null,e.stop())},render:function(){return this.props.children}});t.default=h,e.exports=t.default},788:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(var n=window.getComputedStyle(e),r="",i=0;i<h.length&&!(r=n.getPropertyValue(h[i]+t));i++);return r}function o(e){if(d){var t=parseFloat(i(e,"transition-delay"))||0,n=parseFloat(i(e,"transition-duration"))||0,r=parseFloat(i(e,"animation-delay"))||0,o=parseFloat(i(e,"animation-duration"))||0,a=Math.max(n+t,o+r);e.rcEndAnimTimeout=setTimeout(function(){e.rcEndAnimTimeout=null,e.rcEndListener&&e.rcEndListener()},1e3*a+200)}}function a(e){e.rcEndAnimTimeout&&(clearTimeout(e.rcEndAnimTimeout),e.rcEndAnimTimeout=null)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(789),u=r(l),c=n(790),p=r(c),d=0!==u.default.endEvents.length,f=["Webkit","Moz","O","ms"],h=["-webkit-","-moz-","-o-","ms-",""],m=function(e,t,n){var r="object"===("undefined"==typeof t?"undefined":s(t)),i=r?t.name:t,l=r?t.active:t+"-active",c=n,d=void 0,f=void 0,h=(0,p.default)(e);return n&&"[object Object]"===Object.prototype.toString.call(n)&&(c=n.end,d=n.start,f=n.active),e.rcEndListener&&e.rcEndListener(),e.rcEndListener=function(t){t&&t.target!==e||(e.rcAnimTimeout&&(clearTimeout(e.rcAnimTimeout),e.rcAnimTimeout=null),a(e),h.remove(i),h.remove(l),u.default.removeEndEventListener(e,e.rcEndListener),e.rcEndListener=null,c&&c())},u.default.addEndEventListener(e,e.rcEndListener),d&&d(),h.add(i),e.rcAnimTimeout=setTimeout(function(){e.rcAnimTimeout=null,h.add(l),f&&setTimeout(f,0),o(e)},30),{stop:function(){e.rcEndListener&&e.rcEndListener()}}};m.style=function(e,t,n){e.rcEndListener&&e.rcEndListener(),e.rcEndListener=function(t){t&&t.target!==e||(e.rcAnimTimeout&&(clearTimeout(e.rcAnimTimeout),e.rcAnimTimeout=null),a(e),u.default.removeEndEventListener(e,e.rcEndListener),e.rcEndListener=null,n&&n())},u.default.addEndEventListener(e,e.rcEndListener),e.rcAnimTimeout=setTimeout(function(){for(var n in t)t.hasOwnProperty(n)&&(e.style[n]=t[n]);e.rcAnimTimeout=null,o(e)},0)},m.setTransition=function(e,t,n){var r=t,i=n;void 0===n&&(i=r,r=""),r=r||"",f.forEach(function(t){e.style[t+"Transition"+r]=i})},m.isCssAnimationSupported=d,t.default=m,e.exports=t.default},789:function(e,t){"use strict";function n(){var e=document.createElement("div"),t=e.style;"AnimationEvent"in window||delete o.animationend.animation,"TransitionEvent"in window||delete o.transitionend.transition;for(var n in o)if(o.hasOwnProperty(n)){var r=o[n];for(var i in r)if(i in t){a.push(r[i]);break}}}function r(e,t,n){e.addEventListener(t,n,!1)}function i(e,t,n){e.removeEventListener(t,n,!1)}Object.defineProperty(t,"__esModule",{value:!0});var o={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},a=[];"undefined"!=typeof window&&"undefined"!=typeof document&&n();var s={addEndEventListener:function(e,t){return 0===a.length?void window.setTimeout(t,0):void a.forEach(function(n){r(e,n,t)})},endEvents:a,removeEndEventListener:function(e,t){0!==a.length&&a.forEach(function(n){i(e,n,t)})}};t.default=s,e.exports=t.default},790:function(e,t,n){function r(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}try{var i=n(791)}catch(e){var i=n(791)}var o=/\s+/,a=Object.prototype.toString;e.exports=function(e){return new r(e)},r.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=i(t,e);return~n||t.push(e),this.el.className=t.join(" "),this},r.prototype.remove=function(e){if("[object RegExp]"==a.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=i(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this},r.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},r.prototype.toggle=function(e,t){return this.list?("undefined"!=typeof t?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):("undefined"!=typeof t?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},r.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(o);return""===n[0]&&n.shift(),n},r.prototype.has=r.prototype.contains=function(e){return this.list?this.list.contains(e):!!~i(this.array(),e)}},791:function(e,t){e.exports=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},792:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isAppearSupported:function(e){return e.transitionName&&e.transitionAppear||e.animation.appear},isEnterSupported:function(e){return e.transitionName&&e.transitionEnter||e.animation.enter},isLeaveSupported:function(e){return e.transitionName&&e.transitionLeave||e.animation.leave},allowAppearCallback:function(e){return e.transitionAppear||e.animation.appear},allowEnterCallback:function(e){return e.transitionEnter||e.animation.enter},allowLeaveCallback:function(e){return e.transitionLeave||e.animation.leave}};t.default=n,e.exports=t.default},793:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),o=r(i),a=n(794),s=r(a),l=o.default.createClass({displayName:"PopupInner",propTypes:{hiddenClassName:i.PropTypes.string,className:i.PropTypes.string,prefixCls:i.PropTypes.string,onMouseEnter:i.PropTypes.func,onMouseLeave:i.PropTypes.func,children:i.PropTypes.any},render:function(){var e=this.props,t=e.className;return e.visible||(t+=" "+e.hiddenClassName),o.default.createElement("div",{className:t,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,style:e.style},o.default.createElement(s.default,{className:e.prefixCls+"-content",visible:e.visible},e.children))}});t.default=l,e.exports=t.default},794:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(795),o=r(i),a=n(7),s=r(a),l=s.default.createClass({displayName:"LazyRenderBox",propTypes:{children:a.PropTypes.any,className:a.PropTypes.string,visible:a.PropTypes.bool,hiddenClassName:a.PropTypes.string},shouldComponentUpdate:function(e){return e.hiddenClassName||e.visible},render:function(){var e=this.props,t=e.hiddenClassName,n=e.visible,r=(0,o.default)(e,["hiddenClassName","visible"]);return t||s.default.Children.count(r.children)>1?(!n&&t&&(r.className+=" "+t),s.default.createElement("div",r)):s.default.Children.only(r.children)}});t.default=l,e.exports=t.default},795:function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}},796:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return e[0]===t[0]&&e[1]===t[1]}function o(e,t,n){var r=e[t]||{};return(0,l.default)({},r,n)}function a(e,t,n){var r=n.points;for(var o in e)if(e.hasOwnProperty(o)&&i(e[o].points,r))return t+"-placement-"+o;return""}Object.defineProperty(t,"__esModule",{value:!0});var s=n(727),l=r(s);t.getAlignFromPlacement=o,t.getPopupClassNameFromAlign=a},797:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(){var e=document.createElement("div");return document.body.appendChild(e),e}function o(e){function t(e,t,n){if(!c||e._component||c(e)){e._container||(e._container=f(e));var r=void 0;r=e.getComponent?e.getComponent(t):p(e,t),l.default.unstable_renderSubtreeIntoContainer(e,r,e._container,function(){e._component=this,n&&n.call(this)})}}function n(e){if(e._container){var t=e._container;l.default.unmountComponentAtNode(t),t.parentNode.removeChild(t),e._container=null}}var r=e.autoMount,o=void 0===r||r,s=e.autoDestroy,u=void 0===s||s,c=e.isVisible,p=e.getComponent,d=e.getContainer,f=void 0===d?i:d,h=void 0;return o&&(h=a({},h,{componentDidMount:function(){t(this)},componentDidUpdate:function(){t(this)}})),o&&u||(h=a({},h,{renderComponent:function(e,n){t(this,e,n)}})),h=u?a({},h,{componentWillUnmount:function(){n(this)}}):a({},h,{removeContainer:function(){n(this)}})}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){
var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=o;var s=n(162),l=r(s);e.exports=t.default},798:function(e,t,n){function r(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(!e.arrowPointAtCenter)return i.placements;var t=e.arrowWidth,n=void 0===t?5:t,r=e.horizontalArrowShift,s=void 0===r?16:r,l=e.verticalArrowShift,u=void 0===l?12:l;return{left:{points:["cr","cl"],overflow:o,offset:[-4,0],targetOffset:a},right:{points:["cl","cr"],overflow:o,offset:[4,0],targetOffset:a},top:{points:["bc","tc"],overflow:o,offset:[0,-4],targetOffset:a},bottom:{points:["tc","bc"],overflow:o,offset:[0,4],targetOffset:a},topLeft:{points:["bl","tc"],overflow:o,offset:[-(s+n),-4],targetOffset:a},leftTop:{points:["tr","cl"],overflow:o,offset:[-4,-(u+n)],targetOffset:a},topRight:{points:["br","tc"],overflow:o,offset:[s+n,-4],targetOffset:a},rightTop:{points:["tl","cr"],overflow:o,offset:[4,-(u+n)],targetOffset:a},bottomRight:{points:["tr","bc"],overflow:o,offset:[s+n,4],targetOffset:a},rightBottom:{points:["bl","cr"],overflow:o,offset:[4,u+n],targetOffset:a},bottomLeft:{points:["tl","bc"],overflow:o,offset:[-(s+n),4],targetOffset:a},leftBottom:{points:["br","cl"],overflow:o,offset:[-4,u+n],targetOffset:a}}}Object.defineProperty(t,"__esModule",{value:!0}),t.getPlacements=r;var i=n(724),o={adjustX:1,adjustY:1},a=[0,0]},799:function(e,t){},801:function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},802:function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=f[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(u(r.parts[o],t))}else{for(var a=[],o=0;o<r.parts.length;o++)a.push(u(r.parts[o],t));f[r.id]={id:r.id,refs:1,parts:a}}}}function i(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r],o=i[0],a=i[1],s=i[2],l=i[3],u={css:a,media:s,sourceMap:l};n[o]?n[o].parts.push(u):t.push(n[o]={id:o,parts:[u]})}return t}function o(e,t){var n=v(),r=b[b.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),b.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=b.indexOf(e);t>=0&&b.splice(t,1)}function s(e){var t=document.createElement("style");return t.type="text/css",o(e,t),t}function l(e){var t=document.createElement("link");return t.rel="stylesheet",o(e,t),t}function u(e,t){var n,r,i;if(t.singleton){var o=g++;n=y||(y=s(t)),r=c.bind(null,n,o,!1),i=c.bind(null,n,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(t),r=d.bind(null,n),i=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(t),r=p.bind(null,n),i=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}function c(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=w(t,i);else{var o=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function p(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function d(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([n],{type:"text/css"}),o=e.href;e.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}var f={},h=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},m=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=h(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,g=0,b=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=m()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=i(e);return r(n,t),function(e){for(var o=[],a=0;a<n.length;a++){var s=n[a],l=f[s.id];l.refs--,o.push(l)}if(e){var u=i(e);r(u,t)}for(var a=0;a<o.length;a++){var l=o[a];if(0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete f[l.id]}}}};var w=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},1001:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1002),o=r(i),a=n(1003),s=r(a);o.default.InfiniteScroll=s.default,t.default=o.default,e.exports=t.default},1002:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},u=n(7),c=r(u),p=n(285),d=r(p),f=function(e){function t(e){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleScroll=this.handleScroll.bind(this)}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{className:u.PropTypes.string,overflow:u.PropTypes.array,spinning:u.PropTypes.bool,onScroll:u.PropTypes.func}}},{key:"defaultProps",get:function(){return{className:"",overflow:[0,0],spinning:!1}}}]),s(t,[{key:"componentDidMount",value:function(){this.forceUpdate()}},{key:"outterStyle",value:function(){return{marginLeft:-this.props.overflow[0],marginRight:-this.props.overflow[1],height:"100%",overflowY:"auto"}}},{key:"innerStyle",value:function(){var e=this.refs.outter,t=this.refs.inner,n=e?e.offsetWidth:0,r=e?t.offsetWidth:0;return{paddingLeft:this.props.overflow[0],paddingRight:this.props.overflow[1]-(n-r)}}},{key:"handleScroll",value:function(e){this.props.onScroll(e)}},{key:"renderChildren",value:function(){return c.default.createElement("div",{className:"scroll-view-outter",style:this.outterStyle(),onScroll:this.handleScroll,ref:"outter"},c.default.createElement("div",{className:"scroll-view-inner",style:this.innerStyle(),ref:"inner"},this.props.children))}},{key:"render",value:function(){var e=this.props.className.split(/\s/),t=d.default.apply(void 0,["scroll-view"].concat(i(e),[{spinner:this.props.spinning}]));return c.default.createElement("div",{className:t},!this.props.spinning&&this.renderChildren())}}]),t}(u.Component);t.default=f,e.exports=t.default},1003:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=n(1002),p=r(c),d=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleScroll=this.handleScroll.bind(this),this.state={scrolledToEnd:!1}}return o(t,e),a(t,null,[{key:"propTypes",get:function(){return{loadMore:l.PropTypes.func,hasMore:l.PropTypes.bool,spinning:l.PropTypes.bool,defaultText:l.PropTypes.node,noMoreText:l.PropTypes.node}}},{key:"defaultProps",get:function(){return{loadMore:function(){},hasMore:!0,spinning:!1,defaultText:"正在加载下一页...",noMoreText:"已经是最后一页了."}}}]),a(t,[{key:"handleScroll",value:function(e){var t=e.target,n=t.scrollTop,r=t.offsetHeight,i=t.firstChild;n+r===i.offsetHeight&&this.handleLoadMore()}},{key:"handleLoadMore",value:function(){this.state.scrolledToEnd||this.setState({scrolledToEnd:!0}),this.props.loadMore()}},{key:"renderLoadMore",value:function(){var e=this.props,t=e.hasMore,n=e.defaultText,r=e.noMoreText;return u.default.createElement("div",{className:"load-more"},t?n:r)}},{key:"render",value:function(){return u.default.createElement(p.default,{className:"infinite-scroll",spinning:this.props.spinning,onScroll:this.handleScroll},this.props.children,this.state.scrolledToEnd&&this.renderLoadMore())}}]),t}(l.Component);t.default=d,e.exports=t.default},1019:function(e,t,n){var r;!function(i,o,a){function s(e,t,n){return e.addEventListener?void e.addEventListener(t,n,!1):void e.attachEvent("on"+t,n)}function l(e){if("keypress"==e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return k[e.which]?k[e.which]:T[e.which]?T[e.which]:String.fromCharCode(e.which).toLowerCase()}function u(e,t){return e.sort().join(",")===t.sort().join(",")}function c(e){var t=[];return e.shiftKey&&t.push("shift"),e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),t}function p(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function d(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function f(e){return"shift"==e||"ctrl"==e||"alt"==e||"meta"==e}function h(){if(!w){w={};for(var e in k)e>95&&e<112||k.hasOwnProperty(e)&&(w[k[e]]=e)}return w}function m(e,t,n){return n||(n=h()[e]?"keydown":"keypress"),"keypress"==n&&t.length&&(n="keydown"),n}function v(e){return"+"===e?["+"]:(e=e.replace(/\+{2}/g,"+plus"),e.split("+"))}function y(e,t){var n,r,i,o=[];for(n=v(e),i=0;i<n.length;++i)r=n[i],O[r]&&(r=O[r]),t&&"keypress"!=t&&C[r]&&(r=C[r],o.push("shift")),f(r)&&o.push(r);return t=m(r,o,t),{key:r,modifiers:o,action:t}}function g(e,t){return null!==e&&e!==o&&(e===t||g(e.parentNode,t))}function b(e){function t(e){e=e||{};var t,n=!1;for(t in w)e[t]?n=!0:w[t]=0;n||(C=!1)}function n(e,t,n,r,i,o){var a,s,l=[],c=n.type;if(!v._callbacks[e])return[];for("keyup"==c&&f(e)&&(t=[e]),a=0;a<v._callbacks[e].length;++a)if(s=v._callbacks[e][a],(r||!s.seq||w[s.seq]==s.level)&&c==s.action&&("keypress"==c&&!n.metaKey&&!n.ctrlKey||u(t,s.modifiers))){var p=!r&&s.combo==i,d=r&&s.seq==r&&s.level==o;(p||d)&&v._callbacks[e].splice(a,1),l.push(s)}return l}function r(e,t,n,r){v.stopCallback(t,t.target||t.srcElement,n,r)||e(t,n)===!1&&(p(t),d(t))}function i(e){"number"!=typeof e.which&&(e.which=e.keyCode);var t=l(e);if(t)return"keyup"==e.type&&k===t?void(k=!1):void v.handleKey(t,c(e),e)}function a(){clearTimeout(g),g=setTimeout(t,1e3)}function h(e,n,i,o){function s(t){return function(){C=t,++w[e],a()}}function u(n){r(i,n,e),"keyup"!==o&&(k=l(n)),setTimeout(t,10)}w[e]=0;for(var c=0;c<n.length;++c){var p=c+1===n.length,d=p?u:s(o||y(n[c+1]).action);m(n[c],d,o,e,c)}}function m(e,t,r,i,o){v._directMap[e+":"+r]=t,e=e.replace(/\s+/g," ");var a,s=e.split(" ");return s.length>1?void h(e,s,t,r):(a=y(e,r),v._callbacks[a.key]=v._callbacks[a.key]||[],n(a.key,a.modifiers,{type:a.action},i,e,o),void v._callbacks[a.key][i?"unshift":"push"]({callback:t,modifiers:a.modifiers,action:a.action,seq:i,level:o,combo:e}))}var v=this;if(e=e||o,!(v instanceof b))return new b(e);v.target=e,v._callbacks={},v._directMap={};var g,w={},k=!1,T=!1,C=!1;v._handleKey=function(e,i,o){var a,s=n(e,i,o),l={},u=0,c=!1;for(a=0;a<s.length;++a)s[a].seq&&(u=Math.max(u,s[a].level));for(a=0;a<s.length;++a)if(s[a].seq){if(s[a].level!=u)continue;c=!0,l[s[a].seq]=1,r(s[a].callback,o,s[a].combo,s[a].seq)}else c||r(s[a].callback,o,s[a].combo);var p="keypress"==o.type&&T;o.type!=C||f(e)||p||t(l),T=c&&"keydown"==o.type},v._bindMultiple=function(e,t,n){for(var r=0;r<e.length;++r)m(e[r],t,n)},s(e,"keypress",i),s(e,"keydown",i),s(e,"keyup",i)}if(i){for(var w,k={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},T={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},C={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},O={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},E=1;E<20;++E)k[111+E]="f"+E;for(E=0;E<=9;++E)k[E+96]=E;b.prototype.bind=function(e,t,n){var r=this;return e=e instanceof Array?e:[e],r._bindMultiple.call(r,e,t,n),r},b.prototype.unbind=function(e,t){var n=this;return n.bind.call(n,e,function(){},t)},b.prototype.trigger=function(e,t){var n=this;return n._directMap[e+":"+t]&&n._directMap[e+":"+t]({},e),n},b.prototype.reset=function(){var e=this;return e._callbacks={},e._directMap={},e},b.prototype.stopCallback=function(e,t){var n=this;return!((" "+t.className+" ").indexOf(" mousetrap ")>-1)&&(!g(t,n.target)&&("INPUT"==t.tagName||"SELECT"==t.tagName||"TEXTAREA"==t.tagName||t.isContentEditable))},b.prototype.handleKey=function(){var e=this;return e._handleKey.apply(e,arguments)},b.addKeycodes=function(e){for(var t in e)e.hasOwnProperty(t)&&(k[t]=e[t]);w=null},b.init=function(){var e=b(o);for(var t in e)"_"!==t.charAt(0)&&(b[t]=function(t){return function(){return e[t].apply(e,arguments)}}(t))},b.init(),i.Mousetrap=b,"undefined"!=typeof e&&e.exports&&(e.exports=b),r=function(){return b}.call(t,n,t,e),!(r!==a&&(e.exports=r))}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},1024:function(e,t,n){(function(r,i,o){function a(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=window.cow.favicons,n=A.faviconNode,r=t.default;if(n.length>0)switch(e=e||window.cow.pageType){case"home":r=t.default;break;case"folder":r=t.folder;break;case"doc":r=t.doc;break;case"spreadsheet":r=t.sheet}var i=n.attr("href");if(i!==r){if(o.msie)return;n.attr("href",r)}}Object.defineProperty(t,"__esModule",{value:!0});var l=n(166),u=a(l),c=n(175),p=a(c),d=n(1025),f=a(d),h=n(1087),m=a(h),v=n(1091),y=a(v),g=n(191),b=a(g),w=n(393),k=a(w),T=n(1096),C=a(T),O=n(391),E=a(O),P=n(1177),x=a(P),_=n(7),S=a(_),N=n(162),j=a(N);n(1239);var M=n(390),L=a(M),A={headerWrap:r("#header-wrap"),listViewWrap:r("#list-view-wrap"),docViewWrap:r("#doc-view"),padViewWrap:r("#pad-view"),qlViewWrap:r("#ql-view"),spreadsheetViewWrap:r("#spreadsheet-view"),sheetViewWrap:r("#sheet-view"),feedback:r(".meiqia-feedback"),galleryBox:r("#gallery-box"),faviconNode:r("#favicon-link"),headNode:r("head"),bodyNode:r("body")},I=!1,D=null,F={checkNewVersion:function(e,t){window.cow._needReload&&(window.location.href=e.path),t()},setPageType:function(e,t){var n=e.path,r=/^\/(desktop|recent|favorites)/,i=/^\/folder\/*/,o=/^\/doc\/\/*/,a=/^\/spreadsheet\/*/,s=/^\/sheet\/*/,l=/^\/newdoc\/\/*/,u=!0,c="";switch(r.test(n)?c="home":i.test(n)?c="folder":o.test(n)?c="doc":a.test(n)?c="spreadsheet":s.test(n)?c="sheet":l.test(n)?c="newdoc":u=!1,window.ga&&window.ga("send","event","visit",c,e.path),e.path){case"/recent":window.cow.listType="recent";break;case"/favorites":window.cow.listType="favorites";break;default:window.cow.listType="list"}u&&(window.cow.pageType=c),e.init||(window._czc&&window._czc.push(["_trackPageview",e.path]),window.ga&&window.ga("send","pageview",e.path)),t()},renderHeader:function(){A.headerWrap.length>0&&(r(".header-avatar-wrap").children().remove(),D?D.update({type:cow.pageType,currentFile:cow.currentFile}):D=j.default.render(S.default.createElement(x.default,{type:cow.pageType,currentUser:cow.currentUser,currentFile:cow.currentFile}),document.getElementById("header-wrap"))),s()},hideLast:function(){F.renderHeader(),"doc"===window.cow.lastType?R.hide("doc"):"spreadsheet"===window.cow.lastType?V.hide():"sheet"===window.cow.lastType?W.hide():"newdoc"===window.cow.lastType?R.hide("newdoc"):window.cow.lastType&&U.hide(),window.cow.loading=!1},exit:function(e,t){E.default.start(),window.cow.lastType=window.cow.pageType,window.cow.loading=!0,t()}},U={show:function(){F.hideLast(),A.listViewWrap.removeClass("hide"),A.spreadsheetViewWrap.addClass("hide"),A.sheetViewWrap.addClass("hide"),A.padViewWrap.add(A.qlViewWrap).addClass("hide"),A.bodyNode.addClass("list"),r(".list-container").scrollTop(0),r("div.import").show()},render:function(e){""!==window.cow.welcomeFile&&location.search.indexOf("from=register")>0&&(location.href="/doc/"+window.cow.welcomeFile);var t=e.params.guid||"",n=!0;e.init&&(b.default.load(),n=!1),(0,f.default)({guid:t,isAjaxForce:n})},hide:function(){}},R={show:function(e){F.hideLast(),A.listViewWrap.addClass("hide"),A.spreadsheetViewWrap.addClass("hide"),A.sheetViewWrap.addClass("hide"),A.feedback.removeClass("hide"),A.bodyNode.removeClass("list"),L.default.reset(cow.currentFile.guid),"newdoc"===e?(A.padViewWrap.addClass("hide"),A.qlViewWrap.removeClass("hide")):(A.padViewWrap.removeClass("hide"),A.qlViewWrap.addClass("hide"))},init:function(e){var t=e.params.guid;b.default.load(t),window.cow.currentUser.id<0&&i.stop(),I=!1,window.cow.directory={firstOpen:!1,isOpened:!1,isRunTimer:null},window.cow.doceditor={},/^\/newdoc\/\/*/.test(e.path)?(0,y.default)(t,!0):(0,m.default)(t,!0)},hide:function(e){r("#pad-view-inner").removeClass("readonly commentable"),r(".image-resize-bar").removeClass("active"),A.docViewWrap.scrollTop(0),r("#doc-title-input").blur(),r("#doc-container").css("opacity",0),A.padViewWrap.add(A.qlViewWrap).removeClass("selection-unfold edit-mode"),r(".sidebar-body").removeClass("start-s-comment s-comment"),r("#doc-directory").children("ul").html('<li class="dir-not-found">添加标题后会在这里自动生成目录。</li>'),r("#display-selection .display-item").removeClass("pressed"),A.galleryBox.removeClass("modal"),r("#tempImageResizeStyle").remove(),r("#tempAttachmentStyle").remove(),p.default.clearDropdown(),"doc"===e?(u.default.notify("pad:dispose"),u.default.detach("caret:change")):"newdoc"===e&&u.default.notify("newpad:dispose"),u.default.notify("doc:goback")}},V={show:function(){F.hideLast(),A.listViewWrap.addClass("hide"),A.padViewWrap.add(A.padViewWrap).addClass("hide"),A.feedback.addClass("hide"),A.sheetViewWrap.addClass("hide"),A.spreadsheetViewWrap.removeClass("hide"),A.bodyNode.removeClass("list").addClass("spreadsheet"),L.default.reset(cow.currentFile.guid),u.default.notify("spreadsheet:enter")},init:function(e){var t=e.params.guid,n=e.params.sheetId;b.default.load(t),(0,k.default)(t,n,{isReadonly:!1})},hide:function(){A.spreadsheetViewWrap.removeClass("ready"),A.bodyNode.removeClass("spreadsheet"),A.feedback.removeClass("hide"),window.tableInst&&window.tableInst.table&&window.tableInst.destroy(),window.cow.tempCurrentFile&&(window.cow.tempCurrentFile.content=null),u.default.notify("spreadsheet:exit"),u.default.notify("accept:success")}},W={show:function(){F.hideLast(),A.listViewWrap.addClass("hide"),A.padViewWrap.add(A.padViewWrap).addClass("hide"),A.feedback.addClass("hide"),A.spreadsheetViewWrap.addClass("hide"),A.sheetViewWrap.removeClass("hide"),A.bodyNode.removeClass("list").addClass("spreadsheet"),L.default.reset(cow.currentFile.guid),u.default.notify("spreadsheet:enter")},init:function(e){var t=e.params.guid,n=e.params.sheetId;b.default.load(t),(0,C.default)(t,n,{isReadonly:!1})},hide:function(){A.sheetViewWrap.removeClass("ready"),A.bodyNode.removeClass("spreadsheet"),A.feedback.removeClass("hide"),window.cow.tempCurrentFile&&(window.cow.tempCurrentFile.content=null),u.default.notify("spreadsheet:exit"),u.default.notify("accept:success")}},B=function(){if(!I){var e=i.current.replace("/doc/",""),t=history.state.isAjaxForce||!1;b.default.load(e),window.cow.currentUser.id<0&&i.stop(),(0,m.default)(e,t)}},$=function(e){I=e};u.default.attach("socket:reconnected",function(){if("doc"===window.cow.pageType){u.default.notify("pad:sendClientStatus","ready",!0);var e=/^\/doc\/*/,t=i.current;e.test(t)&&B()}}),t.default={common:F,list:U,doc:R,spreadsheet:V,sheet:W,setDocInit:$},e.exports=t.default}).call(t,n(1),n(176),n(291))},1025:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1024),o=r(i);t.default=function(e){var t=e.guid,r=e.isAjaxForce;n.e(7,function(){var e=n(1026).ListContainer,i=n(1083);o.default.list.show(),i({guid:t,ListContainer:e,isAjaxForce:r})})},e.exports=t.default},1033:function(e,t,n){var r,i;(function(o){r=[n(163)],i=function(e){var t;return new(t=function(){function t(){var e;e=this,this.isReady=!1,this.guideDocTitle="欢迎使用石墨文档",this.$tipContainter=o("body"),this.sheetSplashName="spread_sheet_splash",this.needToGuide()&&(window.cow.guideStatus?this.guideStatus=window.cow.guideStatus:this.getGuideInfo()),this.accountTypeStatus=""}return t.prototype.needToGuide=function(){return(["payment","home","folder"].indexOf(window.cow.pageType)>=0||this.isGuideDoc())&&!cow.isMobile&&!cow.readonly&&cow.currentUser.id>0},t.prototype.checkIsReady=function(){var e,t;return t=this,e=o.Deferred(),t.isReady?e.resolve(t.guideStatus):t.getGuideInfo().then(function(){return t.isReady=!0,e.resolve(t.guideStatus)}).fail(function(){return e.reject()}),e.promise()},t.prototype.getGuideInfo=function(){var t,n;return n=this,t=o.Deferred(),e.get("/api/user_guide_info",{guide_type:"web"},function(e){return 0===e.code?(window.cow.guideStatus=e.data.status,n.guideStatus=window.cow.guideStatus,window.cow.guideStatus.tips=[],n.isReady=!0,t.resolve()):t.reject()},function(){return t.reject()}),t.promise()},t.prototype.getMembershipInfo=function(){var t,n;return n=this,t=o.Deferred(),e.get("/api/get_membership_info",{},function(e){return 0===e.code?(n.shouldNotifyRenewal=e.data.shouldNotifyRenewal,n.shouldNotifyExpiration=e.data.shouldNotifyExpiration,cow.currentUser.accountTypeExpiredAt=e.data.accountTypeExpiredAt,t.resolve()):t.reject()},function(){return t.reject()}),t.promise()},t.prototype.removeMembershipTip=function(){return e.post("/flash_messages/read",{message_name:"membership_"+this.accountTypeStatus})},t.prototype.removeTipAjax=function(t){var n,r;return r=this,n=o.Deferred(),e.post("/api/update_user_guide_info",{guide_type:"web",type:t}).then(function(){return window.cow.guideStatus[t]=r.guideStatus[t]=!0,n.resolve()}).fail(function(){return n.reject()}),n.promise()},t.prototype.isGuideDoc=function(){return"doc"===window.cow.pageType&&window.cow.currentFile.name===this.guideDocTitle},t}())}.apply(t,r),!(void 0!==i&&(e.exports=i))}).call(t,n(1))},1087:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){n.e(10,function(){var r=n(1088).initDoc;r(e,t)})},e.exports=t.default},1091:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){n.e(11,function(){var r=n(1092).initDoc;r(e,t)})},e.exports=t.default},1096:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){n.e(12,function(i){(function(i){n(1097),n(1098);var o=n(1099),a=n(1174);a(i.extend({SpreadsheetContainer:o,guid:e,sheetId:t},r))}).call(this,n(4))})},e.exports=t.default},1177:function(e,t,n){(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},u=n(7),c=i(u),p=n(1178),d=i(p),f=n(1184),h=i(f),m=n(1190),v=i(m),y=n(1224),g=i(y),b=n(1226),w=i(b),k=n(1227),T=i(k),C=n(1231),O=i(C),E=n(285),P=i(E),x=n(1235),_=i(x),S=n(1236),N=i(S),j=n(1237),M=i(j),L=n(266),A=n(1238),I=i(A),D=["spreadsheet","sheet","doc","newdoc"],F=function(e){function t(e){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={currentUser:r.assign({},e.currentUser),currentFile:e.currentFile,type:e.type}}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{currentUser:u.PropTypes.object.isRequired,currentFile:u.PropTypes.object,type:u.PropTypes.string}}}]),s(t,[{key:"componentDidMount",value:function(){(0,g.default)(),(0,N.default)()}},{key:"update",value:function(e){this.setState(e)}},{key:"renderLeftHeader",value:function(){var e=this.state.type;if(D.indexOf(e)>-1)return c.default.createElement(O.default,{currentFile:this.state.currentFile,currentUser:this.state.currentUser});var t=this.state.currentUser.team,n=void 0;return t&&t.resources&&(n=c.default.createElement(d.default,{className:"header-logo-img",src:[t.resources.desktopLogo+"!1x",t.resources.desktopLogo]})),c.default.createElement("a",{className:"header-logo "+(n?"":"logo-22"),href:"/desktop"},n)}},{key:"renderRightHeader",value:function(){var e=this.state,t=e.type,n=e.currentUser,r=[];return D.indexOf(t)>-1?(r=[c.default.createElement(_.default,{key:0}),c.default.createElement("div",{key:1,className:"header-item-wrap"},c.default.createElement(h.default,{currentUser:this.state.currentUser}))],this.state.currentUser.id<0&&r.push(c.default.createElement(I.default,{key:2,currentFile:this.state.currentFile,currentUser:n})),(0,L.checkIsExampleFile)()&&r.push(c.default.createElement(M.default,{key:3}))):(r.push(c.default.createElement("div",{key:0,className:"header-item-wrap"},c.default.createElement(w.default,{currentUser:n}))),["profile"].indexOf(t)===-1&&r.push(c.default.createElement("div",{key:1,className:"header-item-wrap"},c.default.createElement(T.default,null))),r.push(c.default.createElement("div",{key:2,className:"header-item-wrap"},c.default.createElement(v.default,{onlyUnread:!0}))),r.push(c.default.createElement("div",{key:3,className:"header-item-wrap"},c.default.createElement(h.default,{currentUser:this.state.currentUser})))),r}},{key:"render",value:function(){var e=this.state.type,t=(0,P.default)({header:!0,"file-header":D.indexOf(e)>-1});return c.default.createElement("div",{id:"header",className:t},c.default.createElement("div",{className:"h-container"},c.default.createElement("div",{className:"header-left-box list-header"},this.renderLeftHeader()),c.default.createElement("div",{className:"header-right-box"},this.renderRightHeader())))}}]),t}(u.Component);t.default=F,e.exports=t.default}).call(t,n(4))},1178:function(e,t,n){var r,i,o,a,s,l;r=n(7),s=n(1179),a=n(1180),l=n(1181),o=n(1182),i=n(1183),e.exports=r.createClass({displayName:"RetinaImage",propTypes:{src:r.PropTypes.oneOfType([r.PropTypes.string,r.PropTypes.array]).isRequired,checkIfRetinaImgExists:r.PropTypes.bool,forceOriginalDimensions:r.PropTypes.bool,retinaImageSuffix:r.PropTypes.string,handleOnLoad:r.PropTypes.func,onLoad:r.PropTypes.func,onError:r.PropTypes.func},getDefaultProps:function(){return{checkIfRetinaImgExists:!0,forceOriginalDimensions:!0,retinaImageSuffix:"@2x",onError:function(){}}},componentWillReceiveProps:function(e){var t;if(t=!0,t=Array.isArray(this.props.src)&&Array.isArray(e.src)?i(this.props.src,e.src):this.props.src===e.src,!t)return this.setState(o(this.wrangleProps(e),{width:null,height:null,imgLoaded:null,retinaImgExists:null,retinaCheckComplete:null}))},getInitialState:function(){return this.wrangleProps()},componentDidMount:function(){return this.checkForRetina(),this.checkLoaded()},componentDidUpdate:function(){return this.checkForRetina()},render:function(){var e;return e=o({},this.props),delete e.src,delete e.checkIfRetinaImgExists,delete e.forceOriginalDimensions,delete e.retinaImageSuffix,delete e.handleOnLoad,delete e.onLoad,delete e.onError,e.src=this.state.src,e.onLoad=this.handleOnLoad,e.onError=this.props.onError,this.state.width>=0&&(e.width=this.state.width),this.state.height>=0&&(e.height=this.state.height),r.createElement("img",Object.assign({},e,{ref:"img"}))},wrangleProps:function(e){return null==e&&(e=this.props),Array.isArray(e.src)?{src:e.src[0],srcIsArray:!0}:{src:e.src,srcIsArray:!1}},checkForRetina:function(){if(!this.state.retinaCheckComplete)return s()&&this.props.checkIfRetinaImgExists?a(this.getRetinaPath(),function(e){return function(t){var n;return t&&(null!=(n=e.state)?n.imgLoaded:void 0)?e.setState({src:e.getRetinaPath()}):t&&e.setState({retinaImgExists:!0}),e.setState({retinaCheckComplete:!0})}}(this)):s()&&!this.props.checkIfRetinaImgExists?(this.setState({src:this.getRetinaPath()}),this.setState({retinaCheckComplete:!0})):void 0},checkLoaded:function(){var e;return e=this.refs.img,!!e.complete&&(0!==e.naturalWidth&&this.handleOnLoad())},handleOnLoad:function(e){var t;if(null!=this.props.onLoad&&this.props.onLoad(e),null!=this.props.handleOnLoad&&this.props.handleOnLoad(e),this.props.forceOriginalDimensions&&this.setState({width:this.refs.img.clientWidth,height:this.refs.img.clientHeight}),this.setState({imgLoaded:!0}),(null!=(t=this.state)?t.retinaImgExists:void 0)||!this.props.checkIfRetinaImgExists)return this.setState({src:this.getRetinaPath()})},getRetinaPath:function(){var e,t;return this.state.srcIsArray?this.props.src[1]:(e=l.basename(this.props.src,l.extname(this.props.src)),e=e+this.props.retinaImageSuffix+l.extname(this.props.src),t=this.props.src.replace(l.basename(this.props.src),e))}})},1179:function(e,t){e.exports=function(){var e;if("undefined"!=typeof window&&null!==window){if(e="(-webkit-min-device-pixel-ratio: 1.25), (min--moz-device-pixel-ratio: 1.25), (-o-min-device-pixel-ratio: 5/4), (min-resolution: 1.25dppx)",window.devicePixelRatio>1.25)return!0;if(window.matchMedia&&window.matchMedia(e).matches)return!0}return!1}},1180:function(e,t){var n={};e.exports=function(e,t){if(e in n)return t(n[e]);var r=new Image;
r.onload=function(){n[e]=!0,t(!0)},r.onerror=function(){n[e]=!1,t(!1)},r.src=e}},1181:function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(e){return i.exec(e).slice(1)};t.resolve=function(){for(var t="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var a=o>=0?arguments[o]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,i="/"===a.charAt(0))}return t=n(r(t.split("/"),function(e){return!!e}),!i).join("/"),(i?"/":"")+t||"."},t.normalize=function(e){var i=t.isAbsolute(e),o="/"===a(e,-1);return e=n(r(e.split("/"),function(e){return!!e}),!i).join("/"),e||i||(e="."),e&&o&&(e+="/"),(i?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,l=0;l<a;l++)if(i[l]!==o[l]){s=l;break}for(var u=[],l=s;l<i.length;l++)u.push("..");return u=u.concat(o.slice(s)),u.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=o(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},t.basename=function(e,t){var n=o(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return o(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(t,n(171))},1182:function(e,t){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function r(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==r.join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;e.exports=r()?Object.assign:function(e,t){for(var r,s,l=n(e),u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var c in r)o.call(r,c)&&(l[c]=r[c]);if(i){s=i(r);for(var p=0;p<s.length;p++)a.call(r,s[p])&&(l[s[p]]=r[s[p]])}}return l}},1183:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}},1184:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n=(0,u.qsa)(e)[0],r=t.currentUser;n&&(0,l.render)(s.default.createElement(p.default,{currentUser:r}),n)}function o(e){var t=(0,u.qsa)(e)[0];t&&(0,l.unmountComponentAtNode)(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.mount=i,t.unmount=o;var a=n(7),s=r(a),l=n(162),u=n(185),c=n(1185),p=r(c);t.default=p.default},1185:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=n(1186),p=r(c),d=n(1187),f=r(d),h=n(718),m=r(h),v=n(665),y=r(v),g=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={visible:!1},this.componentClick=this.componentClick.bind(this),this.closeMenuPopover=this.closeMenuPopover.bind(this),this.handleVisibleChange=this.handleVisibleChange.bind(this)}return o(t,e),a(t,null,[{key:"propTypes",get:function(){return{currentUser:l.PropTypes.object}}}]),a(t,[{key:"handleVisibleChange",value:function(e){this.setState({visible:e})}},{key:"closeMenuPopover",value:function(){this.state.visible&&this.setState({visible:!1})}},{key:"componentClick",value:function(e){var t=this.props.currentUser;if(!(t.id<0)){var n=this.refs.popover.getPopupDomNode();this.state.visible&&!n.contains(e.target)&&this.closeMenuPopover()}}},{key:"renderContent",value:function(){var e=this.props.currentUser;return u.default.createElement(f.default,{currentUser:e,closeMenuPopover:this.closeMenuPopover})}},{key:"render",value:function(){var e=this.props.currentUser,t=e.avatar,n=this.state.visible;return e.id<0?u.default.createElement("div",{className:"config-avatar-wrap"},u.default.createElement(p.default,{customClass:"config-avatar anonymous",avatarSrc:t})):u.default.createElement(m.default,{ref:"popover",overlayClassName:"header-menu-popover",visible:n,onVisibleChange:this.handleVisibleChange,align:{offset:[0,3]},content:this.renderContent()},u.default.createElement("div",{className:"config-avatar-wrap"},u.default.createElement(p.default,{customClass:"config-avatar",avatarSrc:t})))}}]),t}(l.Component);t.default=(0,y.default)(g),e.exports=t.default},1186:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=n(161),p=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e)}return o(t,e),a(t,null,[{key:"propTypes",get:function(){return{avatarSrc:l.PropTypes.string,customClass:l.PropTypes.string}}}]),a(t,[{key:"render",value:function(){var e=this.props.avatarSrc;return u.default.createElement("div",{className:"avatar "+this.props.customClass},u.default.createElement(c.ImageIcon,{customClass:"",defaultImg:"https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif",realImg:e}))}}]),t}(l.Component);t.default=p,e.exports=t.default},1187:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(162),u=n(7),c=r(u),p=n(285),d=r(p),f=n(1188),h=r(f),m=n(1189),v=r(m),y=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.onMenuItemClick=this.onMenuItemClick.bind(this),this.onDownloadAppClose=this.onDownloadAppClose.bind(this)}return o(t,e),a(t,null,[{key:"propTypes",get:function(){return{currentUser:u.PropTypes.object,closeMenuPopover:u.PropTypes.func}}}]),a(t,[{key:"onMenuItemClick",value:function(e){var t=this.props.closeMenuPopover,n=e.currentTarget.getAttribute("data-action");"download"===n&&(this.modalContainer=document.getElementById("downloadapp-modal-container"),this.modalContainer||(this.modalContainer=document.createElement("div"),this.modalContainer.id="downloadapp-modal-container",document.body.appendChild(this.modalContainer)),this.downloadAppModal=(0,l.unstable_renderSubtreeIntoContainer)(this,c.default.createElement(v.default,{onClose:this.onDownloadAppClose}),this.modalContainer)),"function"==typeof t&&t()}},{key:"renderDividingLine",value:function(){return c.default.createElement("div",{className:"header-menu-dividing"})}},{key:"renderPlainMenuItem",value:function(e,t,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],i=(0,d.default)({"header-menu-item":!0,"one-line":!0,"enable-click":t}),o=t?this.onMenuItemClick:null;return t&&n?c.default.createElement("a",{className:i,href:n,target:r?"_blank":"",onClick:o},c.default.createElement("span",null,e)):c.default.createElement("div",{className:i,onClick:o},c.default.createElement("span",null,e))}},{key:"onDownloadAppClose",value:function(){(0,l.unmountComponentAtNode)(this.modalContainer)}},{key:"renderDownloadApp",value:function(){return c.default.createElement("div",{className:"header-menu-item enable-click","data-action":"download",onClick:this.onMenuItemClick},c.default.createElement("span",null,"下载石墨文档 App"),c.default.createElement("i",{className:"desktop-sprite download-app-icon"}))}},{key:"renderAccountType",value:function(){return c.default.createElement("div",{className:"header-menu-item"},c.default.createElement(h.default,{currentUser:this.props.currentUser,onItemClick:this.onMenuItemClick}))}},{key:"renderManageSetting",value:function(){var e=this.props.currentUser,t=e.accountType,n=e.teamRole;return["enterprise_standard","enterprise_dingding","enterprise_expired"].indexOf(t)>-1?this.renderPlainMenuItem("member"===n?"我的企业":"企业管理",!0,"/enterprise",!0):null}},{key:"render",value:function(){var e=this.props.currentUser,t=e.name;return c.default.createElement("div",{className:"header-menu-items"},this.renderPlainMenuItem(t,!1)," ",this.renderDividingLine(),this.renderAccountType()," ",this.renderDividingLine()," ",this.renderPlainMenuItem("帐号设置",!0,"/profile",!1),this.renderManageSetting()," ",this.renderDividingLine(),this.renderDownloadApp()," ",this.renderPlainMenuItem("使用帮助",!0,"https://shimo.im/help",!0),this.renderDividingLine(),this.renderPlainMenuItem("退出登录",!0,"/logout",!1))}}]),t}(u.Component);t.default=y,e.exports=t.default},1188:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=function(e){function t(){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return o(t,e),a(t,[{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.onItemClick,r=t.accountType,i=t.team,o=t.email,a="",s=null;["enterprise_standard","enterprise_dingding","enterprise_expired"].indexOf(r)>-1?(a="企业版",s=u.default.createElement("span",{className:"enterprise-name"},i.name)):"personal_premium"===r?a="个人高级版":"personal_free"===r&&(a="个人免费版",s=u.default.createElement("a",{href:"/payment",target:"_blank",onClick:n,className:"account-upgrade-btn header-menu-link"},"升级"));var l=null;return l=o?u.default.createElement("span",{className:"account-email"},o):u.default.createElement("a",{className:"account-email-setting header-menu-link",href:"/profile#setting-email",onClick:n,target:"_blank"},"设置您的登录邮箱"),u.default.createElement("div",{className:"account-info"},u.default.createElement("span",{className:"account-type-text"},a),s,l)}}],[{key:"propTypes",get:function(){return{currentUser:l.PropTypes.object,onItemClick:l.PropTypes.func}}}]),t}(l.Component);t.default=c,e.exports=t.default},1189:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=n(284),p=r(c),d=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.bodyTpl=this.bodyTpl.bind(this),this.onModalClose=this.onModalClose.bind(this)}return o(t,e),a(t,null,[{key:"propTypes",get:function(){return{onClose:l.PropTypes.func}}}]),a(t,[{key:"bodyTpl",value:function(){return u.default.createElement("div",{className:"download-app-content-wrap"},u.default.createElement("span",{className:"download-app-title"},"扫码下载 石墨文档 App"),u.default.createElement("div",{className:"download-app-url-qrcode"}),u.default.createElement("div",{className:"download-app-actions"},u.default.createElement("a",{href:"https://itunes.apple.com/cn/app/shi-mo-wen-dang-zui-mei-xie/id1013727678?l=en&mt=8",style:{display:"block"},className:"sm-btn sm-btn-primary download-app-btn",target:"_blank"},u.default.createElement("i",{className:"band-icon-sprite ios-band-icon band-icon"}),u.default.createElement("span",{className:"download-btn-text"},"App Store 下载")),u.default.createElement("a",{href:"https://shimo.im/resources/android_app",style:{display:"block"},className:"sm-btn sm-btn-primary download-app-btn",target:"_blank"},u.default.createElement("i",{className:"band-icon-sprite android-band-icon band-icon"}),u.default.createElement("span",{className:"download-btn-text"},"Android 版下载"))))}},{key:"onModalClose",value:function(){var e=this.props.onClose;"function"==typeof e&&e()}},{key:"render",value:function(){var e=!0,t=!0,n=!0;return u.default.createElement(p.default,{customClass:"download-app-modal",ref:"flatDialog",hasCloseButton:e,open:n,enableCloseClickMask:t,bodyTpl:this.bodyTpl,onClose:this.onModalClose})}}]),t}(l.Component);t.default=d,e.exports=t.default},1190:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=document.querySelector(e);t&&(0,l.render)(s.default.createElement(c.default,{onlyUnread:!0}),t)}function o(e){var t=document.querySelector(e);t&&(0,l.unmountComponentAtNode)(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.mount=i,t.unmount=o,n(1191);var a=n(7),s=r(a),l=n(162),u=n(1213),c=r(u);t.default=c.default},1191:function(e,t){},1213:function(e,t,n){(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},u=n(7),c=i(u),p=(n(4),n(718)),d=i(p),f=n(1214),h=i(f),m=n(231),v=n(1220),y=i(v),g=function(e){function t(e){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleVisibleChange=this.handleVisibleChange.bind(this),this.hideGuideTip=this.hideGuideTip.bind(this),this.state={visible:!1,unpeaked:0,guideTipVisible:!1}}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{messages:u.PropTypes.array}}},{key:"defaultProps",get:function(){return{messages:[]}}}]),s(t,[{key:"componentDidMount",value:function(){var e=this;this.getMessageCount(),this.interval=setInterval(function(){return e.getMessageCount()},6e4)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"showGuideTip",value:function(){location.href.match(/from=tutorial/)&&this.setState({guideTipVisible:!0,positionNodeElement:document.getElementsByClassName("message-popover-trigger")[0]})}},{key:"hideGuideTip",value:function(){location.href.match(/from=tutorial/)&&this.setState({guideTipVisible:!1},function(){return r("/desktop")})}},{key:"getMessageCount",value:function(){var e=this;(0,m.ajaxGet)("/smapi/notifications/unpeeked_count").then(function(t){e.setState({unpeaked:t.data||0})})}},{key:"handleVisibleChange",value:function(e){this.setState({visible:e,unpeaked:0})}},{key:"renderContent",value:function(){return c.default.createElement(h.default,null)}},{key:"renderBadge",value:function(){var e=this.state.unpeaked>99?"99+":this.state.unpeaked;return c.default.createElement("span",{className:"badge"},c.default.createElement("em",null,e))}},{key:"render",value:function(){return c.default.createElement(d.default,{arrowPointAtCenter:!0,destroyTooltipOnHide:!0,align:{offset:[60,3]},overlayClassName:"message-popover",visible:this.state.visible,onVisibleChange:this.handleVisibleChange,content:this.renderContent()},c.default.createElement("div",{className:"message-popover-trigger",onClick:this.hideGuideTip},c.default.createElement("div",{className:"icon icon-message"},this.state.unpeaked>0&&this.renderBadge()),c.default.createElement(y.default,{text:"来自 石墨文档 的新消息",placement:"bottomRight",colorName:"blue",hasBubble:!1,offsetLeft:10,offsetTop:20,visible:this.state.guideTipVisible,positionNodeElement:this.state.positionNodeElement})))}}]),t}(u.Component);t.default=g,e.exports=t.default}).call(t,n(176))},1214:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=n(285),p=r(c),d=n(231),f=n(1001),h=n(1215),m=r(h),v=function(e,t){var n="/smapi/notifications?action=peek&status="+e;return t&&(n+="&lt="+t),(0,d.ajaxGet)(n).then(function(e){return e.data})},y=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleFilterClick=this.handleFilterClick.bind(this),this.handleReadAllClick=this.handleReadAllClick.bind(this),this.handleLoadMore=this.handleLoadMore.bind(this),this.readMessage=this.readMessage.bind(this),this.joinTeam=this.joinTeam.bind(this),this.state={loaded:!1,unread:0,filter:"all",hasMore:!0,messages:[]}}return o(t,e),a(t,[{key:"componentDidMount",value:function(){this.getMessages(),this.getMessageCount()}},{key:"handleFilterClick",value:function(e){var t=this;if("span"===e.target.tagName.toLowerCase()){var n=e.target.className;this.setState({filter:n,loaded:!1,messages:[]},function(){t.getMessages()})}}},{key:"handleReadAllClick",value:function(){var e=this;(0,d.ajaxPost)("/smapi/notifications/action/read_all",{}).then(function(){var t=e.state.messages.map(function(e){return e.status="read",e});e.setState({unread:0,messages:t})})}},{key:"handleLoadMore",value:function(){var e=this,t=this.state.messages,n=t[t.length-1].id;return v(this.state.filter,n).then(function(n){var r=t;n.length>0&&(r=[].concat(r,n)),e.setState({hasMore:n.length>=20,messages:r})})}},{key:"getMessages",value:function(){var e=this;return v(this.state.filter).then(function(t){e.setState({messages:t,loaded:!0})})}},{key:"getMessageCount",value:function(){var e=this;return(0,d.ajaxGet)("/smapi/notifications/unread_count").then(function(t){e.setState({unread:t.data||0})})}},{key:"readMessage",value:function(e){var t=this;return(0,d.ajaxPatch)("/smapi/notifications/"+e+"?status=read").then(function(){var e=t.state.unread-1;e<=0&&(e=0),t.setState({unread:e})})}},{key:"joinTeam",value:function(e){return(0,d.ajaxPost)("/smapi/users/me/action/join_team_by_invitation",{teamId:e})}},{key:"renderMessageItems",value:function(){var e=this,t="all"===this.state.filter?"没有通知":"没有未读通知",n=this.state.messages;if(0===n.length)return u.default.createElement("div",{className:"empty"},t);var r=n.map(function(t){var n=(0,m.default)(t.notification.type);return u.default.createElement(n,{key:t.id,message:t,joinTeam:e.joinTeam,readMessage:e.readMessage})});return r}},{key:"render",value:function(){var e=(0,p.default)("filter",this.state.filter);return u.default.createElement("div",{className:"message-box"},u.default.createElement("div",{className:"panel"},u.default.createElement("div",{className:e,onClick:this.handleFilterClick},u.default.createElement("span",{className:"all"},"全部通知"),u.default.createElement("span",{className:"unread"},"未读 ("+this.state.unread+")")),u.default.createElement("div",{className:"btn btn-link",onClick:this.handleReadAllClick},"标记全部已读")),u.default.createElement(f.InfiniteScroll,{noMoreText:"没有更多通知了",key:this.state.filter,spinning:!this.state.loaded,hasMore:this.state.hasMore,loadMore:this.handleLoadMore},this.renderMessageItems()))}}]),t}(l.Component);t.default=y,e.exports=t.default},1215:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText.trim()}function o(e){return e.replace(/(<a\s+)/g,"@$1")}Object.defineProperty(t,"__esModule",{value:!0}),t.washHTML=i,t.markMentionText=o;var a=n(7),s=r(a),l=n(285),u=r(l),c=n(1216),p=r(c),d=n(1217),f=r(d),h={};t.default=function(e){var t=p.default.TYPES[e],n=h[t]||h.default;return n};var m=h.default=function(e){return s.default.createElement("noscript",null)};t.Default=m;var v=h.comment=function(e){var t=e.message.notification,n=t.user,r=t.file;return s.default.createElement(p.default,e,s.default.createElement("img",{className:"message-icon",src:n.avatar}),s.default.createElement("div",{className:"message-title"},s.default.createElement(f.default,{size:8},n.name),s.default.createElement("span",null,"评论了"),s.default.createElement(f.default,{className:"file-name",size:20},r.name)),s.default.createElement(f.default,{className:"message-content",size:78},i(o(t.msg))))};t.Comment=v;var y=h.teamwork=function(e){var t=e.message.notification,n=t.user,r=t.file,i=(0,u.default)("message-icon",r.type);return s.default.createElement(p.default,e,s.default.createElement("div",{className:i}),s.default.createElement("div",{className:"message-title"},s.default.createElement(f.default,{size:8},n.name),s.default.createElement("span",null,t.msg)),s.default.createElement(f.default,{className:"message-content",size:36},r&&r.name))};t.Teamwork=y;var g=h.destroy=function(e){var t=e.message.notification,n=t.user,r=t.file,i=(0,u.default)("message-icon",r.type);return s.default.createElement(p.default,e,s.default.createElement("div",{className:i}),s.default.createElement("div",{className:"message-title"},s.default.createElement(f.default,{size:8},n.name),s.default.createElement("span",null,t.msg)),s.default.createElement(f.default,{className:"message-content",size:36},r&&r.name))};t.Destroy=g;var b=h.mention=function(e){var t=e.message.notification,n=t.user,r=t.file;return s.default.createElement(p.default,e,s.default.createElement("img",{className:"message-icon",src:n.avatar}),s.default.createElement("div",{className:"message-title"},s.default.createElement(f.default,{size:8},n.name),s.default.createElement("span",null,t.msg)),s.default.createElement(f.default,{className:"message-content",size:36},r.name))};t.Mention=b;var w=h.team=function(e){var t=e.message.notification,n=t.user,r=(0,u.default)("message-icon","team");return s.default.createElement(p.default,e,s.default.createElement("div",{className:r}),s.default.createElement("div",{className:"message-title"},s.default.createElement(f.default,{size:8},n.name),s.default.createElement("span",null,t.msg)))};t.Team=w;var k=h.system=function(e){var t=e.message.notification,n=(0,u.default)("message-icon","system");return s.default.createElement(p.default,e,s.default.createElement("div",{className:n}),s.default.createElement("div",{className:"message-title"},s.default.createElement("span",null,t.msg),t.link&&s.default.createElement("span",{className:"link"},"了解更多")))};t.System=k;var T=h.invitation=function(e){var t=e.message.notification,n=t.user,r=(0,u.default)("message-icon","team");return s.default.createElement(p.default,e,s.default.createElement("div",{className:r}),s.default.createElement("div",{className:"message-title"},s.default.createElement(f.default,{size:8},n.name),s.default.createElement("span",null,t.msg),s.default.createElement(f.default,{className:"team-name"},n.team.name)))};t.Invitation=T;var C=h.member=function(e){var t=e.message.notification,n=t.user;t.file;return s.default.createElement(p.default,e,s.default.createElement("img",{className:"message-icon",src:n.avatar}),s.default.createElement("div",{className:"message-title"},s.default.createElement(f.default,{size:8},n.name),s.default.createElement("span",null,t.msg)))};t.Member=C},1216:function(e,t,n){(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},u=n(7),c=i(u),p=n(285),d=i(p),f=n(1217),h=n(175),m=i(h),v={0:"comment",1:"mention",2:"teamwork",3:"team",4:"invitation",5:"member",6:"destroy",20:"system"},y=function(e){function t(e){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleClick=this.handleClick.bind(this),this.state={status:e.message.status}}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{message:u.PropTypes.object,readMessage:u.PropTypes.func,joinTeam:u.PropTypes.func}}}]),s(t,[{key:"componentWillReceiveProps",value:function(e){"read"===e.message.status&&this.setState({status:"read"})}},{key:"handleClick",value:function(e){var t=this.props.message,n=t.notification,i=t.status;"read"!==i&&this.readMessage(this.props.message.id);var o=n.link,a=n.file,s=o;o&&a&&a.type&&("document"===a.type?s="/doc"+s:"spreadsheet"===a.type&&(s="/spreadsheet"+s)),"mark-read"!==e.target.className&&r(s)}},{key:"readMessage",value:function(e){var t=this,n=this.state.status;this.setState({status:"read"}),this.props.readMessage(e).catch(function(e){console.log(e),t.setState({status:n})})}},{key:"renderExtra",value:function(){var e=this,t=this.props.message.notification.user.team.id,n=cow.currentUser.teamId===t,i=n?"已加入":"加入",o=(0,d.default)("btn",{"btn-ok":!n,"btn-disabled":n}),a=function(i){return i.preventDefault(),n?i.stopPropagation():cow.currentUser.teamId?m.default.alert({title:"请先退出当前企业"}):e.props.joinTeam(t).then(function(e){return e.code?m.default.alert({title:e.message}):void r("/enterprise")})};return c.default.createElement("button",{className:o,onClick:a},i)}},{key:"render",value:function(){var e=this.props.message,t=e.notification,n=(e.status,(0,d.default)("message-item","type-"+v[t.type],{
read:"read"===this.state.status,unread:"read"!==this.state.status}));return c.default.createElement("div",{className:n,onClick:this.handleClick},this.props.children,c.default.createElement("div",{className:"message-meta"},20===t.type&&c.default.createElement("span",{className:"offcial"},"系统通知・"),c.default.createElement(f.Timeago,null,t.createdAt)),c.default.createElement("div",{className:"message-extra"},4===t.type&&this.renderExtra()),c.default.createElement("div",{className:"mark-read"}))}}]),t}(u.Component);t.default=y,y.TYPES=v,e.exports=t.default}).call(t,n(176))},1217:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1218),o=r(i),a=n(1219),s=r(a);o.default.Timeago=s.default,t.default=o.default,e.exports=t.default},1218:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),o=r(i),a=n(285),s=r(a),l={size:i.PropTypes.number,width:i.PropTypes.number,children:i.PropTypes.string,className:i.PropTypes.string},u={size:0,width:0,children:"",className:""},c=function(e,t){var n=e.replace(/[^\x00-\xff]/gi,"aa").length;return n<=t?e:e.substr(0,Math.ceil(t/2))+"..."},p=function(e){var t={},n=e.children,r=(0,s.default)("sm-label",e.className,{"text-overflow":e.width>0});return e.width>0&&(t.maxWidth=e.width),e.size>0&&(n=c(n,e.size)),o.default.createElement("span",{className:r,style:t},n)};p.propTypes=l,p.defaultProps=u,t.default=p,e.exports=t.default},1219:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return e<10?"0"+e:e}function o(e){var t=new Date,n=60*t.getTimezoneOffset(),r=+t/1e3,o=new Date(e),a=+new Date(e)/1e3,s=a-r+r%86400-n,l=i(o.getHours())+":"+i(o.getMinutes());if(s>0&&s<86400)return"今天 "+l;if(s>-86400&&s<0)return"昨天 "+l;var u=o.getMonth()+1+"/"+o.getDate();return u+=" "+l,o.getFullYear()!==t.getFullYear()&&(u=o.getFullYear()+"/"+u),u}Object.defineProperty(t,"__esModule",{value:!0});var a=n(7),s=r(a),l=n(1218),u=r(l),c=function(e){var t=o(e.children);return s.default.createElement(u.default,null,t)};c.propTypes={children:a.PropTypes.string},t.default=c,e.exports=t.default},1220:function(e,t,n){(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},c=n(7),p=i(c),d=n(162),f=i(d),h=n(720),m=i(h),v=n(1221),y=i(v),g=n(285),b=i(g),w=n(665),k=i(w);n(1222);var T=function(e){function t(e){var n=this;a(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={position:this.calcPosition()},this.getTooltipContainer=this.getTooltipContainer.bind(this),this.componentResize=this.componentResize.bind(this),this.componentClick=this.componentClick.bind(this),this.handleTriggerEvent=this.handleTriggerEvent.bind(this),this.handleTriggerEvents=r.zipObject(e.triggerEvents,e.triggerEvents.map(function(){return n.handleTriggerEvent})),e.isDebounced&&(this.handleTriggerEvents=r.zipObject(e.triggerEvents,e.triggerEvents.map(function(t){return e.debounceConfig&&r.isNumber(e.debounceConfig[t])?r.debounce(n.handleTriggerEvent,e.debounceConfig[t]):r.debounce(n.handleTriggerEvent,e.maxWait)})))}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{text:c.PropTypes.string,colorName:c.PropTypes.string,customClass:c.PropTypes.string,positionNodeElement:c.PropTypes.instanceOf(Element),triggerNodeElement:c.PropTypes.instanceOf(Element),triggerEvents:c.PropTypes.array,autoUpdate:c.PropTypes.bool,isDebounced:c.PropTypes.bool,debounceConfig:c.PropTypes.object,maxWait:c.PropTypes.number,offsetLeft:c.PropTypes.number,offsetTop:c.PropTypes.number,color:c.PropTypes.string,hasBubble:c.PropTypes.bool,viewRect:c.PropTypes.shape({minLeft:c.PropTypes.number,minTop:c.PropTypes.number,maxLeft:c.PropTypes.numner,maxTop:c.PropTypes.number}),visible:c.PropTypes.bool,placement:c.PropTypes.oneOf(["top","right","bottom","left","topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]),autoHide:c.PropTypes.bool,onNeedHide:c.PropTypes.func}}},{key:"defaultProps",get:function(){return{offsetLeft:0,offSetTop:0,color:"#41464b",hasBubble:!0,placement:"left",colorName:"yellow",autoUpdate:!0,isDebounced:!1,maxWait:300,triggerEvents:[]}}}]),l(t,[{key:"componentDidMount",value:function(){this.bindTriggerEvents()}},{key:"componentWillReceiveProps",value:function(e){e&&(e.visible&&!this.props.visible?(this.updatePosition(e),this.bindTriggerEvents(e)):!e.visible&&this.props.visible?this.unbindTriggerEvents(this.props):e.autoUpdate&&!this.props.autoUpdate?this.bindTriggerEvents(e):!e.autoUpdate&&this.props.autoUpdate?this.unbindTriggerEvents(this.props):e.triggerNodeElement&&!this.props.triggerNodeElement?this.bindTriggerEvents(e):!e.triggerNodeElement&&this.props.triggerNodeElement?this.unbindTriggerEvents(this.props):e.triggerEvents.length!==this.props.triggerEvents.length&&(this.unbindTriggerEvents(this.props),this.bindTriggerEvents(e)))}},{key:"componentWillUnmount",value:function(){this.intervalId>-1&&(clearInterval(this.intervalId),this.intervalId=-1),this.unbindTriggerEvents()}},{key:"bindTriggerEvents",value:function(e){var t=this,n=e||this.props,r=n.autoUpdate,i=n.triggerNodeElement,o=n.triggerEvents;r&&i&&o.length&&o.forEach(function(e){i.addEventListener(e,t.handleTriggerEvents[e])})}},{key:"unbindTriggerEvents",value:function(e){var t=this,n=e||this.props,r=n.autoUpdate,i=n.triggerNodeElement,o=n.triggerEvents;r&&i&&o.length&&o.forEach(function(e){i.removeEventListener(e,t.handleTriggerEvents[e])})}},{key:"handleTriggerEvent",value:function(){var e=this.props.visible;e&&this.updatePosition()}},{key:"calcPosition",value:function(e){var t=e||this.props,n=t.positionNodeElement,r=t.offsetLeft,i=t.offsetTop;if(!n)return{left:0,top:0};var o=n.getBoundingClientRect(),a=o.top+window.pageYOffset-n.clientTop,s=o.left+window.pageXOffset-n.clientLeft;return{left:s+(isNaN(r)?0:r),top:a+(isNaN(i)?0:i)}}},{key:"getTooltipContainer",value:function(){return f.default.findDOMNode(this)}},{key:"renderBubble",value:function(){var e=this.props,t=e.hasBubble,n=e.visible;return t&&n?p.default.createElement(y.default,null):p.default.createElement("div",{className:"guide-no-bubble"})}},{key:"componentResize",value:function(){this.updatePosition()}},{key:"componentClick",value:function(){this.props.autoHide&&"function"==typeof this.props.onNeedHide&&this.props.onNeedHide()}},{key:"updatePosition",value:function(e,t){var n=this.state.position,r=this.calcPosition(e);["top","left"].some(function(e){return r[e]!==n[e]})&&this.setState({position:r},function(){"function"==typeof t&&t(r)})}},{key:"render",value:function(){var e;if(!this.props.positionNodeElement)return null;var t=this.state.position,n=this.props,i=n.customClass,a=n.colorName,s=n.viewRect;if(s&&(r.isNumber(s.minLeft)&&t.left<s.minLeft||r.isNumber(s.minTop)&&t.top<s.minTop||r.isNumber(s.maxLeft)&&t.left>s.maxLeft||r.isNumber(s.maxTop)&&t.top>s.maxTop))return null;var l=(Object.assign||r.assign).call(null,{position:"fixed",pointerEvents:"none"},t),u=(0,b.default)((e={"guide-tip-wrap":!0},o(e,""+i,!!i),o(e,""+a,!!a),e));return p.default.createElement("div",{className:u,style:l},p.default.createElement(m.default,{title:this.props.text,arrowPointAtCenter:!0,placement:this.props.placement,visible:this.props.visible,getTooltipContainer:this.getTooltipContainer},this.renderBubble()))}}]),t}(c.Component);t.default=(0,k.default)(T),e.exports=t.default}).call(t,n(4))},1221:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=function(e){function t(){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return o(t,e),a(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"bubble-wrap"},u.default.createElement("div",{className:"bubble-outter"}),u.default.createElement("div",{className:"bubble-inner"}))}}]),t}(l.Component);t.default=c,e.exports=t.default},1222:function(e,t){},1224:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=e.data,n=e.desktopNotification,r=window.cow,i=r.desktopNotification,a=r.currentUser,s=r.pageType,l=r.currentFile,c=i&&n&&t.notification.user.id!==a.id&&"doc"===s&&l.id===t.notification.file_id;c&&o(t.notification.file.name,t.notification.user.name+" "+(0,u.washHTML)((0,u.markMentionText)(t.notification.msg)),{icon:t.notification.user.avatar})}function o(e,t,n,r){var i=window.Notification;if(void 0===i)return!1;var o=function(){var o=new i(e,a({body:t},n));o.onclick=r,setTimeout(function(){return o.close()},6e3)};"granted"===i.permission?o():i.requestPermission().then(function(e){return"granted"===e&&o()})}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=n(184),l=r(s),u=n(1225);t.default=function(){l.default.bind("Notification_v2",i)},e.exports=t.default},1225:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){c.hasOwnProperty(e)||u.default.bind(e,p(e)),c[e]=t}function o(e){c[e]=null}function a(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText.trim()}function s(e){return e.replace(/(<a\s+)/g,"@$1")}Object.defineProperty(t,"__esModule",{value:!0}),t.subscribePush=i,t.unsubscribePush=o,t.washHTML=a,t.markMentionText=s;var l=n(184),u=r(l),c={},p=function(e){return function(t){return c[e]&&c[e].call(null,t)}}},1226:function(e,t,n){(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},u=n(7),c=i(u),p=n(1033),d=i(p),f=n(334),h=n(1220),m=(i(h),function(e){function t(e){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={visible:!1,text:"",link:"",recordTag:"",openNewTab:!0},this.onCloseClick=this.onCloseClick.bind(this)}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{currentUser:u.PropTypes.object}}}]),s(t,[{key:"componentDidMount",value:function(){this.initStatus()}},{key:"onCloseClick",value:function(){this.setState({visible:!1}),this.state.recordTag&&("special"===this.state.recordTag&&["renewal","expiration"].indexOf(d.default.accountTypeStatus)>-1?d.default.removeMembershipTip():d.default.removeTipAjax(this.state.recordTag))}},{key:"filterNotification",value:function(e){var t=this;return f.notifications.length?r.maxBy(f.notifications.filter(function(n){if(!n.enable)return!1;if(n.startDate||n.endDate){var r=new Date(n.startDate),i=new Date(n.endDate),o=new Date;if(o<r||o>i)return!1}if(n.recordTag&&e&&e[n.recordTag])return!1;if(n.targetUser){var a=n.targetUser,s=t.props.currentUser;if("undefined"!=typeof a.isEnterpriseOfficial){if(a.isEnterpriseOfficial&&(s.accountType.indexOf("enterprise")===-1||!s.isOfficial))return!1;if(!a.isEnterpriseOfficial&&s.accountType.indexOf("enterprise")>-1&&s.isOfficial)return!1}}return!0}),"order"):null}},{key:"initStatus",value:function(){var e=this,t=this.props.currentUser;"enterprise_dingtalk"!==t.accountType&&d.default.needToGuide()&&d.default.checkIsReady().then(function(n){var r=e.filterNotification(n);return r?void e.setState({text:r.text,recordTag:r.recordTag,link:r.targetLink,openNewTab:r.openNewTab,visible:!0}):void d.default.getMembershipInfo().then(function(){var r=t.accountType;if(t.accountTypeExpiredAt){var i=new Date(t.accountTypeExpiredAt),o=new Date;if(i<o)d.default.shouldNotifyExpiration&&(d.default.accountTypeStatus="expiration","enterprise_expired"!==r&&e.setState({text:"石墨个人高级版已到期，点此升级",link:"/payment",visible:!0,openNewTab:!0,recordTag:"special"}));else{var a=Math.ceil((i-o)/864e5);a<=10&&d.default.shouldNotifyRenewal&&(d.default.accountTypeStatus="renewal","personal_premium"===t.accountType&&e.setState({text:"石墨个人高级版剩余"+a+"天，点此续费",link:"/payment",visible:!0,openNewTab:!0,recordTag:"special"}))}}else n.upgrade_pro?e.setState({visible:!1}):"personal_free"!==t.accountType?(e.setState({visible:!1}),d.default.removeTipAjax("upgrade_pro")):e.setState({text:"升级石墨账号",link:"/payment",visible:!0,openNewTab:!0,recordTag:"upgrade_pro"})})})}},{key:"render",value:function(){var e=this.state,t=e.visible,n=e.text,r=e.link,i=e.openNewTab;return t?c.default.createElement("div",{className:"header-notification-wrap"},c.default.createElement("a",{className:"header-notification-link",href:r,target:i?"_blank":""},n),c.default.createElement("span",{className:"team-sprite header-item-icon header-notification-close",onClick:this.onCloseClick})):null}}]),t}(u.Component));t.default=m,e.exports=t.default}).call(t,n(4))},1227:function(e,t,n){(function(r,i){function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},c=n(7),p=o(c),d=n(1228),f=o(d),h=n(1230),m=o(h),v=n(266),y=o(v),g=n(175),b=o(g),w=n(665),k=o(w),T=function(e){function t(e){a(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state=t.initState,this.handleSearchEntryClick=this.handleSearchEntryClick.bind(this),this.handleSearchInputKeydown=this.handleSearchInputKeydown.bind(this),this.handleSearchInputKeyup=r.debounce(this.handleSearchInputKeyup.bind(this),300),this.handleResultItemHovered=this.handleResultItemHovered.bind(this),this.handleResultItemClick=this.handleResultItemClick.bind(this),this.handleSearchInputChange=this.handleSearchInputChange.bind(this),this.handleScrollEnd=this.handleScrollEnd.bind(this),this.handleClearClick=this.handleClearClick.bind(this),this.componentClick=this.componentClick.bind(this),this.search=this.search.bind(this)}return s(t,e),l(t,null,[{key:"initState",get:function(){return{active:!1,results:[],page:0,keyword:"",lastKeyword:"",pageCount:0,selectedIndex:-1,count:0,dropdownVisible:!1}}}]),l(t,[{key:"componentClick",value:function(){this.clearAndReset()}},{key:"clearAndReset",value:function(e){this.setState(t.initState,function(){"function"==typeof e&&e()})}},{key:"handleSearchEntryClick",value:function(){var e=this;this.setState({active:!0},function(){setTimeout(function(){e.refs.searchInput.focus()},200)})}},{key:"handleSearchInputChange",value:function(e){this.setState({keyword:e.target.value})}},{key:"scrollToFixedPosition",value:function(e,t){var n=document.getElementsByClassName("search-result-item")[t];if(n){var r=n.getBoundingClientRect();if(e&&r.top<=100||!e&&r.top>=390){var i=document.getElementsByClassName("search-result-list")[0];i&&i&&(i.scrollTop=i.scrollTop+200*(e?-1:1))}}}},{key:"handleSearchInputKeydown",value:function(e){var t=this,n=e.keyCode,r=b.default.keyCodes,o=this.state,a=o.results,s=o.selectedIndex;if(n===r.UP)s>0&&this.setState({selectedIndex:this.state.selectedIndex-1}),this.scrollToFixedPosition(!0,this.state.selectedIndex);else if(n===r.DOWN)s<a.length-1&&this.setState({selectedIndex:s+1}),this.scrollToFixedPosition(!1,this.state.selectedIndex);else if(n===r.ENTER){var l=a[s];l&&!function(){var e=l.source,n=e.type,r=e.guid,o="/"+(1===n?"folder":0===n?"doc":"spreadsheet")+"/"+r;t.clearAndReset(function(){i(o)})}()}[r.UP,r.DOWN,r.ENTER].indexOf(n)>-1&&(e.preventDefault(),e.stopPropagation())}},{key:"handleSearchInputKeyup",value:function(e){var t=this;if(!([b.default.keyCodes.UP,b.default.keyCodes.DOWN,b.default.keyCodes.ENTER].indexOf(e.keyCode)>-1)){var n=e.target.value.trim();n&&n!==this.state.lastKeyword?this.setState({lastKeyword:n,isLoading:!0,dropdownVisible:!0,page:0,count:0,pageCount:0},function(){t.search(n)}):n||n===this.state.lastKeyword||this.setState({lastKeyword:"",isLoading:!1,dropdownVisible:!1})}}},{key:"handleResultItemHovered",value:function(e){this.state.selectedIndex!==e&&this.setState({selectedIndex:e})}},{key:"handleResultItemClick",value:function(){this.clearAndReset()}},{key:"handleClearClick",value:function(){var e=this;this.setState(r.assign({},t.initState,{active:!0}),function(){e.refs.searchInput.focus()})}},{key:"search",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?10:arguments[2];y.default.searchFile(e,n,r).then(function(e){var n=e.page,r=e.pageCount,i=e.count,o=!1,a=e.results;n>0&&(a=t.state.results.concat(a)),t.setState({page:n,results:a,pageCount:r,count:i,isLoading:o})},function(){t.setState({results:[]})})}},{key:"searchNextPage",value:function(){var e=this,t=this.state,n=t.keyword,r=t.page,i=t.pageCount,o=t.isLoading;!o&&r+1<i&&this.setState({isLoading:!0},function(){setTimeout(function(){e.search(n,r+1)},1e3)})}},{key:"handleScrollEnd",value:function(){this.searchNextPage()}},{key:"renderEntryWithAnimation",value:function(){var e={verticalAlign:"middle"},t=this.state.active?[p.default.createElement("div",{key:0,className:"search-input-wrap"},p.default.createElement("span",{className:"search-input-icon"}),p.default.createElement("input",{ref:"searchInput",type:"text",placeholder:"输入文件名、文件内容搜索",className:"form-control header-search-input",value:this.state.keyword,onChange:this.handleSearchInputChange,onKeyDown:this.handleSearchInputKeydown,onKeyUp:this.handleSearchInputKeyup}),this.state.keyword?p.default.createElement("a",{className:"search-clear-icon",onClick:this.handleClearClick,href:"javascript:void(0);"}):null)]:[p.default.createElement("a",{key:1,className:"file-search-entry",onClick:this.handleSearchEntryClick,href:"javascript:void(0);"},p.default.createElement("span",{style:e,className:"header-search-icon"}),p.default.createElement("span",{style:e},"搜索"))],n=!0;return p.default.createElement(m.default,{transitionName:"file-search",transitionAppearTimeout:100,transitionEnterTimeout:120,transitionLeaveTimeout:100,transitionAppear:n},t)}},{key:"render",value:function(){var e=this.state.selectedIndex;return p.default.createElement("div",{className:"header-search-wrap"},this.renderEntryWithAnimation(),p.default.createElement(f.default,{selectedIndex:e,onScrollEnd:this.handleScrollEnd,isLoading:this.state.isLoading,visible:this.state.dropdownVisible,onItemHovered:this.handleResultItemHovered,onItemClick:this.handleResultItemClick,results:this.state.results}))}}]),t}(c.Component);t.default=(0,k.default)(T),e.exports=t.default}).call(t,n(4),n(176))},1228:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=n(1229),p=r(c),d=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.onScroll=this.onScroll.bind(this)}return o(t,e),a(t,null,[{key:"propTypes",get:function(){return{results:l.PropTypes.array,visible:l.PropTypes.bool,isLoading:l.PropTypes.bool,selectedIndex:l.PropTypes.number,onItemHovered:l.PropTypes.func,onItemClick:l.PropTypes.func,onScrollEnd:l.PropTypes.func}}}]),a(t,[{key:"onScroll",value:function(e){var t=this.props,n=t.isLoading,r=t.onScrollEnd,i=this.refs.resultList,o=i.scrollHeight-i.scrollTop-i.clientHeight;!n&&o<=0&&"function"==typeof r&&r(),e.stopPropagation(),e.preventDefault()}},{key:"renderResultItems",value:function(){var e=this.props,t=e.results,n=e.selectedIndex,r=e.onItemHovered,i=e.onItemClick;return t.map(function(e,t){var o=n===t;return u.default.createElement(p.default,{isSelected:o,onMouseOver:r,onClick:i,key:t,index:t,data:e})})}},{key:"render",value:function(){var e=this.props,t=e.results,n=e.visible,r=e.isLoading;return n?!r&&t&&0===t.length?u.default.createElement("div",{className:"search-result-wrap"},u.default.createElement("div",{className:"search-no-result"},u.default.createElement("span",null,"无搜索结果"))):u.default.createElement("div",{className:"search-result-wrap"},u.default.createElement("ul",{className:"scrollable search-result-list",ref:"resultList",onScroll:this.onScroll,style:{maxHeight:"437px"}},this.renderResultItems(),r?u.default.createElement("div",{className:"search-loading"},u.default.createElement("div",{className:"spinner"})):null)):null}}]),t}(l.Component);t.default=d,e.exports=t.default},1229:function(e,t,n){(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},u=n(7),c=i(u),p=n(175),d=n(285),f=i(d),h=n(194),m=i(h),v=n(267),y=function(e){function t(e){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.onMouseOver=this.onMouseOver.bind(this),this.onClick=this.onClick.bind(this)}return a(t,e),s(t,null,[{key:"propTypes",get:function(){return{data:u.PropTypes.object,onMouseOver:u.PropTypes.func,index:u.PropTypes.number,isSelected:u.PropTypes.bool,onClick:u.PropTypes.func}}}]),s(t,[{key:"onMouseOver",value:function e(){var e=this.props.onMouseOver;"function"==typeof e&&e(this.props.index)}},{key:"onClick",value:function e(){var t=this.props,n=t.data,e=t.onClick,i=n.source,o=i.type,a=i.guid,s="/"+v.FILE_TYPE_MAP[o]+"/"+a;"function"==typeof e&&e(),r(s)}},{key:"getName",value:function(){var e=this.props.data.source.name,t=this.props.data.highlight.name,n="";return t&&t[0]?n=t[0]:e&&e[0]&&(n=e[0]),(0,m.default)(n)}},{key:"getInnerContent",value:function(){var e=this.props.data,t=e.source.type,n=e.highlight.content,r="";t===-1||t===-3?r="<i>表格</i>":0===t&&(r=n&&n[0]?n[0]:"<i>空</i>");try{r=(0,m.default)(decodeURI(r))}catch(e){r=(0,m.default)(r)}return r}},{key:"render",value:function(){var e=this.props,t=e.isSelected,n=e.data,r=n.source,i=r.updated_at,o=r.starred,a=r.type,s=v.FILE_TYPE_MAP[a],l=this.getName(),u=(0,f.default)({"search-result-item":!0,active:t,folder:1===a,file:1!==a});if(!l)return null;var d=this.getInnerContent(),h=p.DateTime.format(i);return c.default.createElement("li",{className:u,onClick:this.onClick,onMouseOver:this.onMouseOver},c.default.createElement("div",{className:"search-result-info"},c.default.createElement("span",{className:"search-list-icon "+s}),c.default.createElement("span",{className:"search-result-title",dangerouslySetInnerHTML:{__html:l}}),c.default.createElement("span",{className:"search-result-time"},h),o?c.default.createElement("span",{className:"search-star-icon"}):null),1!==a?c.default.createElement("div",{className:"search-result-content"},c.default.createElement("span",{className:"search-result-content-text",dangerouslySetInnerHTML:{__html:d}})):null)}}]),t}(u.Component);t.default=y,e.exports=t.default}).call(t,n(176))},1230:function(e,t,n){e.exports=n(396)},1231:function(e,t,n){(function(r,i){function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},c=n(7),p=o(c),d=n(1178),f=o(d),h=n(1232),m=o(h),v=n(1233),y=o(v),g=n(1234),b=o(g),w=n(184),k=o(w),T=n(166),C=o(T),O=n(285),E=o(O),P=n(175),x=o(P),_=n(266),S=n(1220),N=o(S),j=function(e){function t(e){a(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={tableTitle:e.currentFile.name,userId:e.currentUser.id,shareStatus:cow.shareStatus.mode,starred:e.currentFile.starred,guideTipVisible:!1},this.onStarBtnClick=this.onStarBtnClick.bind(this),this.handleGuideTipVisibleChange=this.handleGuideTipVisibleChange.bind(this)}return s(t,e),l(t,null,[{key:"propTypes",get:function(){return{currentFile:c.PropTypes.object,currentUser:c.PropTypes.object}}}]),l(t,[{key:"componentDidMount",value:function(){this.isUnmount=!1,this._init()}},{key:"componentWillUnmount",value:function(){this.isUnmount=!0,C.default.detach("guideTip:visible:desktop",this.handleGuideTipVisibleChange)}},{key:"handleGuideTipVisibleChange",value:function(e){var t=(Object.assign||r.assign).call(null,{},this.state);t.guideTipVisible=e,!this.state.guideTipVisible&&e&&(t.positionNodeElement=document.getElementsByClassName("header-back-up")[0]),this.setState(t)}},{key:"_onTitleChange",value:function(){}},{key:"_onTitleBlur",value:function(){var e=this.refs.tableName.getValue();e!==this.state.tableTitle&&(0,_.updateTitle)(e)}},{key:"_init",value:function(){var e=this;this._initPush();var t=(0,_.checkIsWelcomeFile)();t&&(0,_.starFile)(window.cow.currentFile.id).then(function(){e.setState({starred:!0})})}},{key:"_initPush",value:function(){var e=this;k.default.bind("File",function(t){if(!e.isUnmount){var n=e.props,r=n.currentFile,i=n.currentUser;if(!(["spreadsheet","sheet","doc","newdoc"].indexOf(window.cow.pageType)<0)&&"update"===t.db_event&&+t.data.id===+r.id)if(0===+t.data.is_delete){var o=t.data.name;C.default.notify("file:updateTitle",o)}else 1===+t.data.is_delete&&+t.data.deleted_by!==+i.id&&e._backParent()}}),k.default.bind("StarredFile",function(t){if(!e.isUnmount){var n=e.props.currentFile;if(t.data.fileId===n.id){var r="create"===t.action;n.starred=r,e.setState({starred:r})}}}),C.default.detach("file:updateTitle",this._updateTitle),C.default.attach("file:updateTitle",this._updateTitle,{scope:this}),C.default.detach("guideTip:visible:desktop",this.handleGuideTipVisibleChange),C.default.attach("guideTip:visible:desktop",this.handleGuideTipVisibleChange)}},{key:"_updateTitle",value:function(e){this.setState({tableTitle:e}),this.props.currentFile.name=e,this.refs.tableName&&(document.title=e,this.refs.tableName.setValue(e))}},{key:"_backParent",value:function(){var e=(0,_.checkIsWelcomeFile)();e&&this.setState({
guideTipVisible:!1});var t=void 0,n=void 0;i.len>0?i.back():(t=this.props.currentFile,n=window.cow.authorized?t.parent&&t.parent.guid?"/folder/"+t.parent.guid:"/desktop":"/login",i(n))}},{key:"onStarBtnClick",value:function(){var e=this,t=this.props.currentFile.id;this.state.starred?(0,_.unstarFile)(t).then(function(){e.setState({starred:!1})},function(e){x.default.alert({title:e.message,type:"error"})}):(0,_.starFile)(t).then(function(){e.setState({starred:!0})},function(e){x.default.alert({title:e.message,type:"error"})})}},{key:"render",value:function(){var e=this,t=this.props.currentFile,n=[0,-1,-2,-3],r=t.type;if(n.indexOf(r)>-1){var i=(0,E.default)({"header-star-btn":!0,"s-header-star-btn":!0,active:this.state.starred}),o=(0,E.default)({"team-icon-sheet":r===-1||r===-3,"team-icon-doc":0===r||r===-2}),a=p.default.createElement("a",{className:i,onClick:this.onStarBtnClick},p.default.createElement("span",{className:"team-sprite team-icon-star mark-star-icon"}),p.default.createElement("span",{className:"s-tooltip"},this.state.starred?"取消标星":"标星")),s=!0;if(this.state.userId>0)return p.default.createElement("div",{className:"s-header"},p.default.createElement("a",{className:"header-back-up",onClick:function(t){return e._backParent(t)}},p.default.createElement("span",{className:"header-back-icon"})),p.default.createElement("span",{className:"header-crumb-arrow little-icon-sprite"}),p.default.createElement("span",{className:"left-sheet-img team-sprite "+o}),p.default.createElement("span",{className:"s-header-text"},p.default.createElement(m.default,{customClass:"title-input",defaultValue:this.state.tableTitle?this.state.tableTitle:"无标题",placeholder:"无标题",maxWidth:"240px",autoWidth:s,onBlur:function(t){return e._onTitleBlur(t)},onChange:function(t){return e._onTitleChange(t)},tooltip:"重命名",ref:"tableName"})),this.props.currentFile.authorized?p.default.createElement(b.default,{guid:this.props.currentFile.guid}):null,a,p.default.createElement(N.default,{text:"返回桌面",placement:"right",offsetLeft:12,offsetTop:12,visible:this.state.guideTipVisible,positionNodeElement:this.state.positionNodeElement}),p.default.createElement(y.default,{customClassName:"s-header-time"}));var l=t.team,u=void 0;if(l&&l.resources&&(u=p.default.createElement(f.default,{className:"header-logo-img",src:[l.resources.desktopLogo+"!1x",l.resources.desktopLogo]})),0===r)return p.default.createElement("div",{className:"s-header"},p.default.createElement("a",{href:"/",className:"home-link doc-logo "+(u?"":"logo-22")},u),p.default.createElement(y.default,{customClassName:"s-header-time"}));if(r===-1)return p.default.createElement("div",{className:"s-header"},p.default.createElement("div",{className:"s-home-link-wrap"},p.default.createElement("a",{className:"s-home-link",href:"/"},u)),p.default.createElement("span",{className:"sheet-img-not-loggin left-sheet-img team-sprite team-icon-sheet"}),p.default.createElement("div",{className:"s-title"},window.cow.tempCurrentFile.name),p.default.createElement(y.default,{customClassName:"writeable-sheet-status-bar s-header-time"}))}return p.default.createElement("a",{className:"header-logo logo-22",href:"/desktop"})}}]),t}(c.Component);t.default=j,e.exports=t.default}).call(t,n(4),n(176))},1232:function(e,t,n){var r=n(7),i=n(166);e.exports=r.createClass({displayName:"exports",propTypes:{customClass:r.PropTypes.string,placeholder:r.PropTypes.string,defaultValue:r.PropTypes.string,autoWidth:r.PropTypes.bool,tooltip:r.PropTypes.string},getInitialState:function(){return{inputWidth:this._getInputMinWidth(),value:this.props.defaultValue,inputValue:this.props.defaultValue,showTooltip:!1,focused:!1}},componentDidMount:function(){this._copyInputStyles(),this._updateInputWidth()},shouldComponentUpdate:function(e,t){return t!=this.state},componentDidUpdate:function(){this._updateInputWidth()},render:function(){var e=this.props,t={};this.state.inputWidth&&(t.width=this.state.inputWidth+"px");var n=this.state.showTooltip&&!this.state.focused?" active":"";return r.createElement("div",{className:"span-input-wrap"},r.createElement("input",{className:e.customClass+" span-input",placeholder:e.placeholder||"输入",defaultValue:e.defaultValue||"石墨表格",onChange:this._onChange,onBlur:this._onBlur,onFocus:this._onFocus,onKeyUp:this._onKeyUp,onKeyDown:this._onKeyDown,onMouseOver:this._onMouseOver,onMouseOut:this._onMouseOut,value:this.state.inputValue,style:t,maxLength:100,ref:"input"}),r.createElement("span",{ref:"input-pre",className:e.customClass+"-pre span-input-pre"},this.state.value),r.createElement("span",{className:"tooltip span-input-tooltip s-tooltip"+n},this.props.tooltip))},getValue:function(){return this.state.inputValue},setValue:function(e){this.setState({value:e,inputValue:e}),this._updateInputWidth()},_copyInputStyles:function(){if(this.isMounted()&&window.getComputedStyle){var e=window.getComputedStyle(this.refs.input),t=this.refs["input-pre"];t.style.fontSize=e.fontSize,t.style.fontFamily=e.fontFamily,t.style.fontWeight=e.fontWeight,t.style.fontStyle=e.fontStyle,t.style.letterSpacing=e.letterSpacing}},_updateInputWidth:function(){if(""===this.state.value&&this.props.placeholder)return void this.setState({value:this.props.placeholder});if(this.props.autoWidth&&this.isMounted()&&"undefined"!=typeof this.refs["input-pre"].scrollWidth){var e=this.refs["input-pre"].scrollWidth+4,t=this._getInputMinWidth(),n=this._getInputMaxWidth();e<t?e=t:e>n&&(e=n),e!==this.state.inputWidth&&this.setState({inputWidth:e})}},_getInputMinWidth:function(){var e=parseInt(this.props.minWidth);return e=isNaN(e)?0:e},_getInputMaxWidth:function(){var e=parseInt(this.props.maxWidth);return e=isNaN(e)?9999999:e},_onChange:function(e){this.setState({value:e.target.value,inputValue:e.target.value}),this._updateInputWidth(),this.props.onChange&&this.props.onChange()},_onBlur:function(e){""==this.state.inputValue&&this.props.placeholder?this.setState({inputValue:this.props.placeholder},function(){this.props.onBlur&&this.props.onBlur()}):this.props.onBlur&&this.props.onBlur(),this.setState({focused:!1}),window.cow.iOS&&i.notify("sheetTitleStatus",{status:"blur"})},_onFocus:function(e){var t=e.target.value;"无标题"===t&&this.setState({inputValue:""}),this.setState({focused:!0}),window.cow.iOS&&i.notify("sheetTitleStatus",{status:"focus"})},_onKeyUp:function(e){13==e.keyCode&&e.target.blur()},_onKeyDown:function(e){if((90===e.keyCode||89===e.keyCode)&&e.ctrlKey)return e.stopPropagation(),e.preventDefault(),!1},_onMouseOver:function(e){this.props.tooltip&&!this.state.showTooltip&&this.setState({showTooltip:!0})},_onMouseOut:function(e){this.props.tooltip&&this.state.showTooltip&&this.setState({showTooltip:!1})}})},1233:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=n(175),p=r(c),d=n(166),f=r(d),h=n(190),m=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);var n=window.cow.currentFile.updated_at||new Date,r=p.default.DateTime.format(n)+"更新";"刚刚更新"===r&&(r=(0,h.isDoc)(window.cow.pageType)?window.cow.currentFile.typeName+"将实时更新":window.cow.currentFile.typeName+"将实时更新"),this.state={displayText:r,lastUpdateTime:n,timerId:-1}}return o(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;f.default.attachOne("saveStatus:start",function(){return e._startSave()}),f.default.attachOne("saveStatus:success",function(){return e._saveSuccess()}),f.default.attachOne("saveStatus:error",function(){return e._saveError()}),f.default.attachOne("saveStatus:getUpdate",function(){return e._getUpdateFromServer()}),f.default.attachOne("saveStatus:offline",function(){return e._saveOffline()}),f.default.attachOne("saveStatus:uninit",function(){return e._saveUninit()}),f.default.attach("doc:goback",function(){return e._destroyTimerTick()}),f.default.attach("spreadsheet:exit",function(){return e._destroyTimerTick()}),this._tellClient(),this._createTimerTick()}},{key:"_startSave",value:function(){this._destroyTimerTick(),this.setState({displayText:"正在保存..."},this._tellClient)}},{key:"_saveSuccess",value:function(){var e=this;setTimeout(function(){e.setState({displayText:"保存成功",lastUpdateTime:(new Date).toString()},e._tellClient),e._createTimerTick()},500)}},{key:"_saveError",value:function(){this.setState({displayText:"保存失败"},this._tellClient)}},{key:"_saveOffline",value:function(){this.setState({displayText:"已离线保存"},this._tellClient)}},{key:"_saveUninit",value:function(){this.setState({displayText:"初始化中"},this._tellClient)}},{key:"_getUpdateFromServer",value:function(){this.setState({displayText:window.cow.currentFile.typeName+"将实时更新",lastUpdateTime:(new Date).toString()},this._tellClient),this._destroyTimerTick(),this._createTimerTick()}},{key:"_createTimerTick",value:function(){var e=this,t=setInterval(function(){var t=p.default.DateTime.format(e.state.lastUpdateTime)+"更新";"刚刚更新"===t&&(t=window.cow.currentFile.typeName+"将实时更新"),e.setState({displayText:t},e._tellClient)},18e5);e.setState({timerId:t})}},{key:"_destroyTimerTick",value:function(){clearInterval(this.state.timerId)}},{key:"_tellClient",value:function(){if(window.cow.iOS||window.cow.client){var e=this.state.displayText;f.default.notify("updateSaveStatus",{message:e})}}},{key:"render",value:function(){var e;return"保存失败"===this.state.displayText&&(e={color:"#ee7b70"}),u.default.createElement("span",{className:this.props.customClassName,style:e,id:"save-status"},this.state.displayText)}}]),t}(l.Component);t.default=m,m.propTypes={customClassName:u.default.PropTypes.string},e.exports=t.default},1234:function(e,t,n){(function(r){function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},u=n(7),c=i(u),p=(n(231),n(177)),d=n(186),f=n(266),h=function(e){function t(e){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={isLoading:!0,ancestors:[],active:!1}}return a(t,e),s(t,[{key:"componentDidMount",value:function(){this._getAncestors(),this.handleOtherClick=this._otherClick.bind(this),(0,d.on)(document.getElementsByTagName("html")[0],"click",this.handleOtherClick)}},{key:"componentWillUnmount",value:function(){(0,d.off)(document.getElementsByTagName("html")[0],"click",this.handleOtherClick)}},{key:"_otherClick",value:function(e){"undefined"!=typeof this.state.active&&this.state.active&&(e.target.className.match(/crumb-dropdown-btn/)||this.setState({active:!1}))}},{key:"_renderCrumbList",value:function(e){var t=this,n=[];if(this.state.isLoading)return c.default.createElement("div",{className:"crumb-loading"},c.default.createElement("img",{className:"crumb-loading-img",src:"https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif"}));var r=[22,20,18,16];return e.forEach(function(e,i){var o=i>3?3:i,a=(0,p.cutLength)(e.name,r[o]),s=a===e.name?"":e.name;n.push(c.default.createElement("li",{key:i,className:"crumb-list-item",title:s,"data-href":e.link,"data-type":e.type,onClick:t._onCrumbListClick.bind(t)},c.default.createElement("a",{className:"crumb-list-link crumb-list-indent"+o,href:"javascript:void(0);"},c.default.createElement("span",{className:"little-icon-sprite crumb-list-icon crumb-"+e.type+"-icon"}),c.default.createElement("span",{className:"crumb-item-name"},a))))}),n}},{key:"_onCrumbListClick",value:function(e){var t=e.currentTarget,n=t.getAttribute("data-href");n&&r(n)}},{key:"_toggleDropdown",value:function(){this.setState({active:!this.state.active})}},{key:"_getAncestors",value:function(){var e=this,t=this.props.guid;this.setState({isLoading:!0}),(0,f.getAncestors)(t).then(function(t){e.setState({isLoading:!1,ancestors:t})})}},{key:"render",value:function(){var e=this.state.ancestors||[],t=this.state.active?"active":"";return c.default.createElement("div",{className:"crumb-wrap"},c.default.createElement("a",{className:"crumb-dropdown-btn little-icon-sprite",onClick:this._toggleDropdown.bind(this)}),c.default.createElement("ul",{className:"crumb-dropdown-wrap "+t},this._renderCrumbList(e)))}}]),t}(u.Component);t.default=h,h.propTypes={guid:u.PropTypes.string},e.exports=t.default}).call(t,n(176))},1235:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=n(1230),p=r(c),d=n(166),f=r(d),h=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={cooperators:[]}}return o(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;f.default.detach("cooperation:updateAvatar"),f.default.attach("cooperation:updateAvatar",function(t){e.setState({cooperators:[].concat(t)})})}},{key:"renderAvatars",value:function(){var e=this.state.cooperators,t=[];return e.forEach(function(e,n){var r={zIndex:110-n-1,right:28*(n+1)+"px"};t.push(u.default.createElement("div",{key:e.id,className:"header-avatar",style:r},u.default.createElement("div",{className:"avatar-wrap"},u.default.createElement("img",{src:e.avatar,alt:e.name})),u.default.createElement("span",{className:"header-avatar-color",style:{backgroundColor:e.color}}),u.default.createElement("span",{className:"tooltip header-avatar-tooltip s-tooltip"},e.name)))}),t}},{key:"render",value:function(){var e=!0;return u.default.createElement("div",{className:"header-avatar-wrap"},u.default.createElement(p.default,{transitionName:"header-avatar",transitionAppearTimeout:100,transitionEnterTimeout:1e3,transitionLeaveTimeout:300,transitionAppear:e},this.renderAvatars()))}}]),t}(l.Component);t.default=h,e.exports=t.default},1236:function(e,t,n){(function(e,r,i){function o(e){return e&&e.__esModule?e:{default:e}}function a(){if("enterprise_expired"===O.accountType){var e=new Date,t=new Date(e.getFullYear(),0,0),n=e-t,r=864e5,i=Math.floor(n/r),o=d.default.get("lastSeen")||0;if(i>o){var a="";a=["creator","admin"].indexOf(O.team_role)?'<div>石墨文档企业版已到期。目前无法新建／导入文档、添加企业成员，但已有文档仍可以正常编辑与共享。</div><br><div>您可以购买或续费企业版服务，也可以删除企业退回到个人版（不会影响任何文档和共享关系）。</div><br><div>致电 400-180-0506 获取购买与折扣信息，或前往 <a href="/enterprise/billing" target="_blank" style="color: #4A90E2; text-decoration: underline;">企业管理</a> 页面。</div>':"<div>石墨文档企业版已到期。目前无法新建／导入文档、添加企业成员，但已有文档仍可以正常编辑与共享。</div><br><div>请尽快提醒管理员购买或续费企业版服务，或者删除企业退回到个人版（不会影响任何文档和共享关系）。</div><br><div>致电 400-180-0506 获取购买与折扣信息。</div>";var s={title:"试用到期提醒",description:a,buttons:[{type:"button",buttonLabel:"知道了",customClass:"btn btn-ok",closeAfterClick:!0}]};(0,c.default)(s),d.default.set("lastSeen",i,{expires:7})}}}function s(){h.default.needToGuide()&&C&&C.survey&&(C.survey=null,(0,c.default)({customClass:"paid-survey-modal",buttons:[],title:"",description:'<span id="survey-letter"></span><span id="survey-computer"></span><div>石墨文档 @ 你：</div><br><div>感谢您参与本次用户调研，我们已将「石墨文档高级版」<b>2 个月免费</b> 使用机会冲入您的账户。如未收到，请联系我们的客服人员。</div><div>我们还要偷偷告诉您：「石墨文档企业版」即将上线，如您的团队有需求，请联系邮箱<a href="mailto:wangxi@shimo.im">wangxi@shimo.im</a> , 我们同样会奉上 <b>专属折扣</b>。</div>'}))}function l(){v.default.bind("File",function(t){var n=t.data;C.readonly&&e("#doc-title-input").html((0,g.default)(n.name));var i=C.currentFile&&C.currentFile.id;n.id===i&&n.is_delete>=1&&r("/desktop")}),v.default.bind("Permission",function(e){var t=e.data;if("destroy"===e.db_event){var n=C.currentFile&&C.currentFile.guid;t.guid===n&&T.default.goBack(C.currentFile)}}),v.default.bind("Contact",function(e){i.isArray(e.data)||(e.data=[e.data]),e.data.forEach(function(e){w.default.push(e)})}),v.default.bind("Unsubscribe",function(e){var t=e.data;"desktop"===t.channel&&(C.desktopNotification=t.is_delete)})}Object.defineProperty(t,"__esModule",{value:!0}),t.checkEnterpriseExpired=a,t.targetedPaidUsersSurvey=s,t.hookSocket=l;var u=n(167),c=o(u),p=n(189),d=o(p),f=n(1033),h=o(f),m=n(184),v=o(m),y=n(194),g=o(y),b=n(191),w=o(b),k=n(175),T=o(k),C=window.cow,O=C.currentUser;t.default=function(){a(),s(),l()}}).call(t,n(1),n(176),n(4))},1237:function(e,t,n){(function(r,i){function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},c=n(7),p=o(c),d=n(1220),f=o(d),h=n(185),m=n(186),v=n(266),y=[{fileName:"示例 - 待办事项",targetElementSelector:'.editbar-list-item[data-key="checklist"]',offsetTop:3,offsetLeft:-7,needExpand:!1,expandElementSelector:"",text:"点这里，添加任务列表",autoHide:!1,hideTriggerElementSelectror:'.editbar-list-item[data-key="checklist"]'},{fileName:"示例 - 会议记录",targetElementSelector:"#upload-attachment",offsetTop:-7,offsetLeft:0,needExpand:!0,expandElementSelector:"#doc-insert",text:"点这里，插入附件",autoHide:!0,hideTriggerElementSelectror:""}],g=function(e){function t(){a(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.state={guideTipVisible:!1,text:"",positionNodeElement:null},this.hideGuideTip=this.hideGuideTip.bind(this),this.handlePadReady=this.handlePadReady.bind(this)}return s(t,e),l(t,[{key:"componentDidMount",value:function(){r(window).off("pad_ready",this.handlePadReady),r(window).on("pad_ready",this.handlePadReady)}},{key:"componentWillUpdate",value:function(e,t){var n=this.state;n.hideTriggerElementSelectror&&!t.hideTriggerElementSelectror?this.bindTriggerEvent(t):!n.hideTriggerElementSelectror&&t.hideTriggerElementSelectror?this.unbindTriggerEvent(n):n.hideTriggerElementSelectror!==t.hideTriggerElementSelectror&&(this.unbindTriggerEvent(n),this.bindTriggerEvent(t))}},{key:"componentWillUnmount",value:function(){r(window).off("pad_ready",this.handlePadReady),this.unbindTriggerEvent(this.state)}},{key:"bindTriggerEvent",value:function(e){if(e||(e=this.state),e.hideTriggerElementSelectror){var t=(0,h.qsa)(e.hideTriggerElementSelectror);t.length&&(0,m.on)(t[0],"click",this.hideGuideTip)}}},{key:"unbindTriggerEvent",value:function(e){if(e||(e=this.state),e.hideTriggerElementSelectror){var t=(0,h.qsa)(e.hideTriggerElementSelectror);t.length&&(0,m.off)(t[0],"click",this.hideGuideTip)}}},{key:"getGuideConfig",value:function(){return(0,v.checkIsExampleFile)()&&y.length?i.find(y,{fileName:window.cow.currentFile.name}):null}},{key:"handlePadReady",value:function(){var e=this;setTimeout(function(){var t=e.getGuideConfig();if(t){if(t.needExpand&&t.expandElementSelector){var n=(0,h.qsa)(t.expandElementSelector);n.length&&n[0].click()}if(t.targetElementSelector){var r=(0,h.qsa)(t.targetElementSelector);r.length&&e.setState({guideTipVisible:!0,positionNodeElement:r[0],text:t.text,hideTriggerElementSelectror:t.hideTriggerElementSelectror,autoHide:!!t.autoHide,offsetTop:i.isNumber(t.offsetTop)?t.offsetTop:0,offsetLeft:i.isNumber(t.offsetLeft)?t.offsetLeft:0},function(){e.bindTriggerEvent(e.state)})}}},2e3)}},{key:"hideGuideTip",value:function(){this.setState({guideTipVisible:!1})}},{key:"render",value:function(){var e=this.state,t=e.offsetLeft,n=e.offsetTop,r=e.autoHide,i=e.guideTipVisible,o=e.positionNodeElement,a=e.text;return p.default.createElement(f.default,{text:a,placement:"left",autoHide:r,offsetLeft:t,offsetTop:n,visible:i,onNeedHide:this.hideGuideTip,positionNodeElement:o})}}]),t}(c.Component);t.default=g,e.exports=t.default}).call(t,n(1),n(4))},1238:function(e,t,n){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var i=e,o=t,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(i);if(null===u)return;e=u,t=o,n=a,r=!0,s=u=void 0}},l=n(7),u=r(l),c=n(175),p=r(c),d=n(266),f=n(285),h=r(f),m=function(e){function t(e){i(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.state={starred:e.currentFile.starred},this.notLoggedStar=this.notLoggedStar.bind(this),this.loggedStar=this.loggedStar.bind(this)}return o(t,e),a(t,null,[{key:"propTypes",get:function(){return{currentFile:l.PropTypes.object,currentUser:l.PropTypes.object}}}]),a(t,[{key:"notLoggedStar",value:function(){var e=this.props.currentFile.id,t=this.props.currentFile.guid;window.location.href="/register?redirect_url="+encodeURIComponent("/favorites?fileid="+e+"&guid="+t)}},{key:"loggedStar",value:function(){var e=this,t=this.props.currentFile.id,n=this.props.currentFile,r=n.shareMode,i=n.type,o=this.props.currentUser.id>0;this.state.starred?(0,d.unstarFile)(t).then(function(){e.setState({starred:!1})},function(e){p.default.alert({title:e.message,type:"error"})}):(0,d.starFile)(t).then(function(){o&&"readonly"==r&&0===i&&p.default.alert({title:"文档已标星"}),e.setState({starred:!0})},function(e){p.default.alert({title:e.message,type:"error"})})}},{key:"render",value:function(){var e=this.props.currentFile,t=e.shareMode,n=e.type,r=this.props.currentUser.id>0;if(!r&&"editable"===t)return u.default.createElement("div",{className:"right-btn-group"},u.default.createElement("a",{href:"/register",className:"right-btn register-or-login"},"注册 / 登录"),u.default.createElement("a",{className:"right-btn mark-star",onClick:this.notLoggedStar},"标星收藏"));if("readonly"===t){if(n===-1){if(r){var i=(0,h.default)({"readonly-loggin-star":!0,"header-star-btn":!0,"s-header-star-btn":!0,active:this.state.starred});return u.default.createElement("a",{className:i,onClick:this.loggedStar},u.default.createElement("span",{className:"team-sprite team-icon-star mark-star-icon"}),u.default.createElement("span",{className:"s-tooltip"},this.state.starred?"取消标星":"标星"))}return u.default.createElement("div",{className:"readonly-btn-group"},u.default.createElement("a",{href:"/register",className:"readonly-operation register-or-login"},"注册 / 登录"),u.default.createElement("a",{className:"readonly-operation mark-star",onClick:this.notLoggedStar},"标星收藏"))}if(0===n){if(r){var i=(0,h.default)({"readonly-operation":!0,"mark-star":!0,active:this.state.starred});return u.default.createElement("span",null,u.default.createElement("a",{className:i,onClick:this.loggedStar},this.state.starred?"取消标星":"标星收藏"))}return u.default.createElement("span",null,u.default.createElement("a",{href:"/register",className:"readonly-operation register-or-login"},"注册 / 登录"),u.default.createElement("a",{className:"readonly-operation mark-star",onClick:this.notLoggedStar},"标星收藏"))}}}}]),t}(l.Component);t.default=m,e.exports=t.default},1239:function(e,t,n){var r,i;(function(o){var a=function(e,t){function n(){this.constructor=e}for(var r in t)s.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},s={}.hasOwnProperty;r=[n(175),n(1019),n(1240)],i=function(e,t,n){var r;return new(r=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return a(r,t),r.prototype.init=function(){return this.$editor=o("#innerdocbody"),this.$pad=o("#pad-view"),this.initConfig(),this.initBinding()},r.prototype.initConfig=function(){return this.metaKey=e.isMac()?"command":"ctrl",this.baseConfig="shift+"+this.metaKey+"+",this.docConfig={up:"handleFontUp",down:"handleFontDown",p:"handleComment",k:"handleTitle",u:'li[data-key="insertorderedlist"]',i:'li[data-key="insertunorderedlist"]',y:'li[data-key="checklist"]',l:"handleHistory",o:"handleDirectory",x:"handleAddShare"},this.listConfig={},this.commonConfig={e:"handleNewHome"},this.inDoc="k u i y up down"},r.prototype.initBinding=function(){var e,t,n,r,i,a,s,l,u;u=this,i=this.docConfig,e=function(){var e,t;return e=n,t=r,Mousetrap.bind(u.baseConfig+e,function(n){if(0===u.$pad.length&&(u.$pad=o("#pad-view")),0===u.$editor.length&&(u.$editor=o("#innerdocbody")),n.preventDefault?n.preventDefault():n.returnValue=!1,!u.$pad.hasClass("hide")&&(!u.inDoc.match(new RegExp("\\b"+e+"\\b"))||u.$editor.is(":focus"))&&("p"!==e||u.$editor.is(":focus")||o(".selection-comment-input").is(":focus")))return"function"==typeof u[t]?u[t]():o(t).click(),!1})};for(n in i)r=i[n],e();a=this.listConfig,t=function(){var e,t;return e=n,t=r,Mousetrap.bind(e,function(e){var n;if(n=window.cow.pageType,"home"===n||"folder"===n)return o(t).click(),e.preventDefault?e.preventDefault():e.returnValue=!1})};for(n in a)r=a[n],t();s=this.commonConfig,l=[];for(n in s)r=s[n],l.push(function(){var e,t;return e=n,t=r,Mousetrap.bind(u.baseConfig+e,function(e){return u[t](),e.preventDefault?e.preventDefault():e.returnValue=!1})}());return l},r.prototype.handleFontUp=function(){return this.handleFontChange("up")},r.prototype.handleFontDown=function(){return this.handleFontChange("down")},r.prototype.handleComment=function(){var e,t,n;return n=o("#select-comment"),t=o(".close-temp"),e=o(".temp-list"),"none"===window.getComputedStyle(e[0]).getPropertyValue("display")?n.click():t.click()},r.prototype.handleFontChange=function(e){var t,n,r;if(window.getSelection().toString().length&&(r={9:1,10:2,11:3,12:4,14:5,18:6,24:7,30:8,36:9},t=o(".size-txt").text()))return n=r[t],"up"===e?n++:n--,n=Math.min(Math.max(n,1),9),o("#size-list [data-value='"+n+"']").trigger("click",[!0])},r.prototype.handleTitle=function(){var e,t,n;return e={"普通":-1,"小标题":1,"中标题":2,"大标题":3},t=o(".type-txt").text(),n=e[t],3===n?n=-1:n===-1?n=1:n++,o(".font-type-item [data-value='"+n+"']").trigger("click",[!0])},r.prototype.handleHistory=function(){var e,t,n,r;return t=o("#doc-history"),r=o(".history-btn"),n=o("#doc-history .doc-sidebar-close"),e=o("#display-toolbar-btn"),t.hasClass("hide")?(r.click(),e.removeClass("active")):n.click()},r.prototype.handleDirectory=function(){var e,t,n,r;return e=o("#doc-directory"),n=o(".directory-btn"),t=o("#doc-directory .doc-sidebar-close"),r=o("#display-toolbar-btn"),e.hasClass("hide")?(n.click(),r.removeClass("active")):t.click()},r.prototype.handleAddShare=function(){var e,t,r;return r=o("#teamworker-setting"),t=o(".teamworker-inner"),e=o(".teamworker-close"),!r.hasClass("hide")&&t.hasClass("share-menu")?e.click():new n("#teamworker-setting")},r.prototype.handleNewHome=function(){return window.open("http:///shimo.im/desktop")},r}(e.DomModule))("body")}.apply(t,r),!(void 0!==i&&(e.exports=i))}).call(t,n(1))},1240:function(e,t,n){var r,i;(function(o,a,s){var l=function(e,t){function n(){this.constructor=e}for(var r in t)u.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},u={}.hasOwnProperty;r=[n(175),n(1246),n(1242),n(1243),n(1244),n(1245),n(1241),n(191),n(183),n(292),n(182),n(334)],i=function(e,t,n,r,i,u,c,p,d,f,h,m){var v;return v=function(v){function y(){return y.__super__.constructor.apply(this,arguments)}return l(y,v),y.prototype.inited=!1,y.prototype.init=function(t,n){var r;window.cow.authorized!==!1&&(r=this,this.cow=window.cow,this.defaultAvatar="https://assets-cdn.shimo.im/assets/images/invited-f41924e412.png",this.option=this.option=o.extend({file:window.cow.currentFile,isTeamCreator:this.isTeamCreator},n),this.teamId=this.option.teamId,this.isTeamCreator=this.option.isTeamCreator,this.readOnly=this.option.readOnly=this.option.readOnly||!1,this.isMobile=e.isMobile,this.maxTeamworkerCount=m.initLimition().teamworkerCount,this.modal=void 0===this.option.modal||this.option.modal,this.teamId?(this.memberList=[],this.membersObj={}):this.file=this.option.file,this.option.shareList?this.renderShareList():this.renderTeamworker(),this.sharedUserlist={current:[],grand:[]},this.show(),this.$view.click(function(e){if(a(e.target).is(r.$view)&&r.modal)return r.hide()}))},y.prototype.renderTeamworker=function(){return this.$view.html(o.template(t)(this.option)),this.$shareMenu=this.$view.find(".share-menu"),this.$emailInput=this.$shareMenu.find(".teamworker-input"),this.$searchList=this.$shareMenu.find(".search-user-list"),this.$userList=this.$shareMenu.find(".teamworker-user-list"),this.$delBtn=this.$view.find(".teamworker-input-clear"),
this.$listItem=this.$view.closest(".ob-li"),this.$notFound=this.$view.find(".user-not-found"),this.$teamworkerRight=a(".teamworker-content-right"),this.$teamworkerShadow=a(".teamworker-list-shadow"),this.$inviteBtn=a(".invite-users"),this.$inviteLinkPopup=this.$view.find(".invite-link-popup"),this.$inviteLinkBtn=this.$view.find("a.btn.invite-link"),this.$inviteLinkQr=this.$inviteLinkPopup.find("img"),this.showShareMenu(),this.waitingInvited=[]},y.prototype.renderShareList=function(){return this.$view.html(o.template(n)(this.option)),this.$userList=this.$view.find(".teamworker-content"),this.$shareNumber=this.$view.find(".teamworker-number"),this.$teamworkerShadow=a(".sharelist-content-shadow"),this.showShareList()},y.prototype.showShareList=function(){return this.teamId?this.getTeamMembers("",!0):this.getUserList("",!0)},y.prototype.renderTeamworkerInner=function(){return this.$userList.find("ul").html(""),this.renderRecentlyContacts()},y.prototype.renderRecentlyContacts=function(){var t;return t=this,e.get("/api/share/recent_contact",{},function(e){var n,r,i;return t.recentContacts=i=e.data,t.teamId?o.forEach(i,function(e){t.membersObj[e.id]?e.shareClass="is-shared":e.shareClass=""}):o.forEach(i,function(e){window.cow.shareObj[e.id]?e.shareClass="is-shared":e.shareClass=""}),r={userList:i.filter(function(e){return e.status>-1}),title:"最近"},this.recentlyObject=r,n=o.template(c)({contactsList:[r]}),t.$userList.find("ul").prepend(n)})},y.prototype.renderContacts=function(){var e,t,n,r,i,a;return a=this,t=p.contacts,i={},o.forIn(t,function(e,t){var n;if(e.status!==-1)return n=e.name_pinyin.substr(0,1),a.teamId?a.membersObj[e.id]?e.shareClass="is-shared":e.shareClass="":window.cow.shareObj[e.id]?e.shareClass="is-shared":e.shareClass="",n.match(/[a-zA-Z]/)||(n="#"),i[n]?i[n].userList.push(e):i[n]={title:n.toUpperCase(),userList:[e]}}),r=o.values(i),r.sort(function(e,t){return e.title>t.title?1:-1}),r[0]&&"#"===r[0].title&&(n=r.shift(),r.push(n)),e=o.template(c)({contactsList:r}),this.$userList.find("ul").append(e)},y.prototype.renderSearchList=function(){var e,t;return t=this,this.$searchList.find("ul").html(""),o.forEach(this.searchUsers,function(e){var n,r;r=!1,o.each(t.waitingInvited,function(t){if(r=e.id?e.id===t.id:e.email===t.email)return r}),n=t.teamId?t.membersObj:window.cow.shareObj,n[e.id]?e.shareClass="is-shared":r?e.shareClass="is-checked":e.shareClass=""}),e={userList:this.searchUsers,title:""},u=o.template(c)({contactsList:[e]}),this.$searchList.find("ul").append(u)},y.prototype.renderInvitedUser=function(){var e,t,n;return n="待添加成员"+(this.waitingInvited.length?"("+this.waitingInvited.length+")":""),e={userList:this.waitingInvited,title:n,titleClass:"invite-title"},t=o.template(c)({contactsList:[e]}),this.$teamworkerRight.find("ul").html(t),this.waitingInvited.length?this.$inviteBtn.removeClass("disable"):this.$inviteBtn.addClass("disable")},y.prototype.changeListShadow=function(){return this.$userList.find("ul").height()>this.$userList.height()?this.$teamworkerShadow.show():this.$teamworkerShadow.hide()},y.prototype.eventMap={"click .dropdown-btn":"dropClick","click .dropdown":"stopPropagation","click .search-list li":"shareClick","click .user-input .input-group-addon":"handlerUserInput","click .share-ob ":"showShareMenu","click .share-ob":"onlineStatusWatch","mouseover .search-list li":"searchHover","click .icon-close:first":"close","click .add-share":"openAddShare","keyup .teamworker-input":"emailInputKeyup","keydown .teamworker-input":"emailInputKeydown","click .teamworker-input-clear":"clearInput","click .invite-users":"inviteUsers","click .cancel-invite":"closeInvite","click .share-user-remove":"cancelShare","click .share-menu-content .share-user-li":"pickUser","click .invite-link":"inviteLinks","click *":"hideInviteLinkPopup","click .team-role-item":"roleItemClick"},y.prototype.domEvents={dropClick:function(e,t){var n,r,i,o,s,l,u,c,p,d;r=a(t),l=r.hasClass("active"),h.clearDropdown(),this.$view.find(".is-dropup").removeClass("is-dropup"),this.$view.find(".has-drop").removeClass("has-drop"),o=this.$view.find(".user-list>.share-user-li"),l||(i=a(t).closest(".user-li"),p=this.$view.find(".sharelist-content").scrollTop(),s=i.find(".role-dropdown-wrap").height()+20+10,d=o.index(i),u=36*(d+1)-p,c=this.$view.find(".sharelist-content").height()-u,i.addClass("has-drop"),n=r.addClass("active").next(".dropdown").addClass("active"),c<s&&n.addClass("is-dropup")),e.stopPropagation()},stopPropagation:function(e,t){return e.stopPropagation(),e.preventDefault(),!1},closeInvite:function(){return"sharelist"===this.option.pre?this.renderShareList():(a(".teamworker-close").click(),this.isTeamCreator?this.gotoCurrentTeam():void 0)},inviteUsers:function(){if(!this.$inviteBtn.hasClass("disable"))return this.$inviteBtn.addClass("disable").text("请求中..."),this.invite()},pickUser:function(e,t){var n,r,i,s,l,u,c,d,f,h,m,v,y,g;if(d=a.Deferred(),d.then(function(e){return function(t){if(t)return e.waitingInvited.push(t)}}(this)),d.then(function(e){return function(){return e.renderInvitedUser()}}(this)),n=a(t),r=n.find(".operation-icon"),!r.hasClass("is-shared"))return h=r.hasClass("is-checked"),m=r.hasClass("is-remove"),g=n.attr("data-user-id"),f=n.attr("data-user-email"),g?(i=this.$view.find(".teamworker-user-li[data-user-id="+g+"] .operation-icon"),s="id",l=g):(i=this.$view.find(".teamworker-user-li[data-user-email='"+f+"'] .operation-icon"),s="email",l=f),this.waitingInvited=o.remove(this.waitingInvited,function(e){return e[s]+""!=l+""}),h||m?(i.removeClass("is-checked"),d.resolve()):(i.addClass("is-checked"),g?(y=p.contacts[g],y?(y.shareClass="is-remove",c=a.extend(!0,{},y),d.resolve(c)):(v=n.find(".share-user-name").text(),u=n.find(".share-user-avatar img").attr("src"),c={name:v,email:f,id:g,avatar:u,shareClass:"is-remove"},d.resolve(c))):(c={name:"邮件邀请",email:f,avatar:this.defaultAvatar,shareClass:"is-remove"},cooperation.getUserInfo(f).done(function(e){return function(e){return 0===e.code&&(c.name=e.data.name,c.avatar=e.data.avatar),d.resolve(c)}}(this))))},openAddShare:function(){return this.maxTeamworkerCount!==1/0&&cow.shareList.length>=this.maxTeamworkerCount&&!this.isTeamCreator?void this.showOutCountWarning():this.readOnly?a(".teamworker-close").click():(this.renderTeamworker(),this.option.pre="sharelist")},cancelShare:function(t){var n,r,i,o,s,l,u;return o=this,u=a(t.target).parents(".user-li"),l=+u.attr("data-user-id"),r=u.hasClass("verified"),l===window.cow.currentUser.id?n="确认要删除对你自己的共享吗？<br />删除后你将无权限访问该文件":(s=p.get(l),i=r?s.email:s.name,n='确认要删除对<span class="blue">'+i+"</span>的共享吗？<br />删除后该成员将无权限访问该文件"),o.tempHide(),f.show({okCallback:function(){return o.tempShow(),o.showCancelInviteStatus(u),e.post("/api/share/delete",{guid:o.file.guid,user_id:l},function(){return l===window.cow.currentUser.id?(o.hide(),e.alert({title:"已删除对你自己的共享"})):(o.getUserList(!0,!0),e.alert({title:"已删除<span class='blue'>"+p.get(l).name+"</span>"}))},function(){return e.alert({title:"删除失败",type:"error"}),o.showCancelInviteStatus(u,"confirm")})},cancelCallback:function(){return o.tempShow()},headText:"删除共享",bodyText:n})},shareClick:function(e,t){},handlerUserInput:function(){return this.handlerUserInput.apply(this,arguments)},onlineStatusWatch:function(){return d.watch("shareMenu",this.$shareMenu,function(e){return this.find("ul li[data-user-id="+e+"]")})},emailInputKeydown:function(t){var n;(n=t.keyCode)===e.keyCodes.UP||n===e.keyCodes.DOWN?t.preventDefault():t.keyCode===e.keyCodes.ENTER&&this.handlerUserInput(t)},emailInputKeyup:function(t){var n;return t.keyCode===e.keyCodes.ESC&&this.hide(),n=this.$emailInput.val().trim(),n?this.showSearchList():this.hideSearchList(),t.keyCode===e.keyCodes.UP?(this.selectSearchItem("up"),this.scrollSearch()):t.keyCode===e.keyCodes.DOWN?(this.selectSearchItem("down"),this.scrollSearch()):(this.$emailInput.parents(".user-input").removeClass("has-error"),this.search(t.target.value))},searchHover:function(e,t){var n;if(n=a(t),!n.hasClass("active"))return this.$searchList.find("li").removeClass("active"),n.addClass("active")},close:function(){return this.hide()},clearInput:function(e){return this.$emailInput.val("").focus(),this.hideSearchList(),this.$notFound.hide()},inviteLinks:function(){var t;return t=this,this.$inviteLinkPopup.toggleClass("hide"),this.$inviteLinkPopup.hasClass("hide")||this.$inviteLinkQr.prop("src",""),e.get("/api/file/"+this.file.guid+"/invite_link").then(function(t){return function(n){var r;return r=e.getQrImageUrl(114,n.data.link),t.$inviteLinkQr.prop("src",r)}}(this))},hideInviteLinkPopup:function(e){var t;if(this.modal){if(t=a(e.target),0===this.$view.find(".invite-link-popup").length)return;!t.is(this.$inviteLinkPopup.find("*"))&&!t.is(this.$inviteLinkBtn)&&!this.$inviteLinkPopup.hasClass("hide")&&this.$inviteLinkPopup.addClass("hide")}},roleItemClick:function(e,t){var n,r,i,s,l,u;if(s=this,n=a(t),i=a(t).attr("action-type"),r=a(t).closest(".user-li"),h.clearDropdown(),r.length>0){if(l=r.attr("data-user-id"),u=s.membersObj[l],"undefined"==typeof l)return;if("delete"===i||"cancel-invite"===i)return f.show({okCallback:function(){return s.removeTeamMember(l).then(function(){return r.remove(),o.remove(s.memberList,function(e){return+e.id===+l}),delete s.membersObj[l]}).fail(function(){})},headText:"移除成员",bodyText:"<div>确定要移除 "+u.name+" 吗？</div><div>移除后该成员将无权限访问该文件夹</div>"});if(o.includes(["admin","member","visitor"],i))return this.changeMemberRole(l,i).then(function(e){return r.find(".role-title").text(e),r.find(".team-role-list li").removeClass("checked"),n.addClass("checked")}).fail(function(){})}}},y.prototype.getMobileShareList=function(){var e,t,n;return t=this.sharedUserlist,n=[],e="",o.forEach(t.current,function(e){return n.push(e.name)}),o.forEach(t.grand,function(e){return o.forEach(e.users,function(e){if(n.length<4)return n.push(e.name)})}),e=n.length<=3?n.toString()+'<span class="m-icon">':n.slice(0,3).toString()+'...<span class="m-icon">'},y.prototype.showCancelInviteStatus=function(e,t){return null==t&&(t="loading"),"loading"===t?(t="userlist-"+t,e.find(".status").hide(),e.find(".status."+t).show()):e.find(".status").attr("style","")},y.prototype.showShareMenu=function(e,t){return this.teamId?this.getTeamMembers():this.getUserList()},y.prototype.showSearchList=function(){return this.$delBtn.show(),this.$emailInput.addClass("search-result-shown"),this.$searchList.show(),this.$userList.hide()},y.prototype.hideSearchList=function(){return this.$emailInput.val("").removeClass("search-result-shown"),this.$delBtn.hide(),this.$searchList.hide(),this.$userList.show()},y.prototype.selectSearchItem=function(e){var t,n,r;return n=this.$searchList.find("li"),"undefined"==typeof e?n.removeClass("active").first().addClass("active"):(t=this.$searchList.find("li.active"),0!==t.length?(r=t.attr("data-index"),"up"===e&&r>0&&t.prev().length>0&&t.removeClass("active").prev().addClass("active"),"down"===e&&r<n.length-1&&t.next().length>0?t.removeClass("active").next().addClass("active"):void 0):void 0)},y.prototype.updateAttr=function(t,n){return e.post("/api/file/"+n,t,function(){})},y.prototype.showInviteStatus=function(e){return this.$activeSearchLi.find("span.icon-add,span.icon-loading,span.icon-remind").hide(),this.$activeSearchLi.find("span.icon-"+e).show()},y.prototype.invite=function(){var t,n,r,i,a;if(i=this,this.waitingInvited.length)return a="",n={},i.teamId?(n={team_id:this.teamId,users:[]},a="/team_members/invite"):(n={file_id:this.file.id,users:[]},a="/api/invite"),r=!1,this.maxTeamworkerCount===1/0||this.isTeamCreator||(t=this.maxTeamworkerCount-cow.shareList.length,t<=0?r=!0:this.waitingInvited.length>t&&(r=!0)),r?(i.$inviteBtn.removeClass("disable").text("确定"),void i.showOutCountWarning()):(o.forEach(this.waitingInvited,function(e){var t;return t=e.id?e.id:e.email,n.users.push(t)}),n.users.length>0?e.post(a,n).then(function(t){return 0===t.code&&t.data.success?(e.alert({title:"邀请成功！"}),i.renderShareList()):(e.alert({title:"添加失败",type:"error"}),i.$inviteBtn.removeClass("disable").text("确定"))}).fail(function(){return e.alert({title:"添加失败",type:"error"}),i.$inviteBtn.removeClass("disable").text("确定")}):void 0)},y.prototype.showOutCountWarning=function(){var e;return e=this.maxTeamworkerCount,f.show({headText:"到达上限",bodyText:"最多添加"+e+"个协作者，升级<b>石墨高级版</b>无此限制",buttons:[{type:"link-button",buttonLabel:"了解详情",href:"/payment",target:"_blank",customClass:"btn btn-ok",closeAfterClick:!0},{type:"button",buttonLabel:"取消",customClass:"btn btn-cancel",closeAfterClick:!0}]})},y.prototype.setTplClassName=function(e){return e.isOwner?(e.tplClassName="user-admin",e.tplTitle="管理员"):"verified"!==e.status&&"verified"!==e._status?(e.tplClassName="user-wait-confirm",e.tplTitle="成员"):(e.tplTitle="成员",e.tplClassName="user-normal",+e.id===window.cow.currentUser.id?e.tplClassName="user-self":void 0)},y.prototype.getTeamMembers=function(t,n){var r,a,s;return null==t&&(t=!0),s=this,a=function(){var e,t;return n?(e=s.membersObj[cow.currentUser.id].team_role,t=o.template(i)({myRole:e,userList:s.memberList,readOnly:s.readOnly}),s.$userList.find("ul").html(t),s.memberList&&s.$shareNumber.text("团队成员("+s.memberList.length+")")):s.renderTeamworkerInner(),s.changeListShadow()},t||n?(r=function(e){var t;return t=e.data,t.map(function(e){switch(+e.id===window.cow.currentUser.id&&(e.isSelf=!0),e.team_role){case"creator":e.roleTitle="创建者";break;case"admin":e.roleTitle="管理员";break;case"member":e.roleTitle="成员"}return s.membersObj[e.id]=e}),t=t.sort(function(e,t){return("admin"===t.team_role)-("admin"===e.team_role)}).sort(function(e,t){return("creator"===t.team_role)-("creator"===e.team_role)}),s.memberList=t},e.get("/smapi/teams/mine/members").then(function(e){if(0===e.code)return r(e),a()})):a()},y.prototype.getUserList=function(t,n){var i,a,s;return null==t&&(t=!0),s=this,a=function(){var e;return n?(e=o.template(r)(s.sharedUserlist),s.$userList.find("ul").html(e),window.shareList&&s.$shareNumber.text("成员("+window.shareList.length+")")):(s.renderTeamworkerInner(),s.$emailInput.focus()),s.changeListShadow()},t||n?(i=function(e){var t;return t=e.data,t.grandUsers=[],t.grand.map(function(e){return e.users=[],e.user_ids.split(",").forEach(function(t){var n;if(p.exists(t))return n=p.get(t),n._status="verified",n.isOwner=+e.user_id===+t,+n.id===window.cow.currentUser.id&&(n.isSelf=!0),s.setTplClassName(n),e.users.push(n)}),t.grandUsers=t.grandUsers.concat(e.users),e}),t.grandUsers=t.grandUsers.sort(function(e,t){return t.status-e.status}).sort(function(e,t){return!!t.isSelf-!!e.isSelf}).sort(function(e,t){return t.isOwner-e.isOwner}),t.current.map(function(e){return e.online=d.isOnline(e.id),+e.id===window.cow.currentUser.id&&(e.isSelf=!0),s.setTplClassName(e),e}),t.current=t.current.sort(function(e,t){return t.status-e.status}).sort(function(e,t){return!!t.isSelf-!!e.isSelf}).sort(function(e,t){return t.isOwner-e.isOwner}),s.sharedUserlist=t,window.shareList=t.grandUsers.concat(e.data.current),cow.shareList=window.shareList},e.post("/api/share/"+s.file.guid,{},function(e){if(0===e.code)return i(e),a()},function(t){if("err_shortcut_inside"===t.message)return e.alert({title:"文件夹中有他人分享的文档/文件夹，无法添加共享人",type:"error"}),s.hide()})):a()},y.prototype.search=function(t){var n;return n=this,this.searchUsers=p.search(t,n.recentContacts||[]).filter(function(e){return+e.id!==+window.cow.currentUser.id&&e.status>-1}).map(function(e,t){return e.index=t,e}),0===this.searchUsers.length&&t?e.regs.email.test(t)?(this.searchUsers.push({name:"邮件邀请",email:t,avatar:this.defaultAvatar}),this.$notFound.hide()):this.$notFound.text("无搜索结果").show():this.$notFound.hide(),this.renderSearchList()},y.prototype.scrollSearch=function(){var e,t,n,r,i;if(n=this.$searchList.find(".active").index(),r=this.$searchList.scrollTop(),e=50,t=150,i=e*n,i-r>e-e||i<r)return this.$searchList.scrollTop(i)},y.prototype.handlerUserInput=function(e){var t;this.$searchLi=this.$searchList.find(".share-user-li"),t=this.$searchLi.find(".operation-icon"),1!==this.$searchLi.length||t.hasClass("is-shared")||t.hasClass("is-checked")||(this.$searchLi.click(),this.$delBtn.click())},y.prototype.toggleOverflow=function(e){return e?a("body,html").addClass("overflow-hidden"):a("body,html").removeClass("overflow-hidden")},y.prototype.show=function(){return this.$view.removeClass("hide").click(),this.toggleOverflow(!0)},y.prototype.tempHide=function(){return this.$view.addClass("hide"),this.toggleOverflow(!1)},y.prototype.tempShow=function(){return this.$view.removeClass("hide"),a("body").click(),this.toggleOverflow(!0)},y.prototype.hide=function(){if(this.$view.hasClass("show")?this.$view.removeClass("show"):(this.$view.off(),this.$view.addClass("hide")),a("body").click(),this.toggleOverflow(!1),this.isTeamCreator)return this.gotoCurrentTeam()},y.prototype.gotoCurrentTeam=function(){return this.cow.currentTeam=this.teamId,s("/team/"+this.teamId+"/files")},y.prototype.removeTeamMember=function(t){var n,r,i,o,s;return i=a.Deferred(),o=this,n="/team_members/delete",s=this.membersObj[t],r={team_id:o.teamId,user_id:t},e.post(n,r).then(function(t){if(0===t.code)return e.alert({title:"已删除<span class='blue'>"+s.name+"</span>"}),i.resolve()}).fail(function(t){return e.alert({title:"删除<span class='blue'>"+s.name+"</span>失败",type:"error"}),i.reject()}),i.promise()},y.prototype.changeMemberRole=function(t,n){var r,i,o,s,l;return o=a.Deferred(),s=this,r="/team_members/change_role",l=this.membersObj[t],i={team_id:s.teamId,user_id:t,role:n},e.post(r,i).then(function(t){var r;if(0===t.code){switch(r="",n){case"admin":r="管理员";break;case"member":r="成员";break;case"visitor":r="访客"}return e.alert({title:"已将<span class='blue'>"+l.name+"</span>修改为"+r}),o.resolve(r)}return e.alert({title:"更新<span class='blue'>"+l.name+"</span>角色失败"}),o.reject()}).fail(function(t){return e.alert({title:"更新<span class='blue'>"+l.name+"</span>角色失败"}),o.reject()}),o.promise()},y}(e.DomModule)}.apply(t,r),!(void 0!==i&&(e.exports=i))}).call(t,n(4),n(1),n(176))},1241:function(e,t){e.exports='<% _.each(contactsList, function(userObject) { %>\n    <% if (userObject.userList.length && userObject.title || userObject.titleClass === "invite-title") {%>\n        <li class="share-li-title teamworker-li-title <%= userObject.titleClass %>"><%= userObject.title %></li>\n    <% } %>\n    <% _.each(userObject.userList, function (user) { %>\n        <li class="share-user-li teamworker-user-li <%= user.online?\'online\':\'\' %> <%= user.status || \'\' %>" data-share-id="<%= user.share_id %>" data-user-id="<%= user.id %>" data-user-email="<%= user.email %>">\n            <span class="share-user-avatar">\n                <img src="<%= user.avatar%>">\n                <span class="online-circle"></span>\n            </span>\n            <span class="share-user-name ellipsis teamworker-user-name"><%= user.name %></span>\n            <span class="share-user-email ellipsis teamworker-user-email"><%= user.email || \'石墨用户\'%></span>\n            <span class="operation-icon doc-share-icon <%= user.shareClass%>"></span>\n        </li>\n    <% }) %>\n<% }) %>\n\n\n\n'},1242:function(e,t){e.exports='<div class="sharelist-dialog teamworker-inner">\n    <div class="share-title teamworker-title">\n        <span class="teamworker-number">成员</span>\n        <span class="hicon icon-close teamworker-close"></span>\n    </div>\n\n    <div class="teamworker-content sharelist-content">\n        <ul class="user-list"></ul>\n    </div>\n    <div class="sharelist-content-shadow"></div>\n    <div class="teamworker-footer">\n        \n        <a href="javascript:void(0);" class="teamworker-btn add-share btn btn-ok"><% if (readOnly) {print(\'完成\')} else {print(\'添加成员\')}%></a>\n    </div>\n</div>'},1243:function(e,t){e.exports='<% if (grandUsers.length > 0) { %>\n    <li class="share-li-title user-li-title">共享文件夹</li>\n<% } %>\n<% _.each(grandUsers, function (user) {   %>\n    <li class="grand-li share-user-li user-li <%= user.online?\'online\':\'\' %> <%= user.status || \'\' %>" data-share-id="<%= user.share_id %>" data-user-id="<%= user.id %>" data-user-email="<%= user.email %>">\n        <span class="share-user-avatar">\n            <img src="<%= user.avatar%>">\n            <span class="online-circle"></span>\n        </span>\n        <span class="share-user-name ellipsis"><%= user.name %></span>\n        <span class="share-user-email ellipsis"><%= user.email || \'石墨用户\' %></span>\n        <span class="share-status share-user-identity <%= user.tplClassName %>"><%= user.tplTitle %></span>\n    </li>\n<% }) %>\n\n<% if (current.length > 0) { %>\n    <li class="share-li-title user-li-title <% if (grandUsers.length == 0) {%>no-grand<%}%>">与<%= grandUsers.length > 0 ? \'另\' : \'\' %><%= current.length %>人分享</li>\n<% } %>\n<% _.each(current, function (user) {   %>\n    <li class="share-user-li user-li <%= user.online?\'online\':\'\' %> <%= user.status || \'\' %>" data-share-id="<%= user.share_id %>" data-user-id="<%= user.id %>" data-user-email="<%= user.email %>">\n        <span class="share-user-avatar">\n            <img src="<%= user.avatar%>">\n            <span class="online-circle"></span>\n        </span>\n        <span class="share-user-name ellipsis"><%= user.name %></span>\n        <span class="share-user-email ellipsis"><%= user.email || \'石墨用户\' %></span>\n        <span class="share-status share-user-identity <%= user.tplClassName %>"><%= user.tplTitle %></span>\n        <% if (user.tplClassName != \'user-admin\') { %>\n        <span class="share-status share-user-remove doc-share-icon"></span>\n        <% } %>\n        <span class="share-status share-user-loading"><img src="https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif" /></span>\n    </li>\n<% }) %>\n\n<% if (!grandUsers.length && !current.length) {%>\n    <li class="no-contact">暂无共享者</li>\n<% } %>\n'},1244:function(e,t){e.exports='<% _.each(userList, function (user, index) {   %>\n    <li class="share-user-li user-li <%= user.online?\'online\':\'\' %> <%= user.status || \'\' %>" data-share-id="<%= user.share_id %>" data-user-id="<%= user.id %>" data-user-email="<%= user.email %>">\n        <span class="share-user-avatar">\n            <img src="<%= user.avatar%>">\n            <span class="online-circle"></span>\n        </span>\n        <span class="share-user-name ellipsis"><%= user.name %></span>\n        <span class="share-user-email ellipsis team-user-email"><%= user.email || \'\' %></span>\n        <div class="team-role-select">\n            <!-- 不修改自己的角色，不是管理员没权限，但是可以取消邀请自己邀请的用户, 访客没任何权限 -->\n            <% if (!readOnly && (!user.isSelf && myRole==\'admin\')) { %>\n            <a class="role-select-btn dropdown-btn" href="javascript:void(0);">\n                <span class="team-sprite select-btn-icon"></span>\n            <% } else { %>\n            <a class="role-select-btn" href="javascript:void(0);">\n            <% } %>\n                <span class="role-title"><%=user.roleTitle%></span>\n            </a>\n            <div class="role-dropdown-wrap dropdown">\n                <div class="trangle">\n                    <span class="top"></span>\n                    <span class="down"></span>\n                </div>\n                <ul class="team-role-list">\n                    <li action-type="admin" class="team-role-item <%= (user.role == \'admin\') ? \'checked\' : \'\' %>">\n                        <span>管理员</span>\n                        <span class="select-role-icon team-sprite"></span>\n                    </li>\n                    <li action-type="member" class="team-role-item <%= (user.role == \'member\') ? \'checked\' : \'\' %>">\n                        <span>成员</span>\n                        <span class="select-role-icon team-sprite"></span>\n                    </li>\n                    <li class="team-role-separator"></li>\n                    <li action-type="delete" class="team-role-item">\n                        <span>移除成员</span>\n                    </li>\n                </ul>\n            </div>\n        </div>\n    </li>\n<% }) %>\n'},1245:function(e,t){e.exports='<% if (users.length) { %>\n  <% _.each(users, function (user) { %>\n    <li class="user-li search-li <% if (user.selected) {print(\'active\')} %> " data-user-id="<%= user.id %>" data-user-name="${user.name}" data-email="${user.email}" data-index="${user.index}">\n      <span class="icon">\n        <img src="<%= user.avatar%>">\n        <span class="online-circle"></span>\n      </span>\n      <span class="account-span">\n        <span class="account-name"><%= user.name %></span>\n        <span class="account-email"><%= user.email %></span>\n      </span>\n      <span class="hicon icon-add"></span>\n      <span class="icon-loading"><img src="https://assets-cdn.shimo.im/assets/images/loading-b67e5a67dc.gif" /></span>\n      <span class="hicon icon-remind"></span>\n    </li>\n  <% }) %>\n<% } else { %>\n  <li class="user-not-found">无搜索结果</li>\n<% } %>'},1246:function(e,t){e.exports='<div class="share-menu teamworker-inner">\n    <div class="share-title teamworker-title">\n        <span class="teamworker-number">添加成员</span>\n        <span class="hicon icon-close teamworker-close <%= (typeof isTeamCreator != \'undefined\' && !isTeamCreator)? \'hide\' : \'\' %>"></span>\n    </div>\n    <div class="teamworker-content share-menu-content">\n        <div class="teamworker-content-left">\n            <div class="teamworker-input-box">\n                <input class="form-control teamworker-input" type="text" autocomplete="off" placeholder="输入邮箱、搜索姓名进行添加" />\n                <a class="teamworker-input-clear" href="javascript:void(0);"><span class="hicon icon-delete"></span></a>\n                <ul class="search-list"></ul>\n            </div>\n            \n            <div class="teamworker-user-list">\n                <div class="teamworker-nobody-info hide">\n                    <span class="teamworker-nobody-text">还没有联系人</span>\n                    <span class="teamworker-nobody-text">你可以在上方<strong>输入对方邮箱</strong>直接添加</span>\n                    <% if(typeof teamId == \'undefined\' || !teamId) { %>\n                    <span class="teamworker-nobody-text">或点击下方「<strong>添加微信好友</strong>」按钮</span>\n                    <% } %>\n                </div>\n                <ul></ul>\n            </div>\n\n            <div class="search-user-list">\n                <ul></ul>\n            </div>\n\n            <div class="user-not-found"></div>\n            \n        </div>\n        <div class="teamworker-content-right">\n            <ul>\n                <li class="share-li-title teamworker-li-title invite-title">待添加成员</li>\n            </ul>\n        </div>\n    </div>\n    <div class="teamworker-list-shadow"></div>\n    <div class="invite-link-popup hide">\n        <p>微信扫一扫</p>\n        <img src="" />\n        <p>把文档发送给好友<br />邀请好友加入</p>\n        <div class="arrow-down" style="display: block;">\n          <span class="top"></span>\n          <span class="down"></span>\n        </div>\n    </div>\n    <div class="teamworker-footer">\n        <% if(typeof teamId == \'undefined\' || !teamId) { %>\n          <a href="javascript:void(0);" class="btn teamworker-btn invite-link">添加微信好友</a>\n        <% } %>\n        <a href="javascript:void(0);" class="btn btn-ok teamworker-btn invite-users disable">确定</a>\n        <!-- 团队创建最后的添加成员比较特殊，可以跳过，所以按钮上处理不太一样 -->\n        <a href="javascript:void(0);" class="btn teamworker-btn cancel-invite"><%= (typeof isTeamCreator != \'undefined\' && isTeamCreator)? "跳过" : "取消"%></a>\n    </div>\n</div>\n'},1278:function(e,t,n){var r,i;(function(o){r=[n(184),n(166),n(267)],i=function(e,t,n){var r,i;return Object.defineProperty(window.cow,"currentFile",{get:function(){return this._currentFile||{}},set:function(e){return this._currentFile=e,this._currentFile.typeName=n.FILE_ZH_TYPE_MAP[e.type]||"",e}}),window.cow.setCurrentFile=function(e,t){var n;return t?(n=window.cow.currentFile,n[t]=e,window.cow.currentFile=n):window.cow.currentFile=e},window.cow.updateDocCurrentFile=function(e){var t,n,r;t=window.cow.currentFile.guid;for(n in e)r=e[n],window.cow.currentFile[n]=r;return window.cow.currentListByGuid[t]=window.cow.currentFile},window.cow.appendCurrentFileAttribute=function(e,t){var n;if(n=window.cow.currentFile,o.isArray(n[t]))return n[t].push(e),window.cow.currentFile=n},r=!0,i=function(){return r?(window.cow.currentFile=window.cow.tempCurrentFile,r=!1):window.cow.currentFile=window.cow.currentFile},t.on("socket:connected",i),t.on("socket:reconnected",i)}.apply(t,r),!(void 0!==i&&(e.exports=i))}).call(t,n(4))},1279:function(e,t,n){(function(r,i){function o(e){return e&&e.__esModule?e:{default:e}}function a(){function e(e,t){var o=r.pick(e,["guid","rev","changeset","apool"]);return o.rev&&o.changeset&&o.apool?(o.apool=JSON.stringify(o.apool),void l.default.post("/api/file/"+o.guid+"/sync",o,function(){console.log("offline sync success"),t(!0)},function(){try{var e=c.default.unpack(o.changeset).charBank.trim();if(0===e.length)return void t(!0);var n='文档离线同步出现错误，同步失败内容的纯文本为：<br /><span style="color:black;font-size: 13px;">'+e+"</span><br />你可以复制该文本，在文档打开后粘贴到文档。";d.default.show({okCallback:function(){window.location.href="/doc/"+o.guid},modal:!0,okText:"前往文档",headText:"非常抱歉",bodyText:n}),i.post("/api/log/sockets",{guid:o.guid,sockets:JSON.stringify(o.changeset)}),t(!1)}catch(e){t(!1)}})):(n.remove(o.guid,o.clientId),void t(!0))}var t=r.get(window,"cow.currentUser.id");if(!(t<1)){var n=void 0;try{n=new v.default({userId:t})}catch(e){return void h.default.alert({type:"error",title:"您的浏览器不支持离线编辑",delay:1e4})}var o=r.get(window,"cow.tempCurrentFile.guid"),a=g.default.initialize({userId:t,currentFileGuid:o,store:n,syncFn:e});a.sync()}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=n(163),l=o(s),u=n(313),c=o(u),p=n(292),d=o(p),f=n(175),h=o(f),m=n(388),v=o(m),y=n(1280),g=o(y);e.exports=t.default}).call(t,n(4),n(1))},1280:function(e,t,n){"use strict";var r=n(4),i={initialize:function(e){return this.userId=e.userId,this.currentFileGuid=e.currentFileGuid,this.syncFn=e.syncFn,this.store=e.store,this.dataArray=this._flattern(this.currentFileGuid),this},_flattern:function(e){var t=[],n=this.store.getAll();return Object.keys(n).forEach(function(e){Object.keys(n[e]).forEach(function(i){t.push(r.assign({clientId:e},n[e][i]))})}),e?r.sortBy(t,function(t){return t.guid===e?-1:1}):t},sync:function(){this.dataArray.length>0&&this._syncOne(this.dataArray[0])},_syncOne:function(e){var t=this;this.syncFn.call(null,e,function(n){t.store.remove(e.guid,e.clientId),t.dataArray.shift(),n&&t.sync()})}};e.exports=i},1428:function(e,t,n){var r,i;(function(o,a){r=[n(184)],i=function(e){function t(){var e=localStorage.getItem(c);e!==i.text&&(l.html(a.template(s)(i)).removeClass("hide"),u.addClass("maintenance"))}function n(){l.html("").addClass("hide"),u.removeClass("maintenance"),localStorage.setItem(c,i.text)}function r(){l.on("click",".icon-delete",function(){n()}),e.bind("Maintenance",function(e){e.active?(i=e,t(e)):n()})}var i,s='<span><% print(_.unescape(text)) %></span><a href="javascript:void(0);" class="hicon icon-delete"></a>',l=o("#list-view-wrap>.maintenance"),u=o("body"),c="maintenance_close";return{start:r}}.apply(t,r),!(void 0!==i&&(e.exports=i))}).call(t,n(1),n(4))},1433:function(e,t,n){e.exports=n.p+"handsontable.full.min.css"},1434:function(e,t,n){(function(e){function t(e){return e&&e.__esModule?e:{default:e}}n(1435),n(1437);var r=n(1024),i=t(r),o=n(184),a=t(o),s=n(1428),l=t(s);n(334);var u=n(1279),c=t(u);n(1278);var p=n(175),d=t(p),f=n(231),h=function(t,n){switch(cow.pageType){case"home":cow.teamId=void 0,cow.permission="editable",document.body.id=cow.permission,n();break;case"folder":case"doc":case"spreadsheet":case"sheet":case"newdoc":(0,f.ajaxGet)("/-/"+t.params.guid).then(function(t){if(0!==t.code)return d.default.alert({title:t.message,type:"error"}),void e.back();cow.teamId=t.data.teamId,cow.permission=t.data.permission||"readonly";var r=t.data.file.permissions;r.readable&&(cow.permission="readonly"),r.commentable&&(cow.permission="commentable"),
r.editable&&(cow.permission="editable"),1===t.data.file.type&&(cow.permission=r.childFileCreatable?"editable":"readonly"),document.body.id=cow.permission,n()});break;default:n()}},m=function(){e("*",i.default.common.checkNewVersion,i.default.common.setPageType,function(e,t){(0,c.default)(),t()}),e("/desktop",h,i.default.list.render),e.exit("/desktop",i.default.common.exit),e("/recent",i.default.list.render),e.exit("/recent",i.default.common.exit),e("/favorites",i.default.list.render),e.exit("/favorites",i.default.common.exit),e("/folder/:guid",h,i.default.list.render),e.exit("/folder/:guid",i.default.common.exit),e("/doc/:guid",h,i.default.doc.init),e.exit("/doc/:guid",i.default.common.exit),e("/newdoc/:guid",h,i.default.doc.init),e.exit("/newdoc/:guid",i.default.common.exit),e("/spreadsheet/:guid/:sheetId?",h,i.default.spreadsheet.init),e.exit("/spreadsheet/:guid/:sheetId?",i.default.common.exit),e("/sheet/:guid/:sheetId?",h,i.default.sheet.init),e.exit("/sheet/:guid/:sheetId?",i.default.common.exit),e()},v=function(){a.default.init(),m()};l.default.start(),v()}).call(t,n(176))},1435:function(e,t){},1437:function(e,t){}});